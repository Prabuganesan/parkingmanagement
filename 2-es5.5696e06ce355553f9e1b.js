!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var c=0;c<t.length;c++){var n=t[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,c,n){return c&&t(e.prototype,c),n&&t(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0Eai":function(t,n,i){"use strict";i.d(n,"a",function(){return I});var a=i("mrSG"),o=i("fXoL"),s=i("tyNb"),l=i("J7/z"),r=i("TEn/"),b=i("7zfz"),h=i("tp0D"),u=i("ofXK"),d=i("Gxio"),p=i("sYmb");function v(e,t){if(1&e){var c=o.Tb();o.Sb(0,"ion-item",7),o.ac("click",function(){o.wc(c);var e=t.$implicit;return o.cc().openTransactionHistory(e.id)}),o.Sb(1,"ion-label"),o.Sb(2,"h3"),o.Sb(3,"span",8),o.Ec(4),o.dc(5,"translate"),o.Rb(),o.Sb(6,"span",9),o.Sb(7,"strong"),o.Ec(8),o.dc(9,"date"),o.Rb(),o.Rb(),o.Rb(),o.Sb(10,"h3"),o.Sb(11,"span",8),o.Ec(12),o.dc(13,"translate"),o.Rb(),o.Sb(14,"span",9),o.Sb(15,"strong"),o.Ec(16),o.dc(17,"date"),o.Rb(),o.Rb(),o.Rb(),o.Sb(18,"h3"),o.Sb(19,"span",8),o.Ec(20),o.dc(21,"translate"),o.Rb(),o.Sb(22,"span",9),o.Sb(23,"strong"),o.Ec(24),o.dc(25,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Sb(26,"h3"),o.Sb(27,"span",8),o.Ec(28),o.dc(29,"translate"),o.Rb(),o.Sb(30,"span",9),o.Sb(31,"strong"),o.Ec(32),o.dc(33,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Sb(34,"h3"),o.Sb(35,"span",8),o.Ec(36),o.dc(37,"translate"),o.Rb(),o.Sb(38,"span",9),o.Sb(39,"strong"),o.Ec(40),o.dc(41,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Sb(42,"h3"),o.Sb(43,"span",8),o.Ec(44),o.dc(45,"translate"),o.Rb(),o.Sb(46,"span",9),o.Sb(47,"strong"),o.Ec(48),o.Rb(),o.Rb(),o.Rb(),o.Sb(49,"h3"),o.Sb(50,"span",8),o.Ec(51),o.dc(52,"translate"),o.Rb(),o.Sb(53,"span",9),o.Sb(54,"strong"),o.Ec(55),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()}if(2&e){var n=t.$implicit;o.Ab(4),o.Gc("",o.ec(5,17,"accountDetail.accOpenDate")," : "),o.Ab(4),o.Fc(o.fc(9,19,n.openDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Gc("",o.ec(13,22,"accountDetail.accCloseDate")," : "),o.Ab(4),o.Fc(o.fc(17,24,n.closeDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Gc("",o.ec(21,27,"accountDetail.totalAmount")," : "),o.Ab(4),o.Hc("",n.totalBillAmount," ",o.ec(25,29,"rs"),""),o.Ab(4),o.Gc("",o.ec(29,31,"accountDetail.amountReceived")," : "),o.Ab(4),o.Hc("",n.receivedAmount," ",o.ec(33,33,"rs"),""),o.Ab(4),o.Gc("",o.ec(37,35,"accountDetail.pendingAmount")," : "),o.Ab(4),o.Hc("",n.pendingAmount," ",o.ec(41,37,"rs"),""),o.Ab(4),o.Gc("",o.ec(45,39,"accountDetail.rentPlan")," : "),o.Ab(4),o.Fc(n.rentPlan_lookup.rentPlan),o.Ab(3),o.Gc("",o.ec(52,41,"accountDetail.accAddBy")," : "),o.Ab(4),o.Fc(n.accountAddedBy)}}var m,f=((m=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.dialogService=n,this.ref=i,this.config=a,this.popoverController=o,this.messageService=s,this.dbprovider=l,this.tableName="account",this.vehicleTableName="vehicle",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(a.data.vehicle)),this.fetchAccounts()}return c(t,[{key:"fetchAccounts",value:function(){var e=this;this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(function(t){console.log(t),t&&"SUCCESS"==t.status?e.accountList=t.records:e.messageService.add({key:"accountHistory",severity:"error",summary:t.message,detail:""})})}},{key:"openTransactionHistory",value:function(e){this.ref.close(),this.router.navigate(["transactionHistory"],{queryParams:{vehicle:JSON.stringify({vehicleInfo:this.selectedVehicle,activeAccountId:e})}})}}]),t}()).\u0275fac=function(e){return new(e||m)(o.Mb(s.g),o.Mb(l.a),o.Mb(l.d),o.Mb(l.b),o.Mb(r.H),o.Mb(b.h),o.Mb(h.a))},m.\u0275cmp=o.Gb({type:m,selectors:[["accountHistory"]],decls:10,vars:2,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],["lines","none",3,"click",4,"ngFor","ngForOf"],["key","accountHistory","position","center"],["lines","none",3,"click"],[1,"pm-v-label"],[1,"pm-camelcase"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-title",1),o.Sb(2,"span",2),o.Ec(3,"Vehical Detail : "),o.Rb(),o.Sb(4,"span",3),o.Ec(5),o.Rb(),o.Rb(),o.Sb(6,"ion-row",4),o.Sb(7,"ion-list"),o.Cc(8,v,56,43,"ion-item",5),o.Rb(),o.Rb(),o.Nb(9,"p-toast",6),o.Rb()),2&e&&(o.Ab(5),o.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),o.Ab(3),o.jc("ngForOf",t.accountList))},directives:[r.k,r.z,r.w,r.s,u.k,d.a,r.q,r.r],pipes:[p.c,u.e],styles:[""]}),m);function g(e,t){if(1&e){var c=o.Tb();o.Sb(0,"ion-item",4),o.ac("click",function(e){o.wc(c);var n=t.$implicit;return o.cc().itemSelect(n),e.stopPropagation()}),o.Sb(1,"ion-label"),o.Sb(2,"h3"),o.Sb(3,"span",5),o.Ec(4,"Account open date : "),o.Rb(),o.Sb(5,"span",6),o.Sb(6,"strong"),o.Ec(7),o.Rb(),o.Rb(),o.Rb(),o.Sb(8,"h3"),o.Sb(9,"span",5),o.Ec(10,"Account close date : "),o.Rb(),o.Sb(11,"span",6),o.Sb(12,"strong"),o.Ec(13),o.Rb(),o.Rb(),o.Rb(),o.Sb(14,"h3"),o.Sb(15,"span",5),o.Ec(16,"Total amount : "),o.Rb(),o.Sb(17,"span",6),o.Sb(18,"strong"),o.Ec(19),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Rb()}if(2&e){var n=t.$implicit;o.Ab(7),o.Fc(n.rentPlan),o.Ab(6),o.Fc(n.rentAmount),o.Ab(6),o.Fc(n.vehicleType)}}var S,y=((S=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.config=n,this.ref=i,this.popoverController=a,this.translate=o,this.dbprovider=s,this.messageService=l,this.rentplans=[],this.tableName="rentPlan",this.vehicleType=JSON.parse(JSON.stringify(n.data.vehicleType)),this.fetchData()}return c(t,[{key:"backButtonOnclick",value:function(){this.popoverController.dismiss()}},{key:"itemSelect",value:function(e){this.ref.close(e)}},{key:"fetchData",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleType":this.vehicleType,"data.type":this.tableName},sort:["data.vehicleType"]}).then(function(t){t&&"SUCCESS"==t.status?(console.log(t),e.rentplans=t.records):e.messageService.add({key:"rentPlanPopupList",severity:"error",summary:t.message,detail:""})})}}]),t}()).\u0275fac=function(e){return new(e||S)(o.Mb(s.g),o.Mb(l.b),o.Mb(l.d),o.Mb(r.H),o.Mb(p.d),o.Mb(h.a),o.Mb(b.h))},S.\u0275cmp=o.Gb({type:S,selectors:[["rentPlanPopupList"]],decls:5,vars:1,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"pm-rpe-batch"],["lines","none",3,"click",4,"ngFor","ngForOf"],["key","rentPlanPopupList","position","center"],["lines","none",3,"click"],[1,"pm-v-label"],[1,"pm-camelcase"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-row",1),o.Sb(2,"ion-list"),o.Cc(3,g,20,3,"ion-item",2),o.Rb(),o.Rb(),o.Nb(4,"p-toast",3),o.Rb()),2&e&&(o.Ab(3),o.jc("ngForOf",t.rentplans))},directives:[r.k,r.w,r.s,u.k,d.a,r.q,r.r],styles:[""]}),S),R=i("27b0"),A=i("3Pt+");function C(e,t){if(1&e&&(o.Sb(0,"ion-label",14),o.Ec(1),o.Rb()),2&e){var c=o.cc();o.Ab(1),o.Fc(c.selectedRentPlan.rentPlan)}}function M(e,t){if(1&e&&(o.Sb(0,"ion-label",14),o.Ec(1),o.Rb()),2&e){var c=o.cc();o.Ab(1),o.Fc(c.selectedRentPlan.rentAmount)}}var N,E=((N=function(){function t(c,n,i,a,o,s,l,r,b){e(this,t),this.router=c,this.dbconfig=n,this.messageService=i,this.dbprovider=a,this.popoverController=o,this.dialogService=s,this.translate=l,this.config=r,this.ref=b,this.tableName="account",this.savedSuccessMessage="Data saved successfully",this.selectedVehicle=JSON.parse(JSON.stringify(r.data.vehicle));var h=6e4*(new Date).getTimezoneOffset(),u=new Date(Date.now()-h).toISOString().slice(0,-5);this.openDate=u,this.initializeObjects(this.dbconfig.configuration.tableStructure)}return c(t,[{key:"initializeObjects",value:function(e){this.accountObj=JSON.parse(JSON.stringify(e[this.tableName]))}},{key:"openRentPlanList",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.dialogService.open(y,{header:this.translate.instant("rentPlanList.title"),width:"50%",data:{vehicleType:this.selectedVehicle.vehicleType}}).onClose.subscribe(function(e){e&&(t.selectedRentPlan=e)});case 1:case"end":return e.stop()}},e,this)}))}},{key:"saveAction",value:function(){var e=this;this.selectedRentPlan?(this.accountObj.openDate=new Date(this.openDate).getTime(),this.accountObj.rentPlan_lookup=this.selectedRentPlan.id,this.accountObj.vehicle=this.selectedVehicle.id,console.log(this.accountObj),this.dbprovider.save(this.tableName,this.accountObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"accCreation",severity:"success",summary:e.savedSuccessMessage,detail:""}),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"accCreation",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"accCreation",severity:"error",summary:t,detail:""})})):this.messageService.add({key:"accCreation",severity:"error",summary:"Choose rent plan",detail:"",closable:!0})}}]),t}()).\u0275fac=function(e){return new(e||N)(o.Mb(s.g),o.Mb(R.a),o.Mb(b.h),o.Mb(h.a),o.Mb(r.H),o.Mb(l.a),o.Mb(p.d),o.Mb(l.b),o.Mb(l.d))},N.\u0275cmp=o.Gb({type:N,selectors:[["accountCreation"]],decls:30,vars:16,consts:[[1,"pm-rpe-popup",2,"height","255px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-ac-c"],["lines","none",1,"pm-bg-header",2,"padding","0px"],["type","datetime-local",3,"ngModel","ngModelChange"],["lines","none"],["style","float: right;text-align: right;",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","accCreation","position","center"],[2,"float","right","text-align","right"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-title",1),o.Sb(2,"span",2),o.Ec(3," Vehical Details : "),o.Rb(),o.Sb(4,"span",3),o.Ec(5),o.Rb(),o.Rb(),o.Sb(6,"div",4),o.Sb(7,"ion-item",5),o.Sb(8,"ion-label"),o.Ec(9),o.dc(10,"translate"),o.Rb(),o.Sb(11,"input",6),o.ac("ngModelChange",function(e){return t.openDate=e}),o.Rb(),o.Rb(),o.Sb(12,"ion-item",7),o.Sb(13,"ion-label"),o.Ec(14),o.dc(15,"translate"),o.Rb(),o.Cc(16,C,2,1,"ion-label",8),o.Sb(17,"ion-button",9),o.ac("click",function(){return t.openRentPlanList()}),o.Nb(18,"ion-icon",10),o.Rb(),o.Rb(),o.Sb(19,"ion-item",7),o.Sb(20,"ion-label"),o.Ec(21),o.dc(22,"translate"),o.Rb(),o.Cc(23,M,2,1,"ion-label",8),o.Rb(),o.Sb(24,"ion-row",11),o.Sb(25,"ion-col"),o.Sb(26,"ion-button",12),o.ac("click",function(){return t.saveAction()}),o.Ec(27),o.dc(28,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Nb(29,"p-toast",13),o.Rb()),2&e&&(o.Ab(5),o.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),o.Ab(4),o.Fc(o.ec(10,8,"accountCreation.openDate")),o.Ab(2),o.jc("ngModel",t.openDate),o.Ab(3),o.Fc(o.ec(15,10,"accountCreation.selectRentPlan")),o.Ab(2),o.jc("ngIf",t.selectedRentPlan),o.Ab(5),o.Fc(o.ec(22,12,"rentPlanEntry.rentAmount")),o.Ab(2),o.jc("ngIf",t.selectedRentPlan),o.Ab(4),o.Fc(o.ec(28,14,"save")))},directives:[r.k,r.z,r.q,r.r,A.a,A.i,A.l,u.l,r.d,r.o,r.w,r.j,d.a],pipes:[p.c],styles:[""]}),N),O=i("Nf9I"),j=i("jIHw");function k(e,t){if(1&e&&(o.Sb(0,"div",11),o.Sb(1,"ion-item",12),o.Sb(2,"ion-label"),o.Ec(3),o.dc(4,"translate"),o.Rb(),o.Sb(5,"h5"),o.Ec(6),o.Rb(),o.Rb(),o.Sb(7,"ion-item",12),o.Sb(8,"ion-label"),o.Ec(9),o.dc(10,"translate"),o.Rb(),o.Sb(11,"h5"),o.Ec(12),o.dc(13,"translate"),o.Rb(),o.Rb(),o.Sb(14,"ion-item",12),o.Sb(15,"ion-label"),o.Ec(16),o.dc(17,"translate"),o.Rb(),o.Sb(18,"h5"),o.Ec(19),o.dc(20,"translate"),o.Rb(),o.Rb(),o.Sb(21,"ion-item",12),o.Sb(22,"ion-label"),o.Ec(23),o.dc(24,"translate"),o.Rb(),o.Sb(25,"h5"),o.Ec(26),o.dc(27,"translate"),o.Rb(),o.Rb(),o.Sb(28,"ion-item",12),o.Sb(29,"ion-label"),o.Ec(30),o.dc(31,"translate"),o.Rb(),o.Sb(32,"h5"),o.Ec(33),o.dc(34,"date"),o.Rb(),o.Rb(),o.Sb(35,"ion-item",12),o.Sb(36,"ion-label"),o.Ec(37),o.dc(38,"translate"),o.Rb(),o.Sb(39,"h5"),o.Ec(40),o.dc(41,"date"),o.Rb(),o.Rb(),o.Sb(42,"ion-item",12),o.Sb(43,"ion-label"),o.Ec(44),o.dc(45,"translate"),o.Rb(),o.Sb(46,"h5"),o.Ec(47,"Security 1"),o.Rb(),o.Rb(),o.Rb()),2&e){var c=o.cc();o.Ab(3),o.Fc(o.ec(4,16,"accountDetail.rentPlan")),o.Ab(3),o.Fc(c.selectedAccount.rentPlan_lookup.rentPlan),o.Ab(3),o.Fc(o.ec(10,18,"accountDetail.totalAmount")),o.Ab(3),o.Hc("",c.selectedAccount.totalBillAmount," ",o.ec(13,20,"rs"),""),o.Ab(4),o.Fc(o.ec(17,22,"accountDetail.amountReceived")),o.Ab(3),o.Hc("",c.selectedAccount.receivedAmount," ",o.ec(20,24,"rs"),""),o.Ab(4),o.Fc(o.ec(24,26,"accountDetail.pendingAmount")),o.Ab(3),o.Hc("",c.selectedAccount.totalBillAmount-c.selectedAccount.receivedAmount," ",o.ec(27,28,"rs"),""),o.Ab(4),o.Fc(o.ec(31,30,"accountDetail.accOpenDate")),o.Ab(3),o.Fc(o.fc(34,32,c.selectedAccount.openDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Fc(o.ec(38,35,"accountDetail.accCloseDate")),o.Ab(3),o.Fc(o.fc(41,37,c.selectedAccount.closeDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Fc(o.ec(45,40,"accountDetail.accAddBy"))}}function V(e,t){1&e&&(o.Sb(0,"div",13),o.Sb(1,"div",14),o.Sb(2,"ion-label"),o.Ec(3,"Active account not available. Create new account."),o.Rb(),o.Rb(),o.Rb())}function T(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",15),o.Sb(1,"button",16),o.ac("click",function(){return o.wc(c),o.cc().createAccount()}),o.Rb(),o.Rb()}}function F(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",17),o.Sb(1,"button",18),o.ac("click",function(){return o.wc(c),o.cc().closeAccount()}),o.Rb(),o.Sb(2,"button",19),o.ac("click",function(){return o.wc(c),o.cc().accountHistory()}),o.dc(3,"translate"),o.Rb(),o.Rb()}2&e&&(o.Ab(2),o.kc("label",o.ec(3,1,"history")))}function w(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",17),o.Sb(1,"button",20),o.ac("click",function(){return o.wc(c),o.cc().createAccount()}),o.Rb(),o.Sb(2,"button",19),o.ac("click",function(){return o.wc(c),o.cc().accountHistory()}),o.dc(3,"translate"),o.Rb(),o.Rb()}2&e&&(o.Ab(2),o.kc("label",o.ec(3,1,"history")))}var D,I=((D=function(){function t(c,n,i,a,o,s,l,r,b){e(this,t),this.confirmationService=c,this.dlgref=n,this.router=i,this.popoverController=a,this.translate=o,this.dialogService=s,this.messageService=l,this.dbprovider=r,this.config=b,this.tableName="account",this.vehicleTableName="vehicle",this.savedSuccessMessage="Account closed successfully",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(b.data.vehicle)),this.fetchAccounts()}return c(t,[{key:"accountHistory",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("history"),this.dlgref.close(),this.dialogService.open(f,{header:this.translate.instant("accountHistory.title"),width:"50%",data:{vehicle:this.selectedVehicle}});case 1:case"end":return e.stop()}},e,this)}))}},{key:"createAccount",value:function(){var e=this;console.log("account creation"),this.dialogService.open(E,{header:this.translate.instant("accountCreation.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(function(t){t&&"SUCCESS"==t&&e.fetchAccounts()})}},{key:"closeAccount",value:function(){var e=this;console.log("close call"),this.confirmationService.confirm({message:"Are you sure that you want to close this account?",accept:function(){e.selectedAccount.closeDate=(new Date).getTime(),e.dbprovider.save(e.tableName,e.selectedAccount).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"accountDetail",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.fetchAccounts()):e.messageService.add({key:"accountDetail",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(e){console.log(e)})}})}},{key:"fetchAccounts",value:function(){var e=this;this.selectedAccount=null,this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(function(t){console.log(t),t&&"SUCCESS"==t.status?(t.records.length>0&&t.records.forEach(function(t){t.closeDate||(e.selectedAccount=t)}),e.accountList=t.records):e.messageService.add({key:"accountDetail",severity:"error",summary:t.message,detail:""})})}}]),t}()).\u0275fac=function(e){return new(e||D)(o.Mb(b.b),o.Mb(l.d),o.Mb(s.g),o.Mb(r.H),o.Mb(p.d),o.Mb(l.a),o.Mb(b.h),o.Mb(h.a),o.Mb(l.b))},D.\u0275cmp=o.Gb({type:D,selectors:[["accountDetail"]],decls:14,vars:6,consts:[[1,"pm-rpe-popup",2,"height","375px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],["class","pm-r-car-list pm-ac-d-list",4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","accountDetail","position","center"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[2,"text-align","center"],["class","p-buttonset","style","text-align: center;",4,"ngIf"],["class","p-buttonset",4,"ngIf"],[1,"pm-r-car-list","pm-ac-d-list"],["lines","none"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],[1,"p-buttonset",2,"text-align","center"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",3,"click"],[1,"p-buttonset"],["pButton","","type","button","label","Close account","icon","pi pi-times-circle",2,"float","left",3,"click"],["pButton","","type","button","icon","pi pi-clock",2,"float","right",3,"label","click"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",2,"float","left",3,"click"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-title",1),o.Sb(2,"span",2),o.Ec(3," Vehical Details : "),o.Rb(),o.Sb(4,"span",3),o.Ec(5),o.Rb(),o.Rb(),o.Cc(6,k,48,42,"div",4),o.Cc(7,V,4,0,"div",5),o.Nb(8,"p-toast",6),o.Nb(9,"p-confirmDialog",7),o.Rb(),o.Sb(10,"ion-footer",8),o.Cc(11,T,2,0,"span",9),o.Cc(12,F,4,3,"span",10),o.Cc(13,w,4,3,"span",10),o.Rb()),2&e&&(o.Ab(5),o.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),o.Ab(1),o.jc("ngIf",t.selectedAccount),o.Ab(1),o.jc("ngIf",!t.selectedAccount),o.Ab(4),o.jc("ngIf",!t.selectedAccount&&0==t.accountList.length),o.Ab(1),o.jc("ngIf",t.selectedAccount&&t.accountList.length>0),o.Ab(1),o.jc("ngIf",!t.selectedAccount&&t.accountList.length>0))},directives:[r.k,r.z,u.l,d.a,O.a,r.l,r.q,r.r,j.b],pipes:[p.c,u.e],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}.pm-ac-d-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background:#fff;color:#212e3f;border-bottom:1px solid #ececec}"]}),D)},VqLa:function(t,n,i){"use strict";i.d(n,"a",function(){return C});var a=i("mrSG"),o=i("xHpX"),s=i("fXoL"),l=i("tyNb"),r=i("sYmb"),b=i("7zfz"),h=i("tp0D"),u=i("J7/z"),d=i("TEn/"),p=i("ofXK"),v=i("Gxio"),m=i("jIHw");function f(e,t){if(1&e&&(s.Sb(0,"h3"),s.Sb(1,"span",13),s.Ec(2,"Name : "),s.Rb(),s.Sb(3,"span",14),s.Sb(4,"strong"),s.Ec(5),s.Rb(),s.Rb(),s.Rb()),2&e){var c=s.cc().$implicit;s.Ab(5),s.Fc(c.contactName)}}function g(e,t){if(1&e&&(s.Sb(0,"h3"),s.Sb(1,"span",13),s.Ec(2,"\u0baa\u0bc6\u0baf\u0bb0\u0bcd : "),s.Rb(),s.Sb(3,"span",14),s.Sb(4,"strong"),s.Ec(5),s.Rb(),s.Rb(),s.Rb()),2&e){var c=s.cc().$implicit;s.Ab(5),s.Fc(c.contactNameInTamil)}}function S(e,t){if(1&e){var c=s.Tb();s.Sb(0,"ion-item",10),s.ac("click",function(e){s.wc(c);var n=t.$implicit;return s.cc(2).editContact(n),e.stopPropagation()}),s.Sb(1,"ion-avatar",11),s.Nb(2,"ion-icon",12),s.Rb(),s.Sb(3,"ion-label"),s.Cc(4,f,6,1,"h3",5),s.Cc(5,g,6,1,"h3",5),s.Sb(6,"h3"),s.Sb(7,"span",13),s.Ec(8,"Mobile Number : "),s.Rb(),s.Sb(9,"span",14),s.Sb(10,"strong"),s.Ec(11),s.Rb(),s.Rb(),s.Rb(),s.Sb(12,"h3"),s.Sb(13,"span",13),s.Ec(14,"License Number : "),s.Rb(),s.Sb(15,"span",14),s.Sb(16,"strong"),s.Ec(17),s.Rb(),s.Rb(),s.Rb(),s.Sb(18,"h3"),s.Sb(19,"span",13),s.Ec(20,"Security Name : "),s.Rb(),s.Sb(21,"span",14),s.Sb(22,"strong"),s.Ec(23),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.Rb()}if(2&e){var n=t.$implicit,i=s.cc(2);s.Ab(4),s.jc("ngIf",i.appLanguage&&"en"==i.appLanguage),s.Ab(1),s.jc("ngIf",i.appLanguage&&"ta"==i.appLanguage),s.Ab(6),s.Fc(n.contactMobile),s.Ab(6),s.Fc(n.licenseNumber),s.Ab(6),s.Fc(n.securityName)}}function y(e,t){if(1&e&&(s.Sb(0,"ion-list"),s.Cc(1,S,24,5,"ion-item",9),s.Rb()),2&e){var c=s.cc();s.Ab(1),s.jc("ngForOf",c.contactList)}}function R(e,t){if(1&e){var c=s.Tb();s.Sb(0,"div",15),s.Sb(1,"div",16),s.Sb(2,"ion-label"),s.Ec(3,"Alternate contact not available."),s.Rb(),s.Nb(4,"br"),s.Nb(5,"br"),s.Sb(6,"button",17),s.ac("click",function(){return s.wc(c),s.cc().createAlternateContact()}),s.Rb(),s.Rb(),s.Rb()}}function A(e,t){if(1&e){var c=s.Tb();s.Sb(0,"ion-footer",18),s.Sb(1,"span",19),s.Sb(2,"button",17),s.ac("click",function(){return s.wc(c),s.cc().createAlternateContact()}),s.Rb(),s.Rb(),s.Rb()}}var C=function(){var t=function(){function t(c,n,i,a,o,s){e(this,t),this.router=c,this.translate=n,this.messageService=i,this.dbprovider=a,this.config=o,this.dialogService=s,this.contactList=[],this.appLanguage="ta",this.contactTableName="contact",this.vehicleContactAssignmentTableName="vehicleContactAssignment",this.appLanguage=this.translate.getDefaultLang(),this.selectedVehicle=JSON.parse(JSON.stringify(o.data.vehicle)),this.fetchAlternateContactList()}return c(t,[{key:"itemSelect",value:function(e){}},{key:"fetchAlternateContactList",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicle_lookup":this.selectedVehicle.id,"data.type":this.vehicleContactAssignmentTableName},sort:["data.vehicle_lookup"]}).then(function(t){if(console.log(t),"SUCCESS"==t.status&&t.records.length>0){var c=t.records.map(function(e){return e.contact_lookup}).map(function(t){return e.contactTableName+"_2_"+t});e.fetchContactListAgainstVehicle(c)}else e.messageService.add({key:"alternateContactList",severity:"error",summary:t.message,detail:""})})}},{key:"fetchContactListAgainstVehicle",value:function(e){var t=this;console.log(e),this.contactList=[],this.dbprovider.fetchDocsWithDocIds(e).then(function(e){console.log(e),"SUCCESS"==e.status&&e.response.length>0?e.response.forEach(function(e){console.log(e),"others"==e.contactType&&t.contactList.push(e)}):t.contactList=[]}).catch(function(e){t.contactList=[]})}},{key:"createAlternateContact",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("add contact"),this.dialogService.open(o.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:"",mode:"new",contactType:"Others",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(function(e){e&&"SUCCESS"==e&&t.fetchAlternateContactList()});case 1:case"end":return e.stop()}},e,this)}))}},{key:"editContact",value:function(e){var t=this;console.log(e),delete JSON.parse(JSON.stringify(e)).selected,this.dialogService.open(o.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:e,mode:"edit",contactType:"Primary",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(function(e){e&&"SUCCESS"==e&&t.fetchAlternateContactList()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Mb(l.g),s.Mb(r.d),s.Mb(b.h),s.Mb(h.a),s.Mb(u.b),s.Mb(u.a))},t.\u0275cmp=s.Gb({type:t,selectors:[["contactListAgainstCar"]],decls:11,vars:4,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],[4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","alternateContactList","position","center"],["style","text-align: center;",4,"ngIf"],["lines","none",3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click"],["slot","start"],["name","person-circle-outline"],[1,"pm-v-label"],[1,"pm-camelcase"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],["pButton","","type","button","label","Create alternate contact","icon","pi pi-plus",3,"click"],[2,"text-align","center"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(s.Sb(0,"ion-content",0),s.Sb(1,"ion-title",1),s.Sb(2,"span",2),s.Ec(3," Vehical Details : "),s.Rb(),s.Sb(4,"span",3),s.Ec(5),s.Rb(),s.Rb(),s.Sb(6,"ion-row",4),s.Cc(7,y,2,1,"ion-list",5),s.Rb(),s.Cc(8,R,7,0,"div",6),s.Nb(9,"p-toast",7),s.Rb(),s.Cc(10,A,3,0,"ion-footer",8)),2&e&&(s.Ab(5),s.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),s.Ab(2),s.jc("ngIf",0!=t.contactList.length),s.Ab(1),s.jc("ngIf",0==t.contactList.length),s.Ab(2),s.jc("ngIf",t.contactList.length>0))},directives:[d.k,d.z,d.w,p.l,v.a,d.s,p.k,d.q,d.c,d.o,d.r,m.b,d.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),t}()},XqSU:function(t,n,i){"use strict";i.d(n,"a",function(){return N});var a,o=i("mrSG"),s=i("3Pt+"),l=i("fXoL"),r=i("tyNb"),b=i("27b0"),h=i("tp0D"),u=i("7zfz"),d=i("J7/z"),p=i("TEn/"),v=i("Gxio"),m=i("sYmb"),f=((a=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.dbconfig=n,this.formBuilder=i,this.dbprovider=a,this.messageService=o,this.ref=s,this.config=l,this.alternateVehicleObj={},this.vehicleObj={},this.contactId="",this.vehicleId="",this.tableName="alternateVehicle",this.savedSuccessMessage="Data saved successfully",this.vehicleObj=JSON.parse(JSON.stringify(l.data.vehicle)),"edit"==l.data.mode?this.alternateVehicleObj=JSON.parse(JSON.stringify(l.data.object)):this.initializeObjects(this.dbconfig.configuration.tableStructure),this.createFormGroup(),this.contactId=this.config.data.contactId}return c(t,[{key:"initializeObjects",value:function(e){this.alternateVehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.alternateVehicleObj.vehicleType="bike"}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",s.o.compose([s.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",s.o.compose([s.o.required])]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.alternateVehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.alternateVehicleObj.vehicleType,vehicleBrand:this.alternateVehicleObj.vehicleBrand,vehicleModel:this.alternateVehicleObj.vehicleModel,vehicleColor:this.alternateVehicleObj.vehicleColor,vehicleNumber:this.alternateVehicleObj.vehicleNumber.toUpperCase()}}),this.alternateVehicleObj.vehicle=this.vehicleObj.id,this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.alternateVehicleObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"alternateVehicleEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.vehicleId=t.id,setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.alternateVehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.alternateVehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}}]),t}()).\u0275fac=function(e){return new(e||a)(l.Mb(r.g),l.Mb(b.a),l.Mb(s.b),l.Mb(h.a),l.Mb(u.h),l.Mb(d.d),l.Mb(d.b))},a.\u0275cmp=l.Gb({type:a,selectors:[["alternateVehicleEntry"]],decls:50,vars:36,consts:[[1,"pm-rpe-popup",2,"height","360px"],[3,"formGroup"],["lines","none","formGroupName","vehicle"],["value","bike","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["lines","none",1,"pm-no-b-b"],["value","bike",1,"pm-rsmar"],["value","car",1,"pm-rsmar"],["value","auto",1,"pm-rsmar"],["value","others",1,"pm-rsmar"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","alternateVehicleEntry","position","center"]],template:function(e,t){1&e&&(l.Sb(0,"ion-content",0),l.Sb(1,"form",1),l.Sb(2,"ion-item",2),l.Sb(3,"ion-radio-group",3),l.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleType=e}),l.Sb(4,"ion-label"),l.Ec(5),l.dc(6,"translate"),l.Rb(),l.Sb(7,"ion-item",4),l.Nb(8,"ion-radio",5),l.Sb(9,"ion-label"),l.Ec(10),l.dc(11,"translate"),l.Rb(),l.Nb(12,"ion-radio",6),l.Sb(13,"ion-label"),l.Ec(14),l.dc(15,"translate"),l.Rb(),l.Nb(16,"ion-radio",7),l.Sb(17,"ion-label"),l.Ec(18),l.dc(19,"translate"),l.Rb(),l.Nb(20,"ion-radio",8),l.Sb(21,"ion-label"),l.Ec(22),l.dc(23,"translate"),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Sb(24,"ion-item",2),l.Sb(25,"ion-label",9),l.Ec(26),l.dc(27,"translate"),l.Rb(),l.Sb(28,"ion-input",10),l.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleBrand=e}),l.Rb(),l.Rb(),l.Sb(29,"ion-item",2),l.Sb(30,"ion-label",9),l.Ec(31),l.dc(32,"translate"),l.Rb(),l.Sb(33,"ion-input",11),l.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleModel=e}),l.Rb(),l.Rb(),l.Sb(34,"ion-item",2),l.Sb(35,"ion-label",9),l.Ec(36),l.dc(37,"translate"),l.Rb(),l.Sb(38,"ion-input",12),l.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleColor=e}),l.Rb(),l.Rb(),l.Sb(39,"ion-item",2),l.Sb(40,"ion-label",9),l.Ec(41),l.dc(42,"translate"),l.Rb(),l.Sb(43,"ion-input",13),l.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleNumber=e}),l.Rb(),l.Rb(),l.Sb(44,"ion-row",14),l.Sb(45,"ion-col"),l.Sb(46,"ion-button",15),l.ac("click",function(){return t.saveAction()}),l.Ec(47),l.dc(48,"translate"),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Nb(49,"p-toast",16),l.Rb()),2&e&&(l.Ab(1),l.jc("formGroup",t.formGroup),l.Ab(2),l.jc("ngModel",t.alternateVehicleObj.vehicleType),l.Ab(2),l.Fc(l.ec(6,16,"vehicleEntry.vehicleType")),l.Ab(5),l.Fc(l.ec(11,18,"vehicleEntry.bike")),l.Ab(4),l.Fc(l.ec(15,20,"vehicleEntry.car")),l.Ab(4),l.Fc(l.ec(19,22,"vehicleEntry.auto")),l.Ab(4),l.Fc(l.ec(23,24,"vehicleEntry.others")),l.Ab(4),l.Gc("",l.ec(27,26,"vehicleEntry.vehicleBrand")," "),l.Ab(2),l.jc("ngModel",t.alternateVehicleObj.vehicleBrand),l.Ab(3),l.Fc(l.ec(32,28,"vehicleEntry.vehicleModel")),l.Ab(2),l.jc("ngModel",t.alternateVehicleObj.vehicleModel),l.Ab(3),l.Fc(l.ec(37,30,"vehicleEntry.vehicleColor")),l.Ab(2),l.jc("ngModel",t.alternateVehicleObj.vehicleColor),l.Ab(3),l.Fc(l.ec(42,32,"vehicleEntry.vehicleNumber")),l.Ab(2),l.jc("ngModel",t.alternateVehicleObj.vehicleNumber),l.Ab(4),l.Fc(l.ec(48,34,"save")))},directives:[p.k,s.p,s.j,s.d,p.q,s.e,p.u,p.J,s.i,s.c,p.r,p.t,p.I,p.p,p.K,s.n,p.w,p.j,p.d,v.a],pipes:[m.c],styles:[""]}),a),g=i("ofXK"),S=i("jIHw");function y(e,t){if(1&e){var c=l.Tb();l.Sb(0,"ion-item",10),l.ac("click",function(e){l.wc(c);var n=t.$implicit;return l.cc(2).itemSelect(n),e.stopPropagation()}),l.Sb(1,"ion-avatar",11),l.Nb(2,"ion-icon",12),l.Rb(),l.Sb(3,"ion-label"),l.Sb(4,"h3"),l.Sb(5,"span",13),l.Ec(6,"Vehicle Type : "),l.Rb(),l.Sb(7,"span",14),l.Sb(8,"strong"),l.Ec(9),l.Rb(),l.Rb(),l.Rb(),l.Sb(10,"h3"),l.Sb(11,"span",13),l.Ec(12,"Vehicle Brand : "),l.Rb(),l.Sb(13,"span",14),l.Sb(14,"strong"),l.Ec(15),l.Rb(),l.Rb(),l.Rb(),l.Sb(16,"h3"),l.Sb(17,"span",13),l.Ec(18,"Vehicle Number : "),l.Rb(),l.Sb(19,"span",14),l.Sb(20,"strong"),l.Ec(21),l.Rb(),l.Rb(),l.Rb(),l.Sb(22,"h3"),l.Sb(23,"span",13),l.Ec(24,"Vehicle Color : "),l.Rb(),l.Sb(25,"span",14),l.Sb(26,"strong"),l.Ec(27),l.Rb(),l.Rb(),l.Rb(),l.Sb(28,"h3"),l.Sb(29,"span",13),l.Ec(30,"Added By : "),l.Rb(),l.Sb(31,"span",14),l.Sb(32,"strong"),l.Ec(33),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb()}if(2&e){var n=t.$implicit;l.Ab(9),l.Fc(n.vehicleType),l.Ab(6),l.Hc("",n.vehicleBrand," ",n.vehicleModel,""),l.Ab(6),l.Fc(n.vehicleNumber),l.Ab(6),l.Fc(n.vehicleColor),l.Ab(6),l.Fc(n.addedBy)}}function R(e,t){if(1&e&&(l.Sb(0,"ion-list"),l.Cc(1,y,34,6,"ion-item",9),l.Rb()),2&e){var c=l.cc();l.Ab(1),l.jc("ngForOf",c.vehicleList)}}function A(e,t){if(1&e){var c=l.Tb();l.Sb(0,"div",15),l.Sb(1,"div",16),l.Sb(2,"ion-label"),l.Ec(3,"Alternate vehicle not available."),l.Rb(),l.Nb(4,"br"),l.Nb(5,"br"),l.Sb(6,"button",17),l.ac("click",function(){return l.wc(c),l.cc().createAlternateVehicle()}),l.Rb(),l.Rb(),l.Rb()}}function C(e,t){if(1&e){var c=l.Tb();l.Sb(0,"ion-footer",18),l.Sb(1,"span",19),l.Sb(2,"button",17),l.ac("click",function(){return l.wc(c),l.cc().createAlternateVehicle()}),l.Rb(),l.Rb(),l.Rb()}}var M,N=((M=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.popoverController=n,this.translate=i,this.messageService=a,this.dbprovider=o,this.config=s,this.dialogService=l,this.vehicleList=[],this.tableName="alternateVehicle",this.vehicleTableName="vehicle",this.selectedVehicle=JSON.parse(JSON.stringify(s.data.vehicle)),this.fetchAlternateVehicles()}return c(t,[{key:"createAlternateVehicle",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("alternate vehicle detail"),this.dialogService.open(f,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:"",mode:"new"}}).onClose.subscribe(function(e){t.fetchAlternateVehicles()});case 1:case"end":return e.stop()}},e,this)}))}},{key:"fetchAlternateVehicles",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id).then(function(t){console.log(t),t&&"SUCCESS"==t.status?e.vehicleList=t.records:e.messageService.add({key:"alternateVehicleList",severity:"error",summary:t.message,detail:""})})}},{key:"itemSelect",value:function(e){var t=this;this.dialogService.open(f,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:e,mode:"edit"}}).onClose.subscribe(function(e){t.fetchAlternateVehicles()})}}]),t}()).\u0275fac=function(e){return new(e||M)(l.Mb(r.g),l.Mb(p.H),l.Mb(m.d),l.Mb(u.h),l.Mb(h.a),l.Mb(d.b),l.Mb(d.a))},M.\u0275cmp=l.Gb({type:M,selectors:[["alternateVehicleList"]],decls:11,vars:4,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],[4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","alternateVehicleList","position","center"],["style","text-align: center;",4,"ngIf"],["lines","none",3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click"],["slot","start"],["name","car-sport-outline",2,"font-size","50px"],[1,"pm-v-label"],[1,"pm-camelcase"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],["pButton","","type","button","label","Create alternate vehicle","icon","pi pi-plus",3,"click"],[2,"text-align","center"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(l.Sb(0,"ion-content",0),l.Sb(1,"ion-title",1),l.Sb(2,"span",2),l.Ec(3,"Vehical Details : "),l.Rb(),l.Sb(4,"span",3),l.Ec(5),l.Rb(),l.Rb(),l.Sb(6,"ion-row",4),l.Cc(7,R,2,1,"ion-list",5),l.Rb(),l.Cc(8,A,7,0,"div",6),l.Nb(9,"p-toast",7),l.Rb(),l.Cc(10,C,3,0,"ion-footer",8)),2&e&&(l.Ab(5),l.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),l.Ab(2),l.jc("ngIf",0!=t.vehicleList.length),l.Ab(1),l.jc("ngIf",0==t.vehicleList.length),l.Ab(2),l.jc("ngIf",t.vehicleList.length>0))},directives:[p.k,p.z,p.w,g.l,v.a,p.s,g.k,p.q,p.c,p.o,p.r,S.b,p.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),M)},eKwt:function(t,n,i){"use strict";i.d(n,"a",function(){return v});var a=i("3Pt+"),o=i("fXoL"),s=i("tyNb"),l=i("27b0"),r=i("tp0D"),b=i("7zfz"),h=i("J7/z"),u=i("TEn/"),d=i("Gxio"),p=i("sYmb"),v=function(){var t=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.dbconfig=n,this.formBuilder=i,this.dbprovider=a,this.messageService=o,this.ref=s,this.config=l,this.vehicleObj={},this.vehicleandContactAssgObj={},this.contactId="",this.vehicleId="",this.tableName="vehicle",this.assignmenttableName="vehicleContactAssignment",this.savedSuccessMessage="Data saved successfully","edit"==l.data.mode?this.vehicleObj=JSON.parse(JSON.stringify(l.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup(),this.contactId=this.config.data.contactId}return c(t,[{key:"initializeObjects",value:function(e){this.vehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.vehicleObj.vehicleType="car"}},{key:"initializeAssignmentObjects",value:function(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",a.o.compose([a.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",a.o.compose([a.o.required])]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.vehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.vehicleObj.vehicleType,vehicleBrand:this.vehicleObj.vehicleBrand,vehicleModel:this.vehicleObj.vehicleModel,vehicleColor:this.vehicleObj.vehicleColor,vehicleNumber:this.vehicleObj.vehicleNumber.toUpperCase()}}),this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"vehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.vehicleObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"vehicleEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.vehicleId=t.id,"edit"!=e.config.data.mode?e.saveContactAndVehicleAssignment():setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"vehicleEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"vehicleEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.vehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.vehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}},{key:"saveContactAndVehicleAssignment",value:function(){var e=this;this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(function(t){console.log(t),"SUCCESS"!=t.status?console.log("Vehicle assignment save failed",t):console.log("Vehicle assignment save Success"),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Mb(s.g),o.Mb(l.a),o.Mb(a.b),o.Mb(r.a),o.Mb(b.h),o.Mb(h.d),o.Mb(h.b))},t.\u0275cmp=o.Gb({type:t,selectors:[["vehicleEntry"]],decls:46,vars:33,consts:[[1,"pm-rpe-popup",2,"height","360px"],[3,"formGroup"],["lines","none","formGroupName","vehicle"],["value","car","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["lines","none",1,"pm-no-b-b"],["value","car",1,"pm-rsmar"],["value","auto",1,"pm-rsmar"],["value","others",1,"pm-rsmar"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","vehicleEntry","position","center"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"form",1),o.Sb(2,"ion-item",2),o.Sb(3,"ion-radio-group",3),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleType=e}),o.Sb(4,"ion-label"),o.Ec(5),o.dc(6,"translate"),o.Rb(),o.Sb(7,"ion-item",4),o.Nb(8,"ion-radio",5),o.Sb(9,"ion-label"),o.Ec(10),o.dc(11,"translate"),o.Rb(),o.Nb(12,"ion-radio",6),o.Sb(13,"ion-label"),o.Ec(14),o.dc(15,"translate"),o.Rb(),o.Nb(16,"ion-radio",7),o.Sb(17,"ion-label"),o.Ec(18),o.dc(19,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Sb(20,"ion-item",2),o.Sb(21,"ion-label",8),o.Ec(22),o.dc(23,"translate"),o.Rb(),o.Sb(24,"ion-input",9),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleBrand=e}),o.Rb(),o.Rb(),o.Sb(25,"ion-item",2),o.Sb(26,"ion-label",8),o.Ec(27),o.dc(28,"translate"),o.Rb(),o.Sb(29,"ion-input",10),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleModel=e}),o.Rb(),o.Rb(),o.Sb(30,"ion-item",2),o.Sb(31,"ion-label",8),o.Ec(32),o.dc(33,"translate"),o.Rb(),o.Sb(34,"ion-input",11),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleColor=e}),o.Rb(),o.Rb(),o.Sb(35,"ion-item",2),o.Sb(36,"ion-label",8),o.Ec(37),o.dc(38,"translate"),o.Rb(),o.Sb(39,"ion-input",12),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleNumber=e}),o.Rb(),o.Rb(),o.Sb(40,"ion-row",13),o.Sb(41,"ion-col"),o.Sb(42,"ion-button",14),o.ac("click",function(){return t.saveAction()}),o.Ec(43),o.dc(44,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Nb(45,"p-toast",15),o.Rb()),2&e&&(o.Ab(1),o.jc("formGroup",t.formGroup),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleType),o.Ab(2),o.Fc(o.ec(6,15,"vehicleEntry.vehicleType")),o.Ab(5),o.Fc(o.ec(11,17,"vehicleEntry.car")),o.Ab(4),o.Fc(o.ec(15,19,"vehicleEntry.auto")),o.Ab(4),o.Fc(o.ec(19,21,"vehicleEntry.others")),o.Ab(4),o.Gc("",o.ec(23,23,"vehicleEntry.vehicleBrand")," "),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleBrand),o.Ab(3),o.Fc(o.ec(28,25,"vehicleEntry.vehicleModel")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleModel),o.Ab(3),o.Fc(o.ec(33,27,"vehicleEntry.vehicleColor")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleColor),o.Ab(3),o.Fc(o.ec(38,29,"vehicleEntry.vehicleNumber")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleNumber),o.Ab(4),o.Fc(o.ec(44,31,"save")))},directives:[u.k,a.p,a.j,a.d,u.q,a.e,u.u,u.J,a.i,a.c,u.r,u.t,u.I,u.p,u.K,a.n,u.w,u.j,u.d,d.a],pipes:[p.c],styles:[""]}),t}()},xHpX:function(t,n,i){"use strict";i.d(n,"a",function(){return v});var a=i("3Pt+"),o=i("fXoL"),s=i("tyNb"),l=i("27b0"),r=i("tp0D"),b=i("7zfz"),h=i("J7/z"),u=i("TEn/"),d=i("Gxio"),p=i("sYmb"),v=function(){var t=function(){function t(c,n,i,a,o,s,l){e(this,t),this.router=c,this.dbconfig=n,this.formBuilder=i,this.dbprovider=a,this.messageService=o,this.ref=s,this.config=l,this.contactObj={},this.tableName="contact",this.savedSuccessMessage="Data saved successfully",this.contactType="",this.vehicleandContactAssgObj={},this.assignmenttableName="vehicleContactAssignment",this.contactType=this.config.data.contactType,this.vehicleId=this.config.data.vehicleId,"edit"==l.data.mode?this.contactObj=JSON.parse(JSON.stringify(l.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup()}return c(t,[{key:"initializeAssignmentObjects",value:function(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}},{key:"initializeObjects",value:function(e){this.contactObj=JSON.parse(JSON.stringify(e[this.tableName])),this.contactObj.contactType="Primary"==this.contactType?"owner":"others"}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({contact:this.formBuilder.group({contactName:["",a.o.compose([a.o.maxLength(80),a.o.required])],contactNameInTamil:[""],contactMobile:["",[a.o.required,a.o.pattern("^((\\+91-?)|0)?[0-9]{10}$")]],licenseNumber:[""]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.contactObj),this.formGroup.patchValue({contact:{contactName:this.contactObj.contactName,contactNameInTamil:this.contactObj.contactNameInTamil,contactMobile:this.contactObj.contactMobile,licenseNumber:this.contactObj.licenseNumber}}),this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"contactEntry",severity:"error",summary:"Mobile number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.contactObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"contactEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.contactId=t.id,"edit"!=e.config.data.mode&&"others"==e.contactObj.contactType?e.saveContactAndVehicleAssignment():setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"contactEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"contactEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"contactEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.contactObj.contactMobile==this.config.data.object.contactMobile?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.contactMobile":this.contactObj.contactMobile,"data.type":this.tableName},sort:["data.contactMobile"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}},{key:"saveContactAndVehicleAssignment",value:function(){var e=this;this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(function(t){console.log(t),"SUCCESS"!=t.status?console.log("Vehicle assignment save failed",t):console.log("Vehicle assignment save Success"),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Mb(s.g),o.Mb(l.a),o.Mb(a.b),o.Mb(r.a),o.Mb(b.h),o.Mb(h.d),o.Mb(h.b))},t.\u0275cmp=o.Gb({type:t,selectors:[["contactEntry"]],decls:28,vars:20,consts:[[1,"pm-rpe-popup",2,"height","290px"],[3,"formGroup"],["lines","none","formGroupName","contact"],["position","floating"],["type","text","formControlName","contactName","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","contactNameInTamil",3,"ngModel","ngModelChange"],["type","number","formControlName","contactMobile","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","licenseNumber",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","contactEntry","position","center"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"form",1),o.Sb(2,"ion-item",2),o.Sb(3,"ion-label",3),o.Ec(4),o.dc(5,"translate"),o.Rb(),o.Sb(6,"ion-input",4),o.ac("ngModelChange",function(e){return t.contactObj.contactName=e}),o.Rb(),o.Rb(),o.Sb(7,"ion-item",2),o.Sb(8,"ion-label",3),o.Ec(9),o.dc(10,"translate"),o.Rb(),o.Sb(11,"ion-input",5),o.ac("ngModelChange",function(e){return t.contactObj.contactNameInTamil=e}),o.Rb(),o.Rb(),o.Sb(12,"ion-item",2),o.Sb(13,"ion-label",3),o.Ec(14),o.dc(15,"translate"),o.Rb(),o.Sb(16,"ion-input",6),o.ac("ngModelChange",function(e){return t.contactObj.contactMobile=e}),o.Rb(),o.Rb(),o.Sb(17,"ion-item",2),o.Sb(18,"ion-label",3),o.Ec(19),o.dc(20,"translate"),o.Rb(),o.Sb(21,"ion-input",7),o.ac("ngModelChange",function(e){return t.contactObj.licenseNumber=e}),o.Rb(),o.Rb(),o.Sb(22,"ion-row",8),o.Sb(23,"ion-col"),o.Sb(24,"ion-button",9),o.ac("click",function(){return t.saveAction()}),o.Ec(25),o.dc(26,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Nb(27,"p-toast",10),o.Rb()),2&e&&(o.Ab(1),o.jc("formGroup",t.formGroup),o.Ab(3),o.Gc("",o.ec(5,10,"contactEntry.contactName")," "),o.Ab(2),o.jc("ngModel",t.contactObj.contactName),o.Ab(3),o.Fc(o.ec(10,12,"contactEntry.contactNameInTamil")),o.Ab(2),o.jc("ngModel",t.contactObj.contactNameInTamil),o.Ab(3),o.Fc(o.ec(15,14,"contactEntry.contactMobile")),o.Ab(2),o.jc("ngModel",t.contactObj.contactMobile),o.Ab(3),o.Fc(o.ec(20,16,"contactEntry.licenseNumber")),o.Ab(2),o.jc("ngModel",t.contactObj.licenseNumber),o.Ab(4),o.Gc("",o.ec(26,18,"save")," "))},directives:[u.k,a.p,a.j,a.d,u.q,a.e,u.r,u.p,u.K,a.i,a.c,a.n,u.F,u.w,u.j,u.d,d.a],pipes:[p.c],styles:[""]}),t}()}}])}();