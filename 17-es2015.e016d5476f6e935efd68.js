(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{tmT9:function(e,t,i){"use strict";i.r(t),i.d(t,"vehicleInfoDetailModule",function(){return L});var c=i("ofXK"),n=i("TEn/"),o=i("3Pt+"),l=i("mrSG"),a=i("VqLa"),h=i("XqSU"),s=i("0Eai"),b=i("eKwt"),r=i("fXoL"),d=i("tyNb"),u=i("J7/z"),v=i("sYmb"),p=i("tp0D"),f=i("7zfz"),g=i("jIHw"),S=i("Q4Mo"),m=i("1SLH");function R(e,t){if(1&e&&(r.Sb(0,"div"),r.Sb(1,"div",8),r.Sb(2,"ion-avatar",9),r.Nb(3,"ion-icon",10),r.Rb(),r.Sb(4,"ion-label",11),r.Sb(5,"h3"),r.Ec(6),r.Rb(),r.Rb(),r.Rb(),r.Sb(7,"div",12),r.Sb(8,"ion-label"),r.Sb(9,"h2"),r.Ec(10),r.Rb(),r.Sb(11,"h2"),r.Ec(12),r.Rb(),r.Sb(13,"h2"),r.Sb(14,"b"),r.Ec(15),r.Rb(),r.Rb(),r.Sb(16,"p"),r.Ec(17),r.Rb(),r.Rb(),r.Rb(),r.Rb()),2&e){const e=r.cc();r.Ab(6),r.Fc(e.vehicle.alternateVehicleInfo.vehicleColor),r.Ab(4),r.Fc(e.vehicle.alternateVehicleInfo.vehicleType),r.Ab(2),r.Hc("",e.vehicle.alternateVehicleInfo.vehicleBrand," ",e.vehicle.alternateVehicleInfo.vehicleModel," "),r.Ab(3),r.Fc(e.vehicle.alternateVehicleInfo.vehicleNumber),r.Ab(2),r.Gc("Added By : ",e.vehicle.alternateVehicleInfo.addedBy,"")}}function A(e,t){1&e&&(r.Sb(0,"div"),r.Sb(1,"ion-label",11),r.Nb(2,"br"),r.Sb(3,"h3"),r.Ec(4,"Alternate vehicle not available"),r.Rb(),r.Rb(),r.Rb())}function I(e,t){if(1&e&&(r.Sb(0,"h2"),r.Ec(1),r.Rb()),2&e){const e=r.cc().$implicit;r.Ab(1),r.Fc(e.contactName)}}function C(e,t){if(1&e&&(r.Sb(0,"h2"),r.Ec(1),r.Rb()),2&e){const e=r.cc().$implicit;r.Ab(1),r.Fc(e.contactNameInTamil)}}function V(e,t){if(1&e&&(r.Sb(0,"ion-col",28),r.Sb(1,"div"),r.Sb(2,"ion-label",22),r.Cc(3,I,2,1,"h2",23),r.Cc(4,C,2,1,"h2",23),r.Sb(5,"h2"),r.Ec(6),r.Rb(),r.Rb(),r.Rb(),r.Rb()),2&e){const e=t.$implicit,i=r.cc();r.Ab(3),r.jc("ngIf",i.appLanguage&&"en"==i.appLanguage),r.Ab(1),r.jc("ngIf",i.appLanguage&&"ta"==i.appLanguage),r.Ab(2),r.Fc(e.contactMobile)}}let w=(()=>{class e{constructor(e,t,i,c,n,o,l,a){this.router=e,this.activatRoute=t,this.dialogService=i,this.popoverController=c,this.location=n,this.translate=o,this.dbprovider=l,this.messageService=a,this.contactList=[],this.vehicleList=[],this.fullVehicleList=[],this.queryText="",this.appLanguage="ta",this.contactTableName="contact",this.vehicleTableName="vehicle",this.accountTableName="account",this.alternateVehicleTableName="alternateVehicle",this.vehicleContactAssignmentTableName="vehicleContactAssignment",this.appLanguage=this.translate.getDefaultLang(),this.activatRoute.queryParams.subscribe(e=>{console.log(e),e.vehicle&&(this.vehicle=JSON.parse(e.vehicle),this.selectedContactId=e.selectedContactId,console.log(this.vehicle))}),this.items=[{label:"Actions",items:[{label:this.translate.instant("actions.editVehicle"),icon:"pi pi-angle-right",command:()=>{this.vehicleEditAction()}},{label:this.translate.instant("actions.contactList"),icon:"pi pi-angle-right",command:()=>{this.showAlternateContactList()}},{label:this.translate.instant("actions.alternateVehicleList"),icon:"pi pi-angle-right",command:()=>{this.alternateVehicleList()}},{label:this.translate.instant("actions.accountDetail"),icon:"pi pi-angle-right",command:()=>{this.accountDetail()}}]}]}vehicleEditAction(){return Object(l.a)(this,void 0,void 0,function*(){console.log("edit vehicle"),this.dialogService.open(b.a,{header:this.translate.instant("vehicleEntry.title"),width:"50%",data:{object:this.selectedVehicle,mode:"edit",contactId:this.selectedContactId}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchVehicle()})})}fetchVehicle(){var e=this.vehicleTableName+"_2_"+this.vehicle.vehicleInfo.id;console.log(t);var t=[e];this.vehicleList=[],this.dbprovider.fetchDocsWithDocIds(t).then(e=>{console.log(e),"SUCCESS"==e.status&&e.response.length>0?e.response.forEach(e=>{this.fetchAccountAndAdditionalContactInfo(e.id).then(t=>{t.vehicleInfo=e,console.log("result==>",t),this.vehicleList.push(t),this.vehicleList.length>0&&(this.vehicle=this.vehicleList[0])})}):this.vehicleList=[]}).catch(e=>{this.vehicleList=[]})}fetchAccountAndAdditionalContactInfo(e){let t={},i=[];return i.push(this.fetchAccountInfoAgainstVehicle(e).then(e=>{e?(t.rentPlanInfo=e.rentPlan_lookup,delete e.rentPlan_lookup,t.accountInfo=e,console.log(e)):(t.accountInfo={},t.rentPlanInfo={})})),i.push(this.fetchAdditionalContactInfoAgainstVehicle(e).then(e=>{t.additionalContacts=e})),i.push(this.fetchAlternateVehicleInfoAgainstVehicle(e).then(e=>{t.alternateVehicleInfo=e.length>0?e[0]:{}})),Promise.all(i).then(e=>(console.log(e),t))}fetchAccountInfoAgainstVehicle(e){return this.dbprovider.fetchDocsWithRelationshipUsingFindOption({selector:{"data.vehicle":e,"data.type":this.accountTableName},sort:["data.vehicle"]},!0,{masterandlookupreference:["rentPlan"]}).then(e=>{if(console.log(e),!e||"SUCCESS"!=e.status)return null;if(e.records.length>0){let t=null;return e.records.forEach(e=>{e.closeDate||(t=e)}),t}}).catch(e=>null)}fetchAdditionalContactInfoAgainstVehicle(e){return this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicle_lookup":e,"data.type":this.vehicleContactAssignmentTableName},sort:["data.vehicle_lookup"]}).then(e=>{if(console.log(e),"SUCCESS"==e.status&&e.records.length>0){const t=e.records.map(e=>e.contact_lookup).map(e=>this.contactTableName+"_2_"+e);return this.fetchContactListAgainstVehicle(t)}return[]}).catch(e=>[])}fetchContactListAgainstVehicle(e){console.log(e);var t=[];return this.dbprovider.fetchDocsWithDocIds(e).then(e=>(console.log(e),"SUCCESS"==e.status&&e.response.length>0?(e.response.forEach(e=>{console.log(e),"others"==e.contactType&&t.push(e)}),t):[])).catch(e=>[])}fetchAlternateVehicleInfoAgainstVehicle(e){return this.dbprovider.fetchDocsWithoutRelationshipByParentTypeAndId(this.alternateVehicleTableName,this.vehicleTableName,e).then(e=>(console.log(e),e&&"SUCCESS"==e.status?e.records:null))}menuClick(e){this.selectedVehicle=e.vehicleInfo,console.log("menu click",this.selectedVehicle)}alternateVehicleList(){return Object(l.a)(this,void 0,void 0,function*(){console.log("alternate vehicle detail"),this.dialogService.open(h.a,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(e=>{this.fetchVehicle()})})}accountDetail(){return Object(l.a)(this,void 0,void 0,function*(){console.log("account detail"),this.dialogService.open(s.a,{header:this.translate.instant("accountDetail.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(e=>{this.fetchVehicle()})})}showAlternateContactList(){return Object(l.a)(this,void 0,void 0,function*(){console.log("alternate contact detail"),this.dialogService.open(a.a,{header:this.translate.instant("contactList.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(e=>{this.fetchVehicle()})})}backButtonOnclick(){this.location.back()}}return e.\u0275fac=function(t){return new(t||e)(r.Mb(d.g),r.Mb(d.a),r.Mb(u.a),r.Mb(n.F),r.Mb(c.h),r.Mb(v.d),r.Mb(p.a),r.Mb(f.h))},e.\u0275cmp=r.Gb({type:e,selectors:[["vehicleInfoDetail"]],decls:94,vars:65,consts:[["no-border",""],["slot","start"],["slot","start",3,"click"],["name","arrow-back",2,"font-size","30px","color","black"],["size","large",1,"ion-text-center"],[2,"height","100%"],[2,"background-color","white","height","33.3%","width","100%","max-height","200px","min-height","180px"],["size","5.6",2,"height","99%"],[1,"alignleft",2,"text-align","center","width","30%"],[2,"margin","auto"],["name","car-sport-outline",2,"font-size","50px"],[2,"text-align","center"],[1,"alignleft",2,"width","67%"],[1,"vl","alignright"],[1,"alignleft",2,"width","100%","padding-left","10px"],["size","0.8",2,"background-color","white"],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v","label","",1,"p-button-rounded","p-button-text",3,"click"],["appendTo","body",3,"popup","model"],["menu",""],[1,"hl"],[2,"height","33.3%","max-height","200px","min-height","180px"],[1,"alignleft",2,"width","97%"],[2,"padding-left","10px"],[4,"ngIf"],[2,"width","100%","height","30%"],[2,"padding-left","4px"],[2,"width","100%","height","70%"],["style","min-width: 25%;max-width: 25%;",4,"ngFor","ngForOf"],[2,"min-width","25%","max-width","25%"]],template:function(e,t){if(1&e){const e=r.Tb();r.Sb(0,"ion-header",0),r.Sb(1,"ion-toolbar"),r.Sb(2,"ion-buttons",1),r.Sb(3,"ion-button",2),r.ac("click",function(){return t.backButtonOnclick()}),r.Sb(4,"h2"),r.Nb(5,"ion-icon",3),r.Rb(),r.Rb(),r.Rb(),r.Sb(6,"ion-title",4),r.Ec(7),r.dc(8,"translate"),r.Rb(),r.Rb(),r.Rb(),r.Sb(9,"ion-content"),r.Sb(10,"ion-grid",5),r.Sb(11,"ion-row",6),r.Sb(12,"ion-col",7),r.Sb(13,"h2"),r.Ec(14),r.dc(15,"translate"),r.Rb(),r.Sb(16,"div"),r.Sb(17,"div",8),r.Sb(18,"ion-avatar",9),r.Nb(19,"ion-icon",10),r.Rb(),r.Sb(20,"ion-label",11),r.Sb(21,"h3"),r.Ec(22),r.Rb(),r.Rb(),r.Rb(),r.Sb(23,"div",12),r.Sb(24,"ion-label"),r.Sb(25,"h2"),r.Ec(26),r.Rb(),r.Sb(27,"h2"),r.Ec(28),r.Rb(),r.Sb(29,"h2"),r.Sb(30,"b"),r.Ec(31),r.Rb(),r.Rb(),r.Sb(32,"p"),r.Ec(33),r.Rb(),r.Rb(),r.Rb(),r.Nb(34,"div",13),r.Rb(),r.Rb(),r.Sb(35,"ion-col",7),r.Sb(36,"h2"),r.Ec(37),r.dc(38,"translate"),r.Rb(),r.Sb(39,"div",14),r.Sb(40,"ion-label"),r.Sb(41,"h2"),r.Ec(42),r.dc(43,"translate"),r.Rb(),r.Sb(44,"h2"),r.Ec(45),r.dc(46,"translate"),r.Rb(),r.Sb(47,"p"),r.Ec(48),r.dc(49,"translate"),r.Rb(),r.Sb(50,"p"),r.Ec(51),r.dc(52,"date"),r.Rb(),r.Rb(),r.Rb(),r.Rb(),r.Sb(53,"ion-col",15),r.Sb(54,"button",16),r.ac("click",function(i){return r.wc(e),r.vc(56).toggle(i),t.menuClick(t.vehicle),i.stopPropagation()}),r.Rb(),r.Nb(55,"p-menu",17,18),r.Rb(),r.Nb(57,"div",19),r.Rb(),r.Sb(58,"ion-row",20),r.Sb(59,"ion-col",7),r.Sb(60,"div"),r.Sb(61,"h2"),r.Ec(62),r.dc(63,"translate"),r.Rb(),r.Sb(64,"div",21),r.Sb(65,"ion-label",22),r.Sb(66,"h2"),r.Ec(67),r.dc(68,"translate"),r.dc(69,"translate"),r.Rb(),r.Sb(70,"h2"),r.Ec(71),r.dc(72,"translate"),r.dc(73,"translate"),r.Rb(),r.Sb(74,"h2"),r.Sb(75,"b"),r.Ec(76),r.dc(77,"translate"),r.dc(78,"translate"),r.Rb(),r.Rb(),r.Rb(),r.Rb(),r.Nb(79,"div",13),r.Rb(),r.Rb(),r.Sb(80,"ion-col",7),r.Sb(81,"h2"),r.Ec(82),r.dc(83,"translate"),r.Rb(),r.Cc(84,R,18,6,"div",23),r.Cc(85,A,5,0,"div",23),r.Rb(),r.Nb(86,"div",19),r.Rb(),r.Sb(87,"ion-row",20),r.Sb(88,"ion-row",24),r.Sb(89,"h2",25),r.Ec(90),r.dc(91,"translate"),r.Rb(),r.Rb(),r.Sb(92,"ion-row",26),r.Cc(93,V,7,3,"ion-col",27),r.Rb(),r.Rb(),r.Rb(),r.Rb()}2&e&&(r.Ab(7),r.Gc(" ",r.ec(8,32,"vehicleSearch.vehicleInfo")," "),r.Ab(7),r.Fc(r.ec(15,34,"contactListWithVehicle.primaryVehicleInfo")),r.Ab(8),r.Fc(t.vehicle.vehicleInfo.vehicleColor),r.Ab(4),r.Fc(t.vehicle.vehicleInfo.vehicleType),r.Ab(2),r.Hc("",t.vehicle.vehicleInfo.vehicleBrand," ",t.vehicle.vehicleInfo.vehicleModel," "),r.Ab(3),r.Fc(t.vehicle.vehicleInfo.vehicleNumber),r.Ab(2),r.Gc("Added By : ",t.vehicle.vehicleInfo.addedBy,""),r.Ab(4),r.Fc(r.ec(38,36,"contactListWithVehicle.accountInfo")),r.Ab(5),r.Hc("",r.ec(43,38,"rentPlanEntry.rentPlanName")," : ",t.vehicle.rentPlanInfo.rentPlan,""),r.Ab(3),r.Hc("",t.vehicle.rentPlanInfo.rentAmount," ",r.ec(46,40,"rs"),""),r.Ab(3),r.Gc("",r.ec(49,42,"contactListWithVehicle.accountOpenDate")," :"),r.Ab(3),r.Fc(r.fc(52,44,t.vehicle.accountInfo.openDate,"dd/MM/yyyy hh:mm a")),r.Ab(4),r.jc("popup",!0)("model",t.items),r.Ab(7),r.Fc(r.ec(63,47,"contactListWithVehicle.outstandingInfo")),r.Ab(5),r.Ic("",r.ec(68,49,"contactListWithVehicle.totalAmount")," : ",t.vehicle.accountInfo.totalBillAmount," ",r.ec(69,51,"rs"),""),r.Ab(4),r.Ic("",r.ec(72,53,"contactListWithVehicle.paidAmount")," : ",t.vehicle.accountInfo.receivedAmount," ",r.ec(73,55,"rs"),""),r.Ab(5),r.Ic("",r.ec(77,57,"contactListWithVehicle.pendingAmount")," : ",t.vehicle.accountInfo.totalBillAmount-t.vehicle.accountInfo.receivedAmount," ",r.ec(78,59,"rs"),""),r.Ab(6),r.Fc(r.ec(83,61,"contactListWithVehicle.alternateVehicleInfo")),r.Ab(2),r.jc("ngIf",t.vehicle.alternateVehicleInfo.vehicleType),r.Ab(1),r.jc("ngIf",!t.vehicle.alternateVehicleInfo.vehicleType),r.Ab(5),r.Fc(r.ec(91,63,"contactListWithVehicle.additionalContactInfo")),r.Ab(3),r.jc("ngForOf",t.vehicle.additionalContacts))},directives:[n.m,n.z,n.d,n.c,n.n,n.y,n.j,n.l,n.v,n.i,n.b,n.q,g.b,S.a,m.a,c.l,c.k],pipes:[v.c,c.e],styles:[".sticky[_ngcontent-%COMP%]{position:-webkit-sticky;top:0;height:60px}.alignleft[_ngcontent-%COMP%]{float:left}.alignright[_ngcontent-%COMP%]{float:right}.vl[_ngcontent-%COMP%]{border-left:1px solid #050505;height:100px}.vl2[_ngcontent-%COMP%]{border-left:1px solid #a09d9d;height:100%}.hl[_ngcontent-%COMP%]{border-top:1px solid #a09d9d;width:100%;height:1px;background-color:#000}.my-button[_ngcontent-%COMP%]{--background:#white;--background-activated:#white}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center;align-items:center;width:50%;margin:auto}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%}.right[_ngcontent-%COMP%]{background-color:#fff;display:block;width:100%;overflow-y:scroll}"]}),e})();var E=i("7kUa");const y=[{path:"",component:w}];let L=(()=>{class e{}return e.\u0275mod=r.Kb({type:e}),e.\u0275inj=r.Jb({factory:function(t){return new(t||e)},imports:[[d.k.forChild(y),c.c,o.f,n.A,E.b,g.c,S.b,m.b,v.b],d.k]}),e})()}}]);