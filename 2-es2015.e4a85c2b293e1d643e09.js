(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0Eai":function(e,t,c){"use strict";c.d(t,"a",function(){return V});var i=c("mrSG"),n=c("fXoL"),a=c("J7/z"),o=c("TEn/"),s=c("7zfz"),l=c("tp0D"),r=c("ofXK"),b=c("Gxio"),h=c("sYmb");function d(e,t){if(1&e&&(n.Sb(0,"ion-item",5),n.Sb(1,"ion-label"),n.Sb(2,"h2"),n.Ec(3),n.dc(4,"translate"),n.Sb(5,"b"),n.Ec(6),n.dc(7,"date"),n.Rb(),n.Rb(),n.Sb(8,"h2"),n.Ec(9),n.dc(10,"translate"),n.Sb(11,"b"),n.Ec(12),n.dc(13,"date"),n.Rb(),n.Rb(),n.Sb(14,"h2"),n.Ec(15),n.dc(16,"translate"),n.Sb(17,"b"),n.Ec(18),n.dc(19,"translate"),n.Rb(),n.Rb(),n.Sb(20,"h2"),n.Ec(21),n.dc(22,"translate"),n.Sb(23,"b"),n.Ec(24),n.dc(25,"translate"),n.Rb(),n.Rb(),n.Sb(26,"h2"),n.Ec(27),n.dc(28,"translate"),n.Sb(29,"b"),n.Ec(30),n.dc(31,"translate"),n.Rb(),n.Rb(),n.Sb(32,"h2"),n.Ec(33),n.dc(34,"translate"),n.Sb(35,"b"),n.Ec(36),n.Rb(),n.Rb(),n.Sb(37,"p"),n.Ec(38),n.dc(39,"translate"),n.Rb(),n.Rb(),n.Rb()),2&e){const e=t.$implicit;n.Ab(3),n.Gc("",n.ec(4,17,"accountDetail.accOpenDate")," :"),n.Ab(3),n.Gc(" ",n.fc(7,19,e.openDate,"dd/MM/yyyy hh:mm a"),""),n.Ab(3),n.Gc("",n.ec(10,22,"accountDetail.accCloseDate")," :"),n.Ab(3),n.Gc(" ",n.fc(13,24,e.closeDate,"dd/MM/yyyy hh:mm a"),""),n.Ab(3),n.Gc("",n.ec(16,27,"accountDetail.totalAmount")," :"),n.Ab(3),n.Hc(" ",e.totalBillAmount," ",n.ec(19,29,"rs"),""),n.Ab(3),n.Gc("",n.ec(22,31,"accountDetail.amountReceived")," :"),n.Ab(3),n.Hc(" ",e.receivedAmount," ",n.ec(25,33,"rs"),""),n.Ab(3),n.Gc("",n.ec(28,35,"accountDetail.pendingAmount")," :"),n.Ab(3),n.Hc(" ",e.pendingAmount," ",n.ec(31,37,"rs"),""),n.Ab(3),n.Gc("",n.ec(34,39,"accountDetail.rentPlan")," :"),n.Ab(3),n.Gc(" ",e.rentPlan_lookup.rentPlan,""),n.Ab(2),n.Hc("",n.ec(39,41,"accountDetail.accAddBy")," : ",e.accountAddedBy,"")}}let u=(()=>{class e{constructor(e,t,c,i,n){this.dialogService=e,this.config=t,this.popoverController=c,this.messageService=i,this.dbprovider=n,this.tableName="account",this.vehicleTableName="vehicle",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(t.data.vehicle)),this.fetchAccounts()}fetchAccounts(){this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(e=>{console.log(e),e&&"SUCCESS"==e.status?this.accountList=e.records:this.messageService.add({key:"accountHistory",severity:"error",summary:e.message,detail:""})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.a),n.Mb(a.b),n.Mb(o.G),n.Mb(s.h),n.Mb(l.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountHistory"]],decls:6,vars:2,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],["lines","full",4,"ngFor","ngForOf"],["key","accountHistory","position","center"],["lines","full"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-title",1),n.Ec(2),n.Rb(),n.Sb(3,"ion-list",2),n.Cc(4,d,40,43,"ion-item",3),n.Rb(),n.Nb(5,"p-toast",4),n.Rb()),2&e&&(n.Ab(2),n.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),n.Ab(2),n.jc("ngForOf",t.accountList))},directives:[o.k,o.z,o.s,r.k,b.a,o.q,o.r],pipes:[h.c,r.e],styles:[""]}),e})();var m=c("tyNb");function v(e,t){if(1&e){const e=n.Tb();n.Sb(0,"ion-item",4),n.ac("click",function(c){n.wc(e);const i=t.$implicit;return n.cc().itemSelect(i),c.stopPropagation()}),n.Sb(1,"ion-label"),n.Sb(2,"h2"),n.Ec(3,"Account open date :"),n.Sb(4,"b"),n.Ec(5),n.Rb(),n.Rb(),n.Sb(6,"h2"),n.Ec(7,"Account close date :"),n.Sb(8,"b"),n.Ec(9),n.Rb(),n.Rb(),n.Sb(10,"h2"),n.Ec(11,"Total amount :"),n.Sb(12,"b"),n.Ec(13),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=t.$implicit;n.Ab(5),n.Gc(" ",e.rentPlan,""),n.Ab(4),n.Gc(" ",e.rentAmount,""),n.Ab(4),n.Gc(" ",e.vehicleType,"")}}let g=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.config=t,this.ref=c,this.popoverController=i,this.translate=n,this.dbprovider=a,this.messageService=o,this.rentplans=[],this.tableName="rentPlan",this.vehicleType=JSON.parse(JSON.stringify(t.data.vehicleType)),this.fetchData()}backButtonOnclick(){this.popoverController.dismiss()}itemSelect(e){this.ref.close(e)}fetchData(){this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleType":this.vehicleType,"data.type":this.tableName},sort:["data.vehicleType"]}).then(e=>{e&&"SUCCESS"==e.status?(console.log(e),this.rentplans=e.records):this.messageService.add({key:"rentPlanPopupList",severity:"error",summary:e.message,detail:""})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(m.g),n.Mb(a.b),n.Mb(a.d),n.Mb(o.G),n.Mb(h.d),n.Mb(l.a),n.Mb(s.h))},e.\u0275cmp=n.Gb({type:e,selectors:[["rentPlanPopupList"]],decls:5,vars:1,consts:[[2,"height","400px"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],["key","rentPlanPopupList","position","center"],[3,"click"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-row"),n.Sb(2,"ion-list",1),n.Cc(3,v,14,3,"ion-item",2),n.Rb(),n.Rb(),n.Nb(4,"p-toast",3),n.Rb()),2&e&&(n.Ab(3),n.jc("ngForOf",t.rentplans))},directives:[o.k,o.w,o.s,r.k,b.a,o.q,o.r],styles:[""]}),e})();var p=c("27b0"),S=c("3Pt+");function f(e,t){if(1&e&&(n.Sb(0,"ion-label",9),n.Ec(1),n.Rb()),2&e){const e=n.cc();n.Ab(1),n.Fc(e.selectedRentPlan.rentPlan)}}function y(e,t){if(1&e&&(n.Sb(0,"ion-label",9),n.Ec(1),n.Rb()),2&e){const e=n.cc();n.Ab(1),n.Fc(e.selectedRentPlan.rentAmount)}}let A=(()=>{class e{constructor(e,t,c,i,n,a,o,s,l){this.router=e,this.dbconfig=t,this.messageService=c,this.dbprovider=i,this.popoverController=n,this.dialogService=a,this.translate=o,this.config=s,this.ref=l,this.tableName="account",this.savedSuccessMessage="Data saved successfully",this.selectedVehicle=JSON.parse(JSON.stringify(s.data.vehicle));var r=6e4*(new Date).getTimezoneOffset(),b=new Date(Date.now()-r).toISOString().slice(0,-5);this.openDate=b,this.initializeObjects(this.dbconfig.configuration.tableStructure)}initializeObjects(e){this.accountObj=JSON.parse(JSON.stringify(e[this.tableName]))}openRentPlanList(){return Object(i.a)(this,void 0,void 0,function*(){this.dialogService.open(g,{header:this.translate.instant("rentPlanList.title"),width:"50%",data:{vehicleType:this.selectedVehicle.vehicleType}}).onClose.subscribe(e=>{e&&(this.selectedRentPlan=e)})})}saveAction(){this.selectedRentPlan?(this.accountObj.openDate=new Date(this.openDate).getTime(),this.accountObj.rentPlan_lookup=this.selectedRentPlan.id,this.accountObj.vehicle=this.selectedVehicle.id,console.log(this.accountObj),this.dbprovider.save(this.tableName,this.accountObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"accCreation",severity:"success",summary:this.savedSuccessMessage,detail:""}),setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"accCreation",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"accCreation",severity:"error",summary:e,detail:""})})):this.messageService.add({key:"accCreation",severity:"error",summary:"Choose rent plan",detail:"",closable:!0})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(m.g),n.Mb(p.a),n.Mb(s.h),n.Mb(l.a),n.Mb(o.G),n.Mb(a.a),n.Mb(h.d),n.Mb(a.b),n.Mb(a.d))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountCreation"]],decls:26,vars:16,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],["lines","full"],["type","datetime-local",2,"background-color","lightgray",3,"ngModel","ngModelChange"],["style","float: right;text-align: right;",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],["type","submit","color","danger","expand","block",3,"click"],["key","accCreation","position","center"],[2,"float","right","text-align","right"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-title",1),n.Ec(2),n.Rb(),n.Sb(3,"ion-item",2),n.Sb(4,"ion-label"),n.Ec(5),n.dc(6,"translate"),n.Rb(),n.Sb(7,"input",3),n.ac("ngModelChange",function(e){return t.openDate=e}),n.Rb(),n.Rb(),n.Sb(8,"ion-item",2),n.Sb(9,"ion-label"),n.Ec(10),n.dc(11,"translate"),n.Rb(),n.Cc(12,f,2,1,"ion-label",4),n.Sb(13,"ion-button",5),n.ac("click",function(){return t.openRentPlanList()}),n.Nb(14,"ion-icon",6),n.Rb(),n.Rb(),n.Sb(15,"ion-item",2),n.Sb(16,"ion-label"),n.Ec(17),n.dc(18,"translate"),n.Rb(),n.Cc(19,y,2,1,"ion-label",4),n.Rb(),n.Sb(20,"ion-row"),n.Sb(21,"ion-col"),n.Sb(22,"ion-button",7),n.ac("click",function(){return t.saveAction()}),n.Ec(23),n.dc(24,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Nb(25,"p-toast",8),n.Rb()),2&e&&(n.Ab(2),n.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),n.Ab(3),n.Fc(n.ec(6,8,"accountCreation.openDate")),n.Ab(2),n.jc("ngModel",t.openDate),n.Ab(3),n.Fc(n.ec(11,10,"accountCreation.selectRentPlan")),n.Ab(2),n.jc("ngIf",t.selectedRentPlan),n.Ab(5),n.Fc(n.ec(18,12,"rentPlanEntry.rentAmount")),n.Ab(2),n.jc("ngIf",t.selectedRentPlan),n.Ab(4),n.Fc(n.ec(24,14,"save")))},directives:[o.k,o.z,o.q,o.r,S.a,S.i,S.l,r.l,o.d,o.o,o.w,o.j,b.a],pipes:[h.c],styles:[""]}),e})();var C=c("Nf9I"),R=c("jIHw");function N(e,t){if(1&e&&(n.Sb(0,"ion-title",8),n.Ec(1),n.Rb()),2&e){const e=n.cc();n.Ab(1),n.Gc(" ",e.selectedVehicle.vehicleBrand+" "+e.selectedVehicle.vehicleModel+" "+e.selectedVehicle.vehicleNumber," ")}}function M(e,t){if(1&e&&(n.Sb(0,"div"),n.Sb(1,"ion-item",9),n.Sb(2,"ion-label"),n.Ec(3),n.dc(4,"translate"),n.Rb(),n.Sb(5,"h5"),n.Ec(6),n.Rb(),n.Rb(),n.Sb(7,"ion-item",9),n.Sb(8,"ion-label"),n.Ec(9),n.dc(10,"translate"),n.Rb(),n.Sb(11,"h5"),n.Ec(12),n.dc(13,"translate"),n.Rb(),n.Rb(),n.Sb(14,"ion-item",9),n.Sb(15,"ion-label"),n.Ec(16),n.dc(17,"translate"),n.Rb(),n.Sb(18,"h5"),n.Ec(19),n.dc(20,"translate"),n.Rb(),n.Rb(),n.Sb(21,"ion-item",9),n.Sb(22,"ion-label"),n.Ec(23),n.dc(24,"translate"),n.Rb(),n.Sb(25,"h5"),n.Ec(26),n.dc(27,"translate"),n.Rb(),n.Rb(),n.Sb(28,"ion-item",9),n.Sb(29,"ion-label"),n.Ec(30),n.dc(31,"translate"),n.Rb(),n.Sb(32,"h5"),n.Ec(33),n.dc(34,"date"),n.Rb(),n.Rb(),n.Sb(35,"ion-item",9),n.Sb(36,"ion-label"),n.Ec(37),n.dc(38,"translate"),n.Rb(),n.Sb(39,"h5"),n.Ec(40),n.dc(41,"date"),n.Rb(),n.Rb(),n.Sb(42,"ion-item",9),n.Sb(43,"ion-label"),n.Ec(44),n.dc(45,"translate"),n.Rb(),n.Sb(46,"h5"),n.Ec(47,"Security 1"),n.Rb(),n.Rb(),n.Rb()),2&e){const e=n.cc();n.Ab(3),n.Fc(n.ec(4,16,"accountDetail.rentPlan")),n.Ab(3),n.Fc(e.selectedAccount.rentPlan_lookup.rentPlan),n.Ab(3),n.Fc(n.ec(10,18,"accountDetail.totalAmount")),n.Ab(3),n.Hc("",e.selectedAccount.totalBillAmount," ",n.ec(13,20,"rs"),""),n.Ab(4),n.Fc(n.ec(17,22,"accountDetail.amountReceived")),n.Ab(3),n.Hc("",e.selectedAccount.receivedAmount," ",n.ec(20,24,"rs"),""),n.Ab(4),n.Fc(n.ec(24,26,"accountDetail.pendingAmount")),n.Ab(3),n.Hc("",e.selectedAccount.totalBillAmount-e.selectedAccount.receivedAmount," ",n.ec(27,28,"rs"),""),n.Ab(4),n.Fc(n.ec(31,30,"accountDetail.accOpenDate")),n.Ab(3),n.Fc(n.fc(34,32,e.selectedAccount.openDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Fc(n.ec(38,35,"accountDetail.accCloseDate")),n.Ab(3),n.Fc(n.fc(41,37,e.selectedAccount.closeDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Fc(n.ec(45,40,"accountDetail.accAddBy"))}}function E(e,t){1&e&&(n.Sb(0,"div"),n.Nb(1,"br"),n.Nb(2,"div"),n.Sb(3,"div",5),n.Sb(4,"ion-label"),n.Ec(5,"Active account not available. Create new account."),n.Rb(),n.Rb(),n.Rb())}function j(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",10),n.Sb(1,"button",11),n.ac("click",function(){return n.wc(e),n.cc().createAccount()}),n.Rb(),n.Rb()}}function O(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",12),n.Sb(1,"button",13),n.ac("click",function(){return n.wc(e),n.cc().closeAccount()}),n.Rb(),n.Sb(2,"button",14),n.ac("click",function(){return n.wc(e),n.cc().accountHistory()}),n.dc(3,"translate"),n.Rb(),n.Rb()}2&e&&(n.Ab(2),n.kc("label",n.ec(3,1,"history")))}function k(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",12),n.Sb(1,"button",15),n.ac("click",function(){return n.wc(e),n.cc().createAccount()}),n.Rb(),n.Sb(2,"button",14),n.ac("click",function(){return n.wc(e),n.cc().accountHistory()}),n.dc(3,"translate"),n.Rb(),n.Rb()}2&e&&(n.Ab(2),n.kc("label",n.ec(3,1,"history")))}let V=(()=>{class e{constructor(e,t,c,i,n,a,o,s){this.confirmationService=e,this.router=t,this.popoverController=c,this.translate=i,this.dialogService=n,this.messageService=a,this.dbprovider=o,this.config=s,this.tableName="account",this.vehicleTableName="vehicle",this.savedSuccessMessage="Account closed successfully",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(s.data.vehicle)),this.fetchAccounts()}accountHistory(){return Object(i.a)(this,void 0,void 0,function*(){console.log("history"),this.dialogService.open(u,{header:this.translate.instant("accountHistory.title"),width:"50%",data:{vehicle:this.selectedVehicle}})})}createAccount(){console.log("account creation"),this.dialogService.open(A,{header:this.translate.instant("accountCreation.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAccounts()})}closeAccount(){console.log("close call"),this.confirmationService.confirm({message:"Are you sure that you want to close this account?",accept:()=>{this.selectedAccount.closeDate=(new Date).getTime(),this.dbprovider.save(this.tableName,this.selectedAccount).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"accountDetail",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.fetchAccounts()):this.messageService.add({key:"accountDetail",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e)})}})}fetchAccounts(){this.selectedAccount=null,this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(e=>{console.log(e),e&&"SUCCESS"==e.status?(e.records.length>0&&e.records.forEach(e=>{e.closeDate||(this.selectedAccount=e)}),this.accountList=e.records):this.messageService.add({key:"accountDetail",severity:"error",summary:e.message,detail:""})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(s.b),n.Mb(m.g),n.Mb(o.G),n.Mb(h.d),n.Mb(a.a),n.Mb(s.h),n.Mb(l.a),n.Mb(a.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountDetail"]],decls:10,vars:6,consts:[[2,"height","400px"],["size","large","class","ion-text-center",4,"ngIf"],[4,"ngIf"],["key","accountDetail","position","center"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[2,"text-align","center"],["class","p-buttonset","style","text-align: center;",4,"ngIf"],["class","p-buttonset",4,"ngIf"],["size","large",1,"ion-text-center"],["lines","full"],[1,"p-buttonset",2,"text-align","center"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",3,"click"],[1,"p-buttonset"],["pButton","","type","button","label","Close account","icon","pi pi-times-circle",2,"float","left",3,"click"],["pButton","","type","button","icon","pi pi-clock",2,"float","right",3,"label","click"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",2,"float","left",3,"click"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Cc(1,N,2,1,"ion-title",1),n.Cc(2,M,48,42,"div",2),n.Cc(3,E,6,0,"div",2),n.Nb(4,"p-toast",3),n.Nb(5,"p-confirmDialog",4),n.Rb(),n.Sb(6,"ion-footer",5),n.Cc(7,j,2,0,"span",6),n.Cc(8,O,4,3,"span",7),n.Cc(9,k,4,3,"span",7),n.Rb()),2&e&&(n.Ab(1),n.jc("ngIf",t.selectedVehicle),n.Ab(1),n.jc("ngIf",t.selectedAccount),n.Ab(1),n.jc("ngIf",!t.selectedAccount),n.Ab(4),n.jc("ngIf",!t.selectedAccount&&0==t.accountList.length),n.Ab(1),n.jc("ngIf",t.selectedAccount&&t.accountList.length>0),n.Ab(1),n.jc("ngIf",!t.selectedAccount&&t.accountList.length>0))},directives:[o.k,r.l,b.a,C.a,o.l,o.z,o.q,o.r,R.b],pipes:[h.c,r.e],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),e})()},VqLa:function(e,t,c){"use strict";c.d(t,"a",function(){return y});var i=c("mrSG"),n=c("xHpX"),a=c("fXoL"),o=c("tyNb"),s=c("sYmb"),l=c("7zfz"),r=c("tp0D"),b=c("J7/z"),h=c("TEn/"),d=c("ofXK"),u=c("Gxio"),m=c("jIHw");function v(e,t){if(1&e&&(a.Sb(0,"h2"),a.Ec(1),a.Rb()),2&e){const e=a.cc().$implicit;a.Ab(1),a.Fc(e.contactName)}}function g(e,t){if(1&e&&(a.Sb(0,"h2"),a.Ec(1),a.Rb()),2&e){const e=a.cc().$implicit;a.Ab(1),a.Fc(e.contactNameInTamil)}}function p(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-item",7),a.ac("click",function(c){a.wc(e);const i=t.$implicit;return a.cc().editContact(i),c.stopPropagation()}),a.Sb(1,"ion-avatar",8),a.Nb(2,"ion-icon",9),a.Rb(),a.Sb(3,"ion-label"),a.Cc(4,v,2,1,"h2",4),a.Cc(5,g,2,1,"h2",4),a.Sb(6,"h3"),a.Ec(7),a.Rb(),a.Sb(8,"p"),a.Ec(9),a.Rb(),a.Sb(10,"p"),a.Ec(11),a.Rb(),a.Rb(),a.Rb()}if(2&e){const e=t.$implicit,c=a.cc();a.Ab(4),a.jc("ngIf",c.appLanguage&&"en"==c.appLanguage),a.Ab(1),a.jc("ngIf",c.appLanguage&&"ta"==c.appLanguage),a.Ab(2),a.Fc(e.contactMobile),a.Ab(2),a.Gc("DL : ",e.licenseNumber,""),a.Ab(2),a.Gc("Added By : ",e.securityName,"")}}function S(e,t){if(1&e){const e=a.Tb();a.Sb(0,"div"),a.Nb(1,"br"),a.Nb(2,"div"),a.Sb(3,"div",10),a.Sb(4,"ion-label"),a.Ec(5,"Alternate contact not available."),a.Rb(),a.Nb(6,"br"),a.Nb(7,"br"),a.Sb(8,"button",11),a.ac("click",function(){return a.wc(e),a.cc().createAlternateContact()}),a.Rb(),a.Rb(),a.Rb()}}function f(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-footer",10),a.Sb(1,"span",12),a.Sb(2,"button",11),a.ac("click",function(){return a.wc(e),a.cc().createAlternateContact()}),a.Rb(),a.Rb(),a.Rb()}}let y=(()=>{class e{constructor(e,t,c,i,n,a){this.router=e,this.translate=t,this.messageService=c,this.dbprovider=i,this.config=n,this.dialogService=a,this.contactList=[],this.appLanguage="ta",this.contactTableName="contact",this.vehicleContactAssignmentTableName="vehicleContactAssignment",this.appLanguage=this.translate.getDefaultLang(),this.selectedVehicle=JSON.parse(JSON.stringify(n.data.vehicle)),this.fetchAlternateContactList()}itemSelect(e){}fetchAlternateContactList(){this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicle_lookup":this.selectedVehicle.id,"data.type":this.vehicleContactAssignmentTableName},sort:["data.vehicle_lookup"]}).then(e=>{if(console.log(e),"SUCCESS"==e.status&&e.records.length>0){const t=e.records.map(e=>e.contact_lookup).map(e=>this.contactTableName+"_2_"+e);this.fetchContactListAgainstVehicle(t)}else this.messageService.add({key:"alternateContactList",severity:"error",summary:e.message,detail:""})})}fetchContactListAgainstVehicle(e){console.log(e),this.contactList=[],this.dbprovider.fetchDocsWithDocIds(e).then(e=>{console.log(e),"SUCCESS"==e.status&&e.response.length>0?e.response.forEach(e=>{console.log(e),"others"==e.contactType&&this.contactList.push(e)}):this.contactList=[]}).catch(e=>{this.contactList=[]})}createAlternateContact(){return Object(i.a)(this,void 0,void 0,function*(){console.log("add contact"),this.dialogService.open(n.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:"",mode:"new",contactType:"Others",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAlternateContactList()})})}editContact(e){console.log(e),delete JSON.parse(JSON.stringify(e)).selected,this.dialogService.open(n.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:e,mode:"edit",contactType:"Primary",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAlternateContactList()})}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(s.d),a.Mb(l.h),a.Mb(r.a),a.Mb(b.b),a.Mb(b.a))},e.\u0275cmp=a.Gb({type:e,selectors:[["contactListAgainstCar"]],decls:9,vars:4,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["key","alternateContactList","position","center"],["style","text-align: center;",4,"ngIf"],[3,"click"],["slot","start"],["name","person-circle-outline",2,"font-size","50px"],[2,"text-align","center"],["pButton","","type","button","label","Create alternate contact","icon","pi pi-plus",3,"click"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"ion-title",1),a.Ec(2),a.Rb(),a.Sb(3,"ion-row"),a.Sb(4,"ion-list",2),a.Cc(5,p,12,5,"ion-item",3),a.Rb(),a.Rb(),a.Cc(6,S,9,0,"div",4),a.Nb(7,"p-toast",5),a.Rb(),a.Cc(8,f,3,0,"ion-footer",6)),2&e&&(a.Ab(2),a.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),a.Ab(3),a.jc("ngForOf",t.contactList),a.Ab(1),a.jc("ngIf",0==t.contactList.length),a.Ab(2),a.jc("ngIf",t.contactList.length>0))},directives:[h.k,h.z,h.w,h.s,d.k,d.l,u.a,h.q,h.c,h.o,h.r,m.b,h.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),e})()},XqSU:function(e,t,c){"use strict";c.d(t,"a",function(){return y});var i=c("mrSG"),n=c("3Pt+"),a=c("fXoL"),o=c("tyNb"),s=c("27b0"),l=c("tp0D"),r=c("7zfz"),b=c("J7/z"),h=c("TEn/"),d=c("Gxio"),u=c("sYmb");let m=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.alternateVehicleObj={},this.vehicleObj={},this.contactId="",this.vehicleId="",this.tableName="alternateVehicle",this.savedSuccessMessage="Data saved successfully",this.vehicleObj=JSON.parse(JSON.stringify(o.data.vehicle)),"edit"==o.data.mode?this.alternateVehicleObj=JSON.parse(JSON.stringify(o.data.object)):this.initializeObjects(this.dbconfig.configuration.tableStructure),this.createFormGroup(),this.contactId=this.config.data.contactId}initializeObjects(e){this.alternateVehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.alternateVehicleObj.vehicleType="bike"}createFormGroup(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",n.o.compose([n.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",n.o.compose([n.o.required])]})})}saveAction(){console.log(this.alternateVehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.alternateVehicleObj.vehicleType,vehicleBrand:this.alternateVehicleObj.vehicleBrand,vehicleModel:this.alternateVehicleObj.vehicleModel,vehicleColor:this.alternateVehicleObj.vehicleColor,vehicleNumber:this.alternateVehicleObj.vehicleNumber.toUpperCase()}}),this.alternateVehicleObj.vehicle=this.vehicleObj.id,this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.alternateVehicleObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"alternateVehicleEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.vehicleId=e.id,setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.alternateVehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.alternateVehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(s.a),a.Mb(n.b),a.Mb(l.a),a.Mb(r.h),a.Mb(b.d),a.Mb(b.b))},e.\u0275cmp=a.Gb({type:e,selectors:[["alternateVehicleEntry"]],decls:50,vars:36,consts:[[2,"height","400px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","vehicle"],["value","bike","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["value","bike"],["value","car"],["value","auto"],["value","others"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","alternateVehicleEntry","position","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"form",1),a.Sb(2,"ion-item",2),a.Sb(3,"ion-radio-group",3),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleType=e}),a.Sb(4,"ion-label"),a.Ec(5),a.dc(6,"translate"),a.Rb(),a.Sb(7,"ion-item"),a.Nb(8,"ion-radio",4),a.Sb(9,"ion-label"),a.Ec(10),a.dc(11,"translate"),a.Rb(),a.Nb(12,"ion-radio",5),a.Sb(13,"ion-label"),a.Ec(14),a.dc(15,"translate"),a.Rb(),a.Nb(16,"ion-radio",6),a.Sb(17,"ion-label"),a.Ec(18),a.dc(19,"translate"),a.Rb(),a.Nb(20,"ion-radio",7),a.Sb(21,"ion-label"),a.Ec(22),a.dc(23,"translate"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Sb(24,"ion-item",2),a.Sb(25,"ion-label",8),a.Ec(26),a.dc(27,"translate"),a.Rb(),a.Sb(28,"ion-input",9),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleBrand=e}),a.Rb(),a.Rb(),a.Sb(29,"ion-item",2),a.Sb(30,"ion-label",8),a.Ec(31),a.dc(32,"translate"),a.Rb(),a.Sb(33,"ion-input",10),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleModel=e}),a.Rb(),a.Rb(),a.Sb(34,"ion-item",2),a.Sb(35,"ion-label",8),a.Ec(36),a.dc(37,"translate"),a.Rb(),a.Sb(38,"ion-input",11),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleColor=e}),a.Rb(),a.Rb(),a.Sb(39,"ion-item",2),a.Sb(40,"ion-label",8),a.Ec(41),a.dc(42,"translate"),a.Rb(),a.Sb(43,"ion-input",12),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleNumber=e}),a.Rb(),a.Rb(),a.Sb(44,"ion-row"),a.Sb(45,"ion-col"),a.Sb(46,"ion-button",13),a.ac("click",function(){return t.saveAction()}),a.Ec(47),a.dc(48,"translate"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Nb(49,"p-toast",14),a.Rb()),2&e&&(a.Ab(1),a.jc("formGroup",t.formGroup),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleType),a.Ab(2),a.Fc(a.ec(6,16,"vehicleEntry.vehicleType")),a.Ab(5),a.Fc(a.ec(11,18,"vehicleEntry.bike")),a.Ab(4),a.Fc(a.ec(15,20,"vehicleEntry.car")),a.Ab(4),a.Fc(a.ec(19,22,"vehicleEntry.auto")),a.Ab(4),a.Fc(a.ec(23,24,"vehicleEntry.others")),a.Ab(4),a.Gc("",a.ec(27,26,"vehicleEntry.vehicleBrand")," "),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleBrand),a.Ab(3),a.Fc(a.ec(32,28,"vehicleEntry.vehicleModel")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleModel),a.Ab(3),a.Fc(a.ec(37,30,"vehicleEntry.vehicleColor")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleColor),a.Ab(3),a.Fc(a.ec(42,32,"vehicleEntry.vehicleNumber")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleNumber),a.Ab(4),a.Fc(a.ec(48,34,"save")))},directives:[h.k,n.p,n.j,n.d,h.q,n.e,h.u,h.I,n.i,n.c,h.r,h.t,h.H,h.p,h.J,n.n,h.w,h.j,h.d,d.a],pipes:[u.c],styles:[""]}),e})();var v=c("ofXK"),g=c("jIHw");function p(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-item",7),a.ac("click",function(c){a.wc(e);const i=t.$implicit;return a.cc().itemSelect(i),c.stopPropagation()}),a.Sb(1,"ion-avatar",8),a.Nb(2,"ion-icon",9),a.Rb(),a.Sb(3,"ion-label"),a.Sb(4,"h3"),a.Ec(5),a.Rb(),a.Sb(6,"h2"),a.Ec(7),a.Rb(),a.Sb(8,"h2"),a.Sb(9,"b"),a.Ec(10),a.Rb(),a.Rb(),a.Sb(11,"h2"),a.Ec(12),a.Rb(),a.Sb(13,"p"),a.Ec(14),a.Rb(),a.Rb(),a.Rb()}if(2&e){const e=t.$implicit;a.Ab(5),a.Fc(e.vehicleType),a.Ab(2),a.Hc("",e.vehicleBrand," ",e.vehicleModel," "),a.Ab(3),a.Fc(e.vehicleNumber),a.Ab(2),a.Fc(e.vehicleColor),a.Ab(2),a.Gc("Added By : ",e.addedBy,"")}}function S(e,t){if(1&e){const e=a.Tb();a.Sb(0,"div"),a.Nb(1,"br"),a.Nb(2,"div"),a.Sb(3,"div",10),a.Sb(4,"ion-label"),a.Ec(5,"Alternate vehicle not available."),a.Rb(),a.Nb(6,"br"),a.Nb(7,"br"),a.Sb(8,"button",11),a.ac("click",function(){return a.wc(e),a.cc().createAlternateVehicle()}),a.Rb(),a.Rb(),a.Rb()}}function f(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-footer",10),a.Sb(1,"span",12),a.Sb(2,"button",11),a.ac("click",function(){return a.wc(e),a.cc().createAlternateVehicle()}),a.Rb(),a.Rb(),a.Rb()}}let y=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.popoverController=t,this.translate=c,this.messageService=i,this.dbprovider=n,this.config=a,this.dialogService=o,this.vehicleList=[],this.tableName="alternateVehicle",this.vehicleTableName="vehicle",this.selectedVehicle=JSON.parse(JSON.stringify(a.data.vehicle)),this.fetchAlternateVehicles()}createAlternateVehicle(){return Object(i.a)(this,void 0,void 0,function*(){console.log("alternate vehicle detail"),this.dialogService.open(m,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:"",mode:"new"}}).onClose.subscribe(e=>{this.fetchAlternateVehicles()})})}fetchAlternateVehicles(){this.dbprovider.fetchDocsWithoutRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id).then(e=>{console.log(e),e&&"SUCCESS"==e.status?this.vehicleList=e.records:this.messageService.add({key:"alternateVehicleList",severity:"error",summary:e.message,detail:""})})}itemSelect(e){this.dialogService.open(m,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:e,mode:"edit"}}).onClose.subscribe(e=>{this.fetchAlternateVehicles()})}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(h.G),a.Mb(u.d),a.Mb(r.h),a.Mb(l.a),a.Mb(b.b),a.Mb(b.a))},e.\u0275cmp=a.Gb({type:e,selectors:[["alternateVehicleList"]],decls:9,vars:4,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["key","alternateVehicleList","position","center"],["style","text-align: center;",4,"ngIf"],[3,"click"],["slot","start"],["name","car-sport-outline",2,"font-size","50px"],[2,"text-align","center"],["pButton","","type","button","label","Create alternate vehicle","icon","pi pi-plus",3,"click"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"ion-title",1),a.Ec(2),a.Rb(),a.Sb(3,"ion-row"),a.Sb(4,"ion-list",2),a.Cc(5,p,15,6,"ion-item",3),a.Rb(),a.Rb(),a.Cc(6,S,9,0,"div",4),a.Nb(7,"p-toast",5),a.Rb(),a.Cc(8,f,3,0,"ion-footer",6)),2&e&&(a.Ab(2),a.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),a.Ab(3),a.jc("ngForOf",t.vehicleList),a.Ab(1),a.jc("ngIf",0==t.vehicleList.length),a.Ab(2),a.jc("ngIf",t.vehicleList.length>0))},directives:[h.k,h.z,h.w,h.s,v.k,v.l,d.a,h.q,h.c,h.o,h.r,g.b,h.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),e})()},eKwt:function(e,t,c){"use strict";c.d(t,"a",function(){return u});var i=c("3Pt+"),n=c("fXoL"),a=c("tyNb"),o=c("27b0"),s=c("tp0D"),l=c("7zfz"),r=c("J7/z"),b=c("TEn/"),h=c("Gxio"),d=c("sYmb");let u=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.vehicleObj={},this.vehicleandContactAssgObj={},this.contactId="",this.vehicleId="",this.tableName="vehicle",this.assignmenttableName="vehicleContactAssignment",this.savedSuccessMessage="Data saved successfully","edit"==o.data.mode?this.vehicleObj=JSON.parse(JSON.stringify(o.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup(),this.contactId=this.config.data.contactId}initializeObjects(e){this.vehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.vehicleObj.vehicleType="car"}initializeAssignmentObjects(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}createFormGroup(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",i.o.compose([i.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",i.o.compose([i.o.required])]})})}saveAction(){console.log(this.vehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.vehicleObj.vehicleType,vehicleBrand:this.vehicleObj.vehicleBrand,vehicleModel:this.vehicleObj.vehicleModel,vehicleColor:this.vehicleObj.vehicleColor,vehicleNumber:this.vehicleObj.vehicleNumber.toUpperCase()}}),this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.vehicleObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"vehicleEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.vehicleId=e.id,"edit"!=this.config.data.mode?this.saveContactAndVehicleAssignment():setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"vehicleEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"vehicleEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.vehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.vehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}saveContactAndVehicleAssignment(){this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(e=>{console.log(e),"SUCCESS"!=e.status?console.log("Vehicle assignment save failed",e):console.log("Vehicle assignment save Success"),setTimeout(()=>this.ref.close("SUCCESS"),1e3)})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.a),n.Mb(i.b),n.Mb(s.a),n.Mb(l.h),n.Mb(r.d),n.Mb(r.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["vehicleEntry"]],decls:46,vars:33,consts:[[2,"height","450px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","vehicle"],["value","car","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["value","car"],["value","auto"],["value","others"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","vehicleEntry","position","center"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"form",1),n.Sb(2,"ion-item",2),n.Sb(3,"ion-radio-group",3),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleType=e}),n.Sb(4,"ion-label"),n.Ec(5),n.dc(6,"translate"),n.Rb(),n.Sb(7,"ion-item"),n.Nb(8,"ion-radio",4),n.Sb(9,"ion-label"),n.Ec(10),n.dc(11,"translate"),n.Rb(),n.Nb(12,"ion-radio",5),n.Sb(13,"ion-label"),n.Ec(14),n.dc(15,"translate"),n.Rb(),n.Nb(16,"ion-radio",6),n.Sb(17,"ion-label"),n.Ec(18),n.dc(19,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(20,"ion-item",2),n.Sb(21,"ion-label",7),n.Ec(22),n.dc(23,"translate"),n.Rb(),n.Sb(24,"ion-input",8),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleBrand=e}),n.Rb(),n.Rb(),n.Sb(25,"ion-item",2),n.Sb(26,"ion-label",7),n.Ec(27),n.dc(28,"translate"),n.Rb(),n.Sb(29,"ion-input",9),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleModel=e}),n.Rb(),n.Rb(),n.Sb(30,"ion-item",2),n.Sb(31,"ion-label",7),n.Ec(32),n.dc(33,"translate"),n.Rb(),n.Sb(34,"ion-input",10),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleColor=e}),n.Rb(),n.Rb(),n.Sb(35,"ion-item",2),n.Sb(36,"ion-label",7),n.Ec(37),n.dc(38,"translate"),n.Rb(),n.Sb(39,"ion-input",11),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleNumber=e}),n.Rb(),n.Rb(),n.Sb(40,"ion-row"),n.Sb(41,"ion-col"),n.Sb(42,"ion-button",12),n.ac("click",function(){return t.saveAction()}),n.Ec(43),n.dc(44,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(45,"p-toast",13),n.Rb()),2&e&&(n.Ab(1),n.jc("formGroup",t.formGroup),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleType),n.Ab(2),n.Fc(n.ec(6,15,"vehicleEntry.vehicleType")),n.Ab(5),n.Fc(n.ec(11,17,"vehicleEntry.car")),n.Ab(4),n.Fc(n.ec(15,19,"vehicleEntry.auto")),n.Ab(4),n.Fc(n.ec(19,21,"vehicleEntry.others")),n.Ab(4),n.Gc("",n.ec(23,23,"vehicleEntry.vehicleBrand")," "),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleBrand),n.Ab(3),n.Fc(n.ec(28,25,"vehicleEntry.vehicleModel")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleModel),n.Ab(3),n.Fc(n.ec(33,27,"vehicleEntry.vehicleColor")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleColor),n.Ab(3),n.Fc(n.ec(38,29,"vehicleEntry.vehicleNumber")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleNumber),n.Ab(4),n.Fc(n.ec(44,31,"save")))},directives:[b.k,i.p,i.j,i.d,b.q,i.e,b.u,b.I,i.i,i.c,b.r,b.t,b.H,b.p,b.J,i.n,b.w,b.j,b.d,h.a],pipes:[d.c],styles:[""]}),e})()},xHpX:function(e,t,c){"use strict";c.d(t,"a",function(){return u});var i=c("3Pt+"),n=c("fXoL"),a=c("tyNb"),o=c("27b0"),s=c("tp0D"),l=c("7zfz"),r=c("J7/z"),b=c("TEn/"),h=c("Gxio"),d=c("sYmb");let u=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.contactObj={},this.tableName="contact",this.savedSuccessMessage="Data saved successfully",this.contactType="",this.vehicleandContactAssgObj={},this.assignmenttableName="vehicleContactAssignment",this.contactType=this.config.data.contactType,this.vehicleId=this.config.data.vehicleId,"edit"==o.data.mode?this.contactObj=JSON.parse(JSON.stringify(o.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup()}initializeAssignmentObjects(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}initializeObjects(e){this.contactObj=JSON.parse(JSON.stringify(e[this.tableName])),this.contactObj.contactType="Primary"==this.contactType?"owner":"others"}createFormGroup(){this.formGroup=this.formBuilder.group({contact:this.formBuilder.group({contactName:["",i.o.compose([i.o.maxLength(80),i.o.required])],contactNameInTamil:[""],contactMobile:["",[i.o.required,i.o.pattern("^((\\+91-?)|0)?[0-9]{10}$")]],licenseNumber:[""]})})}saveAction(){console.log(this.contactObj),this.formGroup.patchValue({contact:{contactName:this.contactObj.contactName,contactNameInTamil:this.contactObj.contactNameInTamil,contactMobile:this.contactObj.contactMobile,licenseNumber:this.contactObj.licenseNumber}}),this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"contactEntry",severity:"error",summary:"Mobile number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.contactObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"contactEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.contactId=e.id,"edit"!=this.config.data.mode&&"others"==this.contactObj.contactType?this.saveContactAndVehicleAssignment():setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"contactEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"contactEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"contactEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.contactObj.contactMobile==this.config.data.object.contactMobile?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.contactMobile":this.contactObj.contactMobile,"data.type":this.tableName},sort:["data.contactMobile"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}saveContactAndVehicleAssignment(){this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(e=>{console.log(e),"SUCCESS"!=e.status?console.log("Vehicle assignment save failed",e):console.log("Vehicle assignment save Success"),setTimeout(()=>this.ref.close("SUCCESS"),1e3)})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.a),n.Mb(i.b),n.Mb(s.a),n.Mb(l.h),n.Mb(r.d),n.Mb(r.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["contactEntry"]],decls:28,vars:20,consts:[[2,"height","400px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","contact"],["position","floating"],["type","text","formControlName","contactName","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","contactNameInTamil",3,"ngModel","ngModelChange"],["type","number","formControlName","contactMobile","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","licenseNumber",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","contactEntry","position","center"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"form",1),n.Sb(2,"ion-item",2),n.Sb(3,"ion-label",3),n.Ec(4),n.dc(5,"translate"),n.Rb(),n.Sb(6,"ion-input",4),n.ac("ngModelChange",function(e){return t.contactObj.contactName=e}),n.Rb(),n.Rb(),n.Sb(7,"ion-item",2),n.Sb(8,"ion-label",3),n.Ec(9),n.dc(10,"translate"),n.Rb(),n.Sb(11,"ion-input",5),n.ac("ngModelChange",function(e){return t.contactObj.contactNameInTamil=e}),n.Rb(),n.Rb(),n.Sb(12,"ion-item",2),n.Sb(13,"ion-label",3),n.Ec(14),n.dc(15,"translate"),n.Rb(),n.Sb(16,"ion-input",6),n.ac("ngModelChange",function(e){return t.contactObj.contactMobile=e}),n.Rb(),n.Rb(),n.Sb(17,"ion-item",2),n.Sb(18,"ion-label",3),n.Ec(19),n.dc(20,"translate"),n.Rb(),n.Sb(21,"ion-input",7),n.ac("ngModelChange",function(e){return t.contactObj.licenseNumber=e}),n.Rb(),n.Rb(),n.Sb(22,"ion-row"),n.Sb(23,"ion-col"),n.Sb(24,"ion-button",8),n.ac("click",function(){return t.saveAction()}),n.Ec(25),n.dc(26,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(27,"p-toast",9),n.Rb()),2&e&&(n.Ab(1),n.jc("formGroup",t.formGroup),n.Ab(3),n.Gc("",n.ec(5,10,"contactEntry.contactName")," "),n.Ab(2),n.jc("ngModel",t.contactObj.contactName),n.Ab(3),n.Fc(n.ec(10,12,"contactEntry.contactNameInTamil")),n.Ab(2),n.jc("ngModel",t.contactObj.contactNameInTamil),n.Ab(3),n.Fc(n.ec(15,14,"contactEntry.contactMobile")),n.Ab(2),n.jc("ngModel",t.contactObj.contactMobile),n.Ab(3),n.Fc(n.ec(20,16,"contactEntry.licenseNumber")),n.Ab(2),n.jc("ngModel",t.contactObj.licenseNumber),n.Ab(4),n.Gc("",n.ec(26,18,"save")," "))},directives:[b.k,i.p,i.j,i.d,b.q,i.e,b.r,b.p,b.J,i.i,i.c,i.n,b.E,b.w,b.j,b.d,h.a],pipes:[d.c],styles:[""]}),e})()}}]);