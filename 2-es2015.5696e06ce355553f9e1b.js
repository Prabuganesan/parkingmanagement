(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0Eai":function(e,t,c){"use strict";c.d(t,"a",function(){return k});var i=c("mrSG"),n=c("fXoL"),a=c("tyNb"),o=c("J7/z"),s=c("TEn/"),l=c("7zfz"),r=c("tp0D"),b=c("ofXK"),h=c("Gxio"),d=c("sYmb");function p(e,t){if(1&e){const e=n.Tb();n.Sb(0,"ion-item",7),n.ac("click",function(){n.wc(e);const c=t.$implicit;return n.cc().openTransactionHistory(c.id)}),n.Sb(1,"ion-label"),n.Sb(2,"h3"),n.Sb(3,"span",8),n.Ec(4),n.dc(5,"translate"),n.Rb(),n.Sb(6,"span",9),n.Sb(7,"strong"),n.Ec(8),n.dc(9,"date"),n.Rb(),n.Rb(),n.Rb(),n.Sb(10,"h3"),n.Sb(11,"span",8),n.Ec(12),n.dc(13,"translate"),n.Rb(),n.Sb(14,"span",9),n.Sb(15,"strong"),n.Ec(16),n.dc(17,"date"),n.Rb(),n.Rb(),n.Rb(),n.Sb(18,"h3"),n.Sb(19,"span",8),n.Ec(20),n.dc(21,"translate"),n.Rb(),n.Sb(22,"span",9),n.Sb(23,"strong"),n.Ec(24),n.dc(25,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Sb(26,"h3"),n.Sb(27,"span",8),n.Ec(28),n.dc(29,"translate"),n.Rb(),n.Sb(30,"span",9),n.Sb(31,"strong"),n.Ec(32),n.dc(33,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Sb(34,"h3"),n.Sb(35,"span",8),n.Ec(36),n.dc(37,"translate"),n.Rb(),n.Sb(38,"span",9),n.Sb(39,"strong"),n.Ec(40),n.dc(41,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Sb(42,"h3"),n.Sb(43,"span",8),n.Ec(44),n.dc(45,"translate"),n.Rb(),n.Sb(46,"span",9),n.Sb(47,"strong"),n.Ec(48),n.Rb(),n.Rb(),n.Rb(),n.Sb(49,"h3"),n.Sb(50,"span",8),n.Ec(51),n.dc(52,"translate"),n.Rb(),n.Sb(53,"span",9),n.Sb(54,"strong"),n.Ec(55),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=t.$implicit;n.Ab(4),n.Gc("",n.ec(5,17,"accountDetail.accOpenDate")," : "),n.Ab(4),n.Fc(n.fc(9,19,e.openDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Gc("",n.ec(13,22,"accountDetail.accCloseDate")," : "),n.Ab(4),n.Fc(n.fc(17,24,e.closeDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Gc("",n.ec(21,27,"accountDetail.totalAmount")," : "),n.Ab(4),n.Hc("",e.totalBillAmount," ",n.ec(25,29,"rs"),""),n.Ab(4),n.Gc("",n.ec(29,31,"accountDetail.amountReceived")," : "),n.Ab(4),n.Hc("",e.receivedAmount," ",n.ec(33,33,"rs"),""),n.Ab(4),n.Gc("",n.ec(37,35,"accountDetail.pendingAmount")," : "),n.Ab(4),n.Hc("",e.pendingAmount," ",n.ec(41,37,"rs"),""),n.Ab(4),n.Gc("",n.ec(45,39,"accountDetail.rentPlan")," : "),n.Ab(4),n.Fc(e.rentPlan_lookup.rentPlan),n.Ab(3),n.Gc("",n.ec(52,41,"accountDetail.accAddBy")," : "),n.Ab(4),n.Fc(e.accountAddedBy)}}let u=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dialogService=t,this.ref=c,this.config=i,this.popoverController=n,this.messageService=a,this.dbprovider=o,this.tableName="account",this.vehicleTableName="vehicle",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(i.data.vehicle)),this.fetchAccounts()}fetchAccounts(){this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(e=>{console.log(e),e&&"SUCCESS"==e.status?this.accountList=e.records:this.messageService.add({key:"accountHistory",severity:"error",summary:e.message,detail:""})})}openTransactionHistory(e){this.ref.close(),this.router.navigate(["transactionHistory"],{queryParams:{vehicle:JSON.stringify({vehicleInfo:this.selectedVehicle,activeAccountId:e})}})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.a),n.Mb(o.d),n.Mb(o.b),n.Mb(s.H),n.Mb(l.h),n.Mb(r.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountHistory"]],decls:10,vars:2,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],["lines","none",3,"click",4,"ngFor","ngForOf"],["key","accountHistory","position","center"],["lines","none",3,"click"],[1,"pm-v-label"],[1,"pm-camelcase"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-title",1),n.Sb(2,"span",2),n.Ec(3,"Vehical Detail : "),n.Rb(),n.Sb(4,"span",3),n.Ec(5),n.Rb(),n.Rb(),n.Sb(6,"ion-row",4),n.Sb(7,"ion-list"),n.Cc(8,p,56,43,"ion-item",5),n.Rb(),n.Rb(),n.Nb(9,"p-toast",6),n.Rb()),2&e&&(n.Ab(5),n.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),n.Ab(3),n.jc("ngForOf",t.accountList))},directives:[s.k,s.z,s.w,s.s,b.k,h.a,s.q,s.r],pipes:[d.c,b.e],styles:[""]}),e})();function m(e,t){if(1&e){const e=n.Tb();n.Sb(0,"ion-item",4),n.ac("click",function(c){n.wc(e);const i=t.$implicit;return n.cc().itemSelect(i),c.stopPropagation()}),n.Sb(1,"ion-label"),n.Sb(2,"h3"),n.Sb(3,"span",5),n.Ec(4,"Account open date : "),n.Rb(),n.Sb(5,"span",6),n.Sb(6,"strong"),n.Ec(7),n.Rb(),n.Rb(),n.Rb(),n.Sb(8,"h3"),n.Sb(9,"span",5),n.Ec(10,"Account close date : "),n.Rb(),n.Sb(11,"span",6),n.Sb(12,"strong"),n.Ec(13),n.Rb(),n.Rb(),n.Rb(),n.Sb(14,"h3"),n.Sb(15,"span",5),n.Ec(16,"Total amount : "),n.Rb(),n.Sb(17,"span",6),n.Sb(18,"strong"),n.Ec(19),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=t.$implicit;n.Ab(7),n.Fc(e.rentPlan),n.Ab(6),n.Fc(e.rentAmount),n.Ab(6),n.Fc(e.vehicleType)}}let v=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.config=t,this.ref=c,this.popoverController=i,this.translate=n,this.dbprovider=a,this.messageService=o,this.rentplans=[],this.tableName="rentPlan",this.vehicleType=JSON.parse(JSON.stringify(t.data.vehicleType)),this.fetchData()}backButtonOnclick(){this.popoverController.dismiss()}itemSelect(e){this.ref.close(e)}fetchData(){this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleType":this.vehicleType,"data.type":this.tableName},sort:["data.vehicleType"]}).then(e=>{e&&"SUCCESS"==e.status?(console.log(e),this.rentplans=e.records):this.messageService.add({key:"rentPlanPopupList",severity:"error",summary:e.message,detail:""})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.b),n.Mb(o.d),n.Mb(s.H),n.Mb(d.d),n.Mb(r.a),n.Mb(l.h))},e.\u0275cmp=n.Gb({type:e,selectors:[["rentPlanPopupList"]],decls:5,vars:1,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"pm-rpe-batch"],["lines","none",3,"click",4,"ngFor","ngForOf"],["key","rentPlanPopupList","position","center"],["lines","none",3,"click"],[1,"pm-v-label"],[1,"pm-camelcase"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-row",1),n.Sb(2,"ion-list"),n.Cc(3,m,20,3,"ion-item",2),n.Rb(),n.Rb(),n.Nb(4,"p-toast",3),n.Rb()),2&e&&(n.Ab(3),n.jc("ngForOf",t.rentplans))},directives:[s.k,s.w,s.s,b.k,h.a,s.q,s.r],styles:[""]}),e})();var g=c("27b0"),S=c("3Pt+");function f(e,t){if(1&e&&(n.Sb(0,"ion-label",14),n.Ec(1),n.Rb()),2&e){const e=n.cc();n.Ab(1),n.Fc(e.selectedRentPlan.rentPlan)}}function y(e,t){if(1&e&&(n.Sb(0,"ion-label",14),n.Ec(1),n.Rb()),2&e){const e=n.cc();n.Ab(1),n.Fc(e.selectedRentPlan.rentAmount)}}let R=(()=>{class e{constructor(e,t,c,i,n,a,o,s,l){this.router=e,this.dbconfig=t,this.messageService=c,this.dbprovider=i,this.popoverController=n,this.dialogService=a,this.translate=o,this.config=s,this.ref=l,this.tableName="account",this.savedSuccessMessage="Data saved successfully",this.selectedVehicle=JSON.parse(JSON.stringify(s.data.vehicle));var r=6e4*(new Date).getTimezoneOffset(),b=new Date(Date.now()-r).toISOString().slice(0,-5);this.openDate=b,this.initializeObjects(this.dbconfig.configuration.tableStructure)}initializeObjects(e){this.accountObj=JSON.parse(JSON.stringify(e[this.tableName]))}openRentPlanList(){return Object(i.a)(this,void 0,void 0,function*(){this.dialogService.open(v,{header:this.translate.instant("rentPlanList.title"),width:"50%",data:{vehicleType:this.selectedVehicle.vehicleType}}).onClose.subscribe(e=>{e&&(this.selectedRentPlan=e)})})}saveAction(){this.selectedRentPlan?(this.accountObj.openDate=new Date(this.openDate).getTime(),this.accountObj.rentPlan_lookup=this.selectedRentPlan.id,this.accountObj.vehicle=this.selectedVehicle.id,console.log(this.accountObj),this.dbprovider.save(this.tableName,this.accountObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"accCreation",severity:"success",summary:this.savedSuccessMessage,detail:""}),setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"accCreation",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"accCreation",severity:"error",summary:e,detail:""})})):this.messageService.add({key:"accCreation",severity:"error",summary:"Choose rent plan",detail:"",closable:!0})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(g.a),n.Mb(l.h),n.Mb(r.a),n.Mb(s.H),n.Mb(o.a),n.Mb(d.d),n.Mb(o.b),n.Mb(o.d))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountCreation"]],decls:30,vars:16,consts:[[1,"pm-rpe-popup",2,"height","255px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-ac-c"],["lines","none",1,"pm-bg-header",2,"padding","0px"],["type","datetime-local",3,"ngModel","ngModelChange"],["lines","none"],["style","float: right;text-align: right;",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","accCreation","position","center"],[2,"float","right","text-align","right"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-title",1),n.Sb(2,"span",2),n.Ec(3," Vehical Details : "),n.Rb(),n.Sb(4,"span",3),n.Ec(5),n.Rb(),n.Rb(),n.Sb(6,"div",4),n.Sb(7,"ion-item",5),n.Sb(8,"ion-label"),n.Ec(9),n.dc(10,"translate"),n.Rb(),n.Sb(11,"input",6),n.ac("ngModelChange",function(e){return t.openDate=e}),n.Rb(),n.Rb(),n.Sb(12,"ion-item",7),n.Sb(13,"ion-label"),n.Ec(14),n.dc(15,"translate"),n.Rb(),n.Cc(16,f,2,1,"ion-label",8),n.Sb(17,"ion-button",9),n.ac("click",function(){return t.openRentPlanList()}),n.Nb(18,"ion-icon",10),n.Rb(),n.Rb(),n.Sb(19,"ion-item",7),n.Sb(20,"ion-label"),n.Ec(21),n.dc(22,"translate"),n.Rb(),n.Cc(23,y,2,1,"ion-label",8),n.Rb(),n.Sb(24,"ion-row",11),n.Sb(25,"ion-col"),n.Sb(26,"ion-button",12),n.ac("click",function(){return t.saveAction()}),n.Ec(27),n.dc(28,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(29,"p-toast",13),n.Rb()),2&e&&(n.Ab(5),n.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),n.Ab(4),n.Fc(n.ec(10,8,"accountCreation.openDate")),n.Ab(2),n.jc("ngModel",t.openDate),n.Ab(3),n.Fc(n.ec(15,10,"accountCreation.selectRentPlan")),n.Ab(2),n.jc("ngIf",t.selectedRentPlan),n.Ab(5),n.Fc(n.ec(22,12,"rentPlanEntry.rentAmount")),n.Ab(2),n.jc("ngIf",t.selectedRentPlan),n.Ab(4),n.Fc(n.ec(28,14,"save")))},directives:[s.k,s.z,s.q,s.r,S.a,S.i,S.l,b.l,s.d,s.o,s.w,s.j,h.a],pipes:[d.c],styles:[""]}),e})();var A=c("Nf9I"),C=c("jIHw");function M(e,t){if(1&e&&(n.Sb(0,"div",11),n.Sb(1,"ion-item",12),n.Sb(2,"ion-label"),n.Ec(3),n.dc(4,"translate"),n.Rb(),n.Sb(5,"h5"),n.Ec(6),n.Rb(),n.Rb(),n.Sb(7,"ion-item",12),n.Sb(8,"ion-label"),n.Ec(9),n.dc(10,"translate"),n.Rb(),n.Sb(11,"h5"),n.Ec(12),n.dc(13,"translate"),n.Rb(),n.Rb(),n.Sb(14,"ion-item",12),n.Sb(15,"ion-label"),n.Ec(16),n.dc(17,"translate"),n.Rb(),n.Sb(18,"h5"),n.Ec(19),n.dc(20,"translate"),n.Rb(),n.Rb(),n.Sb(21,"ion-item",12),n.Sb(22,"ion-label"),n.Ec(23),n.dc(24,"translate"),n.Rb(),n.Sb(25,"h5"),n.Ec(26),n.dc(27,"translate"),n.Rb(),n.Rb(),n.Sb(28,"ion-item",12),n.Sb(29,"ion-label"),n.Ec(30),n.dc(31,"translate"),n.Rb(),n.Sb(32,"h5"),n.Ec(33),n.dc(34,"date"),n.Rb(),n.Rb(),n.Sb(35,"ion-item",12),n.Sb(36,"ion-label"),n.Ec(37),n.dc(38,"translate"),n.Rb(),n.Sb(39,"h5"),n.Ec(40),n.dc(41,"date"),n.Rb(),n.Rb(),n.Sb(42,"ion-item",12),n.Sb(43,"ion-label"),n.Ec(44),n.dc(45,"translate"),n.Rb(),n.Sb(46,"h5"),n.Ec(47,"Security 1"),n.Rb(),n.Rb(),n.Rb()),2&e){const e=n.cc();n.Ab(3),n.Fc(n.ec(4,16,"accountDetail.rentPlan")),n.Ab(3),n.Fc(e.selectedAccount.rentPlan_lookup.rentPlan),n.Ab(3),n.Fc(n.ec(10,18,"accountDetail.totalAmount")),n.Ab(3),n.Hc("",e.selectedAccount.totalBillAmount," ",n.ec(13,20,"rs"),""),n.Ab(4),n.Fc(n.ec(17,22,"accountDetail.amountReceived")),n.Ab(3),n.Hc("",e.selectedAccount.receivedAmount," ",n.ec(20,24,"rs"),""),n.Ab(4),n.Fc(n.ec(24,26,"accountDetail.pendingAmount")),n.Ab(3),n.Hc("",e.selectedAccount.totalBillAmount-e.selectedAccount.receivedAmount," ",n.ec(27,28,"rs"),""),n.Ab(4),n.Fc(n.ec(31,30,"accountDetail.accOpenDate")),n.Ab(3),n.Fc(n.fc(34,32,e.selectedAccount.openDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Fc(n.ec(38,35,"accountDetail.accCloseDate")),n.Ab(3),n.Fc(n.fc(41,37,e.selectedAccount.closeDate,"dd/MM/yyyy hh:mm a")),n.Ab(4),n.Fc(n.ec(45,40,"accountDetail.accAddBy"))}}function N(e,t){1&e&&(n.Sb(0,"div",13),n.Sb(1,"div",14),n.Sb(2,"ion-label"),n.Ec(3,"Active account not available. Create new account."),n.Rb(),n.Rb(),n.Rb())}function E(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",15),n.Sb(1,"button",16),n.ac("click",function(){return n.wc(e),n.cc().createAccount()}),n.Rb(),n.Rb()}}function O(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",17),n.Sb(1,"button",18),n.ac("click",function(){return n.wc(e),n.cc().closeAccount()}),n.Rb(),n.Sb(2,"button",19),n.ac("click",function(){return n.wc(e),n.cc().accountHistory()}),n.dc(3,"translate"),n.Rb(),n.Rb()}2&e&&(n.Ab(2),n.kc("label",n.ec(3,1,"history")))}function j(e,t){if(1&e){const e=n.Tb();n.Sb(0,"span",17),n.Sb(1,"button",20),n.ac("click",function(){return n.wc(e),n.cc().createAccount()}),n.Rb(),n.Sb(2,"button",19),n.ac("click",function(){return n.wc(e),n.cc().accountHistory()}),n.dc(3,"translate"),n.Rb(),n.Rb()}2&e&&(n.Ab(2),n.kc("label",n.ec(3,1,"history")))}let k=(()=>{class e{constructor(e,t,c,i,n,a,o,s,l){this.confirmationService=e,this.dlgref=t,this.router=c,this.popoverController=i,this.translate=n,this.dialogService=a,this.messageService=o,this.dbprovider=s,this.config=l,this.tableName="account",this.vehicleTableName="vehicle",this.savedSuccessMessage="Account closed successfully",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(l.data.vehicle)),this.fetchAccounts()}accountHistory(){return Object(i.a)(this,void 0,void 0,function*(){console.log("history"),this.dlgref.close(),this.dialogService.open(u,{header:this.translate.instant("accountHistory.title"),width:"50%",data:{vehicle:this.selectedVehicle}})})}createAccount(){console.log("account creation"),this.dialogService.open(R,{header:this.translate.instant("accountCreation.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAccounts()})}closeAccount(){console.log("close call"),this.confirmationService.confirm({message:"Are you sure that you want to close this account?",accept:()=>{this.selectedAccount.closeDate=(new Date).getTime(),this.dbprovider.save(this.tableName,this.selectedAccount).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"accountDetail",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.fetchAccounts()):this.messageService.add({key:"accountDetail",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e)})}})}fetchAccounts(){this.selectedAccount=null,this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(e=>{console.log(e),e&&"SUCCESS"==e.status?(e.records.length>0&&e.records.forEach(e=>{e.closeDate||(this.selectedAccount=e)}),this.accountList=e.records):this.messageService.add({key:"accountDetail",severity:"error",summary:e.message,detail:""})})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(l.b),n.Mb(o.d),n.Mb(a.g),n.Mb(s.H),n.Mb(d.d),n.Mb(o.a),n.Mb(l.h),n.Mb(r.a),n.Mb(o.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["accountDetail"]],decls:14,vars:6,consts:[[1,"pm-rpe-popup",2,"height","375px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],["class","pm-r-car-list pm-ac-d-list",4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","accountDetail","position","center"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[2,"text-align","center"],["class","p-buttonset","style","text-align: center;",4,"ngIf"],["class","p-buttonset",4,"ngIf"],[1,"pm-r-car-list","pm-ac-d-list"],["lines","none"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],[1,"p-buttonset",2,"text-align","center"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",3,"click"],[1,"p-buttonset"],["pButton","","type","button","label","Close account","icon","pi pi-times-circle",2,"float","left",3,"click"],["pButton","","type","button","icon","pi pi-clock",2,"float","right",3,"label","click"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",2,"float","left",3,"click"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"ion-title",1),n.Sb(2,"span",2),n.Ec(3," Vehical Details : "),n.Rb(),n.Sb(4,"span",3),n.Ec(5),n.Rb(),n.Rb(),n.Cc(6,M,48,42,"div",4),n.Cc(7,N,4,0,"div",5),n.Nb(8,"p-toast",6),n.Nb(9,"p-confirmDialog",7),n.Rb(),n.Sb(10,"ion-footer",8),n.Cc(11,E,2,0,"span",9),n.Cc(12,O,4,3,"span",10),n.Cc(13,j,4,3,"span",10),n.Rb()),2&e&&(n.Ab(5),n.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),n.Ab(1),n.jc("ngIf",t.selectedAccount),n.Ab(1),n.jc("ngIf",!t.selectedAccount),n.Ab(4),n.jc("ngIf",!t.selectedAccount&&0==t.accountList.length),n.Ab(1),n.jc("ngIf",t.selectedAccount&&t.accountList.length>0),n.Ab(1),n.jc("ngIf",!t.selectedAccount&&t.accountList.length>0))},directives:[s.k,s.z,b.l,h.a,A.a,s.l,s.q,s.r,C.b],pipes:[d.c,b.e],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}.pm-ac-d-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background:#fff;color:#212e3f;border-bottom:1px solid #ececec}"]}),e})()},VqLa:function(e,t,c){"use strict";c.d(t,"a",function(){return R});var i=c("mrSG"),n=c("xHpX"),a=c("fXoL"),o=c("tyNb"),s=c("sYmb"),l=c("7zfz"),r=c("tp0D"),b=c("J7/z"),h=c("TEn/"),d=c("ofXK"),p=c("Gxio"),u=c("jIHw");function m(e,t){if(1&e&&(a.Sb(0,"h3"),a.Sb(1,"span",13),a.Ec(2,"Name : "),a.Rb(),a.Sb(3,"span",14),a.Sb(4,"strong"),a.Ec(5),a.Rb(),a.Rb(),a.Rb()),2&e){const e=a.cc().$implicit;a.Ab(5),a.Fc(e.contactName)}}function v(e,t){if(1&e&&(a.Sb(0,"h3"),a.Sb(1,"span",13),a.Ec(2,"\u0baa\u0bc6\u0baf\u0bb0\u0bcd : "),a.Rb(),a.Sb(3,"span",14),a.Sb(4,"strong"),a.Ec(5),a.Rb(),a.Rb(),a.Rb()),2&e){const e=a.cc().$implicit;a.Ab(5),a.Fc(e.contactNameInTamil)}}function g(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-item",10),a.ac("click",function(c){a.wc(e);const i=t.$implicit;return a.cc(2).editContact(i),c.stopPropagation()}),a.Sb(1,"ion-avatar",11),a.Nb(2,"ion-icon",12),a.Rb(),a.Sb(3,"ion-label"),a.Cc(4,m,6,1,"h3",5),a.Cc(5,v,6,1,"h3",5),a.Sb(6,"h3"),a.Sb(7,"span",13),a.Ec(8,"Mobile Number : "),a.Rb(),a.Sb(9,"span",14),a.Sb(10,"strong"),a.Ec(11),a.Rb(),a.Rb(),a.Rb(),a.Sb(12,"h3"),a.Sb(13,"span",13),a.Ec(14,"License Number : "),a.Rb(),a.Sb(15,"span",14),a.Sb(16,"strong"),a.Ec(17),a.Rb(),a.Rb(),a.Rb(),a.Sb(18,"h3"),a.Sb(19,"span",13),a.Ec(20,"Security Name : "),a.Rb(),a.Sb(21,"span",14),a.Sb(22,"strong"),a.Ec(23),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb()}if(2&e){const e=t.$implicit,c=a.cc(2);a.Ab(4),a.jc("ngIf",c.appLanguage&&"en"==c.appLanguage),a.Ab(1),a.jc("ngIf",c.appLanguage&&"ta"==c.appLanguage),a.Ab(6),a.Fc(e.contactMobile),a.Ab(6),a.Fc(e.licenseNumber),a.Ab(6),a.Fc(e.securityName)}}function S(e,t){if(1&e&&(a.Sb(0,"ion-list"),a.Cc(1,g,24,5,"ion-item",9),a.Rb()),2&e){const e=a.cc();a.Ab(1),a.jc("ngForOf",e.contactList)}}function f(e,t){if(1&e){const e=a.Tb();a.Sb(0,"div",15),a.Sb(1,"div",16),a.Sb(2,"ion-label"),a.Ec(3,"Alternate contact not available."),a.Rb(),a.Nb(4,"br"),a.Nb(5,"br"),a.Sb(6,"button",17),a.ac("click",function(){return a.wc(e),a.cc().createAlternateContact()}),a.Rb(),a.Rb(),a.Rb()}}function y(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-footer",18),a.Sb(1,"span",19),a.Sb(2,"button",17),a.ac("click",function(){return a.wc(e),a.cc().createAlternateContact()}),a.Rb(),a.Rb(),a.Rb()}}let R=(()=>{class e{constructor(e,t,c,i,n,a){this.router=e,this.translate=t,this.messageService=c,this.dbprovider=i,this.config=n,this.dialogService=a,this.contactList=[],this.appLanguage="ta",this.contactTableName="contact",this.vehicleContactAssignmentTableName="vehicleContactAssignment",this.appLanguage=this.translate.getDefaultLang(),this.selectedVehicle=JSON.parse(JSON.stringify(n.data.vehicle)),this.fetchAlternateContactList()}itemSelect(e){}fetchAlternateContactList(){this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicle_lookup":this.selectedVehicle.id,"data.type":this.vehicleContactAssignmentTableName},sort:["data.vehicle_lookup"]}).then(e=>{if(console.log(e),"SUCCESS"==e.status&&e.records.length>0){const t=e.records.map(e=>e.contact_lookup).map(e=>this.contactTableName+"_2_"+e);this.fetchContactListAgainstVehicle(t)}else this.messageService.add({key:"alternateContactList",severity:"error",summary:e.message,detail:""})})}fetchContactListAgainstVehicle(e){console.log(e),this.contactList=[],this.dbprovider.fetchDocsWithDocIds(e).then(e=>{console.log(e),"SUCCESS"==e.status&&e.response.length>0?e.response.forEach(e=>{console.log(e),"others"==e.contactType&&this.contactList.push(e)}):this.contactList=[]}).catch(e=>{this.contactList=[]})}createAlternateContact(){return Object(i.a)(this,void 0,void 0,function*(){console.log("add contact"),this.dialogService.open(n.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:"",mode:"new",contactType:"Others",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAlternateContactList()})})}editContact(e){console.log(e),delete JSON.parse(JSON.stringify(e)).selected,this.dialogService.open(n.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:e,mode:"edit",contactType:"Primary",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(e=>{e&&"SUCCESS"==e&&this.fetchAlternateContactList()})}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(s.d),a.Mb(l.h),a.Mb(r.a),a.Mb(b.b),a.Mb(b.a))},e.\u0275cmp=a.Gb({type:e,selectors:[["contactListAgainstCar"]],decls:11,vars:4,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],[4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","alternateContactList","position","center"],["style","text-align: center;",4,"ngIf"],["lines","none",3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click"],["slot","start"],["name","person-circle-outline"],[1,"pm-v-label"],[1,"pm-camelcase"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],["pButton","","type","button","label","Create alternate contact","icon","pi pi-plus",3,"click"],[2,"text-align","center"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"ion-title",1),a.Sb(2,"span",2),a.Ec(3," Vehical Details : "),a.Rb(),a.Sb(4,"span",3),a.Ec(5),a.Rb(),a.Rb(),a.Sb(6,"ion-row",4),a.Cc(7,S,2,1,"ion-list",5),a.Rb(),a.Cc(8,f,7,0,"div",6),a.Nb(9,"p-toast",7),a.Rb(),a.Cc(10,y,3,0,"ion-footer",8)),2&e&&(a.Ab(5),a.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),a.Ab(2),a.jc("ngIf",0!=t.contactList.length),a.Ab(1),a.jc("ngIf",0==t.contactList.length),a.Ab(2),a.jc("ngIf",t.contactList.length>0))},directives:[h.k,h.z,h.w,d.l,p.a,h.s,d.k,h.q,h.c,h.o,h.r,u.b,h.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),e})()},XqSU:function(e,t,c){"use strict";c.d(t,"a",function(){return R});var i=c("mrSG"),n=c("3Pt+"),a=c("fXoL"),o=c("tyNb"),s=c("27b0"),l=c("tp0D"),r=c("7zfz"),b=c("J7/z"),h=c("TEn/"),d=c("Gxio"),p=c("sYmb");let u=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.alternateVehicleObj={},this.vehicleObj={},this.contactId="",this.vehicleId="",this.tableName="alternateVehicle",this.savedSuccessMessage="Data saved successfully",this.vehicleObj=JSON.parse(JSON.stringify(o.data.vehicle)),"edit"==o.data.mode?this.alternateVehicleObj=JSON.parse(JSON.stringify(o.data.object)):this.initializeObjects(this.dbconfig.configuration.tableStructure),this.createFormGroup(),this.contactId=this.config.data.contactId}initializeObjects(e){this.alternateVehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.alternateVehicleObj.vehicleType="bike"}createFormGroup(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",n.o.compose([n.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",n.o.compose([n.o.required])]})})}saveAction(){console.log(this.alternateVehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.alternateVehicleObj.vehicleType,vehicleBrand:this.alternateVehicleObj.vehicleBrand,vehicleModel:this.alternateVehicleObj.vehicleModel,vehicleColor:this.alternateVehicleObj.vehicleColor,vehicleNumber:this.alternateVehicleObj.vehicleNumber.toUpperCase()}}),this.alternateVehicleObj.vehicle=this.vehicleObj.id,this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.alternateVehicleObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"alternateVehicleEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.vehicleId=e.id,setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.alternateVehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.alternateVehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(s.a),a.Mb(n.b),a.Mb(l.a),a.Mb(r.h),a.Mb(b.d),a.Mb(b.b))},e.\u0275cmp=a.Gb({type:e,selectors:[["alternateVehicleEntry"]],decls:50,vars:36,consts:[[1,"pm-rpe-popup",2,"height","360px"],[3,"formGroup"],["lines","none","formGroupName","vehicle"],["value","bike","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["lines","none",1,"pm-no-b-b"],["value","bike",1,"pm-rsmar"],["value","car",1,"pm-rsmar"],["value","auto",1,"pm-rsmar"],["value","others",1,"pm-rsmar"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","alternateVehicleEntry","position","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"form",1),a.Sb(2,"ion-item",2),a.Sb(3,"ion-radio-group",3),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleType=e}),a.Sb(4,"ion-label"),a.Ec(5),a.dc(6,"translate"),a.Rb(),a.Sb(7,"ion-item",4),a.Nb(8,"ion-radio",5),a.Sb(9,"ion-label"),a.Ec(10),a.dc(11,"translate"),a.Rb(),a.Nb(12,"ion-radio",6),a.Sb(13,"ion-label"),a.Ec(14),a.dc(15,"translate"),a.Rb(),a.Nb(16,"ion-radio",7),a.Sb(17,"ion-label"),a.Ec(18),a.dc(19,"translate"),a.Rb(),a.Nb(20,"ion-radio",8),a.Sb(21,"ion-label"),a.Ec(22),a.dc(23,"translate"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Sb(24,"ion-item",2),a.Sb(25,"ion-label",9),a.Ec(26),a.dc(27,"translate"),a.Rb(),a.Sb(28,"ion-input",10),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleBrand=e}),a.Rb(),a.Rb(),a.Sb(29,"ion-item",2),a.Sb(30,"ion-label",9),a.Ec(31),a.dc(32,"translate"),a.Rb(),a.Sb(33,"ion-input",11),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleModel=e}),a.Rb(),a.Rb(),a.Sb(34,"ion-item",2),a.Sb(35,"ion-label",9),a.Ec(36),a.dc(37,"translate"),a.Rb(),a.Sb(38,"ion-input",12),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleColor=e}),a.Rb(),a.Rb(),a.Sb(39,"ion-item",2),a.Sb(40,"ion-label",9),a.Ec(41),a.dc(42,"translate"),a.Rb(),a.Sb(43,"ion-input",13),a.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleNumber=e}),a.Rb(),a.Rb(),a.Sb(44,"ion-row",14),a.Sb(45,"ion-col"),a.Sb(46,"ion-button",15),a.ac("click",function(){return t.saveAction()}),a.Ec(47),a.dc(48,"translate"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Nb(49,"p-toast",16),a.Rb()),2&e&&(a.Ab(1),a.jc("formGroup",t.formGroup),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleType),a.Ab(2),a.Fc(a.ec(6,16,"vehicleEntry.vehicleType")),a.Ab(5),a.Fc(a.ec(11,18,"vehicleEntry.bike")),a.Ab(4),a.Fc(a.ec(15,20,"vehicleEntry.car")),a.Ab(4),a.Fc(a.ec(19,22,"vehicleEntry.auto")),a.Ab(4),a.Fc(a.ec(23,24,"vehicleEntry.others")),a.Ab(4),a.Gc("",a.ec(27,26,"vehicleEntry.vehicleBrand")," "),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleBrand),a.Ab(3),a.Fc(a.ec(32,28,"vehicleEntry.vehicleModel")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleModel),a.Ab(3),a.Fc(a.ec(37,30,"vehicleEntry.vehicleColor")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleColor),a.Ab(3),a.Fc(a.ec(42,32,"vehicleEntry.vehicleNumber")),a.Ab(2),a.jc("ngModel",t.alternateVehicleObj.vehicleNumber),a.Ab(4),a.Fc(a.ec(48,34,"save")))},directives:[h.k,n.p,n.j,n.d,h.q,n.e,h.u,h.J,n.i,n.c,h.r,h.t,h.I,h.p,h.K,n.n,h.w,h.j,h.d,d.a],pipes:[p.c],styles:[""]}),e})();var m=c("ofXK"),v=c("jIHw");function g(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-item",10),a.ac("click",function(c){a.wc(e);const i=t.$implicit;return a.cc(2).itemSelect(i),c.stopPropagation()}),a.Sb(1,"ion-avatar",11),a.Nb(2,"ion-icon",12),a.Rb(),a.Sb(3,"ion-label"),a.Sb(4,"h3"),a.Sb(5,"span",13),a.Ec(6,"Vehicle Type : "),a.Rb(),a.Sb(7,"span",14),a.Sb(8,"strong"),a.Ec(9),a.Rb(),a.Rb(),a.Rb(),a.Sb(10,"h3"),a.Sb(11,"span",13),a.Ec(12,"Vehicle Brand : "),a.Rb(),a.Sb(13,"span",14),a.Sb(14,"strong"),a.Ec(15),a.Rb(),a.Rb(),a.Rb(),a.Sb(16,"h3"),a.Sb(17,"span",13),a.Ec(18,"Vehicle Number : "),a.Rb(),a.Sb(19,"span",14),a.Sb(20,"strong"),a.Ec(21),a.Rb(),a.Rb(),a.Rb(),a.Sb(22,"h3"),a.Sb(23,"span",13),a.Ec(24,"Vehicle Color : "),a.Rb(),a.Sb(25,"span",14),a.Sb(26,"strong"),a.Ec(27),a.Rb(),a.Rb(),a.Rb(),a.Sb(28,"h3"),a.Sb(29,"span",13),a.Ec(30,"Added By : "),a.Rb(),a.Sb(31,"span",14),a.Sb(32,"strong"),a.Ec(33),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb()}if(2&e){const e=t.$implicit;a.Ab(9),a.Fc(e.vehicleType),a.Ab(6),a.Hc("",e.vehicleBrand," ",e.vehicleModel,""),a.Ab(6),a.Fc(e.vehicleNumber),a.Ab(6),a.Fc(e.vehicleColor),a.Ab(6),a.Fc(e.addedBy)}}function S(e,t){if(1&e&&(a.Sb(0,"ion-list"),a.Cc(1,g,34,6,"ion-item",9),a.Rb()),2&e){const e=a.cc();a.Ab(1),a.jc("ngForOf",e.vehicleList)}}function f(e,t){if(1&e){const e=a.Tb();a.Sb(0,"div",15),a.Sb(1,"div",16),a.Sb(2,"ion-label"),a.Ec(3,"Alternate vehicle not available."),a.Rb(),a.Nb(4,"br"),a.Nb(5,"br"),a.Sb(6,"button",17),a.ac("click",function(){return a.wc(e),a.cc().createAlternateVehicle()}),a.Rb(),a.Rb(),a.Rb()}}function y(e,t){if(1&e){const e=a.Tb();a.Sb(0,"ion-footer",18),a.Sb(1,"span",19),a.Sb(2,"button",17),a.ac("click",function(){return a.wc(e),a.cc().createAlternateVehicle()}),a.Rb(),a.Rb(),a.Rb()}}let R=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.popoverController=t,this.translate=c,this.messageService=i,this.dbprovider=n,this.config=a,this.dialogService=o,this.vehicleList=[],this.tableName="alternateVehicle",this.vehicleTableName="vehicle",this.selectedVehicle=JSON.parse(JSON.stringify(a.data.vehicle)),this.fetchAlternateVehicles()}createAlternateVehicle(){return Object(i.a)(this,void 0,void 0,function*(){console.log("alternate vehicle detail"),this.dialogService.open(u,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:"",mode:"new"}}).onClose.subscribe(e=>{this.fetchAlternateVehicles()})})}fetchAlternateVehicles(){this.dbprovider.fetchDocsWithoutRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id).then(e=>{console.log(e),e&&"SUCCESS"==e.status?this.vehicleList=e.records:this.messageService.add({key:"alternateVehicleList",severity:"error",summary:e.message,detail:""})})}itemSelect(e){this.dialogService.open(u,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:e,mode:"edit"}}).onClose.subscribe(e=>{this.fetchAlternateVehicles()})}}return e.\u0275fac=function(t){return new(t||e)(a.Mb(o.g),a.Mb(h.H),a.Mb(p.d),a.Mb(r.h),a.Mb(l.a),a.Mb(b.b),a.Mb(b.a))},e.\u0275cmp=a.Gb({type:e,selectors:[["alternateVehicleList"]],decls:11,vars:4,consts:[[1,"pm-rpe-popup",2,"height","400px"],[1,"ion-text-center","pm-rpep-title"],[1,"pm-rpep-label"],[1,"pm-rpep-vd"],[1,"pm-rpe-batch"],[4,"ngIf"],["class","pm-rpe-batch-avna",4,"ngIf"],["key","alternateVehicleList","position","center"],["style","text-align: center;",4,"ngIf"],["lines","none",3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click"],["slot","start"],["name","car-sport-outline",2,"font-size","50px"],[1,"pm-v-label"],[1,"pm-camelcase"],[1,"pm-rpe-batch-avna"],[1,"pm-a-c"],["pButton","","type","button","label","Create alternate vehicle","icon","pi pi-plus",3,"click"],[2,"text-align","center"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(a.Sb(0,"ion-content",0),a.Sb(1,"ion-title",1),a.Sb(2,"span",2),a.Ec(3,"Vehical Details : "),a.Rb(),a.Sb(4,"span",3),a.Ec(5),a.Rb(),a.Rb(),a.Sb(6,"ion-row",4),a.Cc(7,S,2,1,"ion-list",5),a.Rb(),a.Cc(8,f,7,0,"div",6),a.Nb(9,"p-toast",7),a.Rb(),a.Cc(10,y,3,0,"ion-footer",8)),2&e&&(a.Ab(5),a.Fc(t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber),a.Ab(2),a.jc("ngIf",0!=t.vehicleList.length),a.Ab(1),a.jc("ngIf",0==t.vehicleList.length),a.Ab(2),a.jc("ngIf",t.vehicleList.length>0))},directives:[h.k,h.z,h.w,m.l,d.a,h.s,m.k,h.q,h.c,h.o,h.r,v.b,h.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),e})()},eKwt:function(e,t,c){"use strict";c.d(t,"a",function(){return p});var i=c("3Pt+"),n=c("fXoL"),a=c("tyNb"),o=c("27b0"),s=c("tp0D"),l=c("7zfz"),r=c("J7/z"),b=c("TEn/"),h=c("Gxio"),d=c("sYmb");let p=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.vehicleObj={},this.vehicleandContactAssgObj={},this.contactId="",this.vehicleId="",this.tableName="vehicle",this.assignmenttableName="vehicleContactAssignment",this.savedSuccessMessage="Data saved successfully","edit"==o.data.mode?this.vehicleObj=JSON.parse(JSON.stringify(o.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup(),this.contactId=this.config.data.contactId}initializeObjects(e){this.vehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.vehicleObj.vehicleType="car"}initializeAssignmentObjects(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}createFormGroup(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",i.o.compose([i.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",i.o.compose([i.o.required])]})})}saveAction(){console.log(this.vehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.vehicleObj.vehicleType,vehicleBrand:this.vehicleObj.vehicleBrand,vehicleModel:this.vehicleObj.vehicleModel,vehicleColor:this.vehicleObj.vehicleColor,vehicleNumber:this.vehicleObj.vehicleNumber.toUpperCase()}}),this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.vehicleObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"vehicleEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.vehicleId=e.id,"edit"!=this.config.data.mode?this.saveContactAndVehicleAssignment():setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"vehicleEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"vehicleEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.vehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.vehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}saveContactAndVehicleAssignment(){this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(e=>{console.log(e),"SUCCESS"!=e.status?console.log("Vehicle assignment save failed",e):console.log("Vehicle assignment save Success"),setTimeout(()=>this.ref.close("SUCCESS"),1e3)})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.a),n.Mb(i.b),n.Mb(s.a),n.Mb(l.h),n.Mb(r.d),n.Mb(r.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["vehicleEntry"]],decls:46,vars:33,consts:[[1,"pm-rpe-popup",2,"height","360px"],[3,"formGroup"],["lines","none","formGroupName","vehicle"],["value","car","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["lines","none",1,"pm-no-b-b"],["value","car",1,"pm-rsmar"],["value","auto",1,"pm-rsmar"],["value","others",1,"pm-rsmar"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","vehicleEntry","position","center"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"form",1),n.Sb(2,"ion-item",2),n.Sb(3,"ion-radio-group",3),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleType=e}),n.Sb(4,"ion-label"),n.Ec(5),n.dc(6,"translate"),n.Rb(),n.Sb(7,"ion-item",4),n.Nb(8,"ion-radio",5),n.Sb(9,"ion-label"),n.Ec(10),n.dc(11,"translate"),n.Rb(),n.Nb(12,"ion-radio",6),n.Sb(13,"ion-label"),n.Ec(14),n.dc(15,"translate"),n.Rb(),n.Nb(16,"ion-radio",7),n.Sb(17,"ion-label"),n.Ec(18),n.dc(19,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(20,"ion-item",2),n.Sb(21,"ion-label",8),n.Ec(22),n.dc(23,"translate"),n.Rb(),n.Sb(24,"ion-input",9),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleBrand=e}),n.Rb(),n.Rb(),n.Sb(25,"ion-item",2),n.Sb(26,"ion-label",8),n.Ec(27),n.dc(28,"translate"),n.Rb(),n.Sb(29,"ion-input",10),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleModel=e}),n.Rb(),n.Rb(),n.Sb(30,"ion-item",2),n.Sb(31,"ion-label",8),n.Ec(32),n.dc(33,"translate"),n.Rb(),n.Sb(34,"ion-input",11),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleColor=e}),n.Rb(),n.Rb(),n.Sb(35,"ion-item",2),n.Sb(36,"ion-label",8),n.Ec(37),n.dc(38,"translate"),n.Rb(),n.Sb(39,"ion-input",12),n.ac("ngModelChange",function(e){return t.vehicleObj.vehicleNumber=e}),n.Rb(),n.Rb(),n.Sb(40,"ion-row",13),n.Sb(41,"ion-col"),n.Sb(42,"ion-button",14),n.ac("click",function(){return t.saveAction()}),n.Ec(43),n.dc(44,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(45,"p-toast",15),n.Rb()),2&e&&(n.Ab(1),n.jc("formGroup",t.formGroup),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleType),n.Ab(2),n.Fc(n.ec(6,15,"vehicleEntry.vehicleType")),n.Ab(5),n.Fc(n.ec(11,17,"vehicleEntry.car")),n.Ab(4),n.Fc(n.ec(15,19,"vehicleEntry.auto")),n.Ab(4),n.Fc(n.ec(19,21,"vehicleEntry.others")),n.Ab(4),n.Gc("",n.ec(23,23,"vehicleEntry.vehicleBrand")," "),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleBrand),n.Ab(3),n.Fc(n.ec(28,25,"vehicleEntry.vehicleModel")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleModel),n.Ab(3),n.Fc(n.ec(33,27,"vehicleEntry.vehicleColor")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleColor),n.Ab(3),n.Fc(n.ec(38,29,"vehicleEntry.vehicleNumber")),n.Ab(2),n.jc("ngModel",t.vehicleObj.vehicleNumber),n.Ab(4),n.Fc(n.ec(44,31,"save")))},directives:[b.k,i.p,i.j,i.d,b.q,i.e,b.u,b.J,i.i,i.c,b.r,b.t,b.I,b.p,b.K,i.n,b.w,b.j,b.d,h.a],pipes:[d.c],styles:[""]}),e})()},xHpX:function(e,t,c){"use strict";c.d(t,"a",function(){return p});var i=c("3Pt+"),n=c("fXoL"),a=c("tyNb"),o=c("27b0"),s=c("tp0D"),l=c("7zfz"),r=c("J7/z"),b=c("TEn/"),h=c("Gxio"),d=c("sYmb");let p=(()=>{class e{constructor(e,t,c,i,n,a,o){this.router=e,this.dbconfig=t,this.formBuilder=c,this.dbprovider=i,this.messageService=n,this.ref=a,this.config=o,this.contactObj={},this.tableName="contact",this.savedSuccessMessage="Data saved successfully",this.contactType="",this.vehicleandContactAssgObj={},this.assignmenttableName="vehicleContactAssignment",this.contactType=this.config.data.contactType,this.vehicleId=this.config.data.vehicleId,"edit"==o.data.mode?this.contactObj=JSON.parse(JSON.stringify(o.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup()}initializeAssignmentObjects(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}initializeObjects(e){this.contactObj=JSON.parse(JSON.stringify(e[this.tableName])),this.contactObj.contactType="Primary"==this.contactType?"owner":"others"}createFormGroup(){this.formGroup=this.formBuilder.group({contact:this.formBuilder.group({contactName:["",i.o.compose([i.o.maxLength(80),i.o.required])],contactNameInTamil:[""],contactMobile:["",[i.o.required,i.o.pattern("^((\\+91-?)|0)?[0-9]{10}$")]],licenseNumber:[""]})})}saveAction(){console.log(this.contactObj),this.formGroup.patchValue({contact:{contactName:this.contactObj.contactName,contactNameInTamil:this.contactObj.contactNameInTamil,contactMobile:this.contactObj.contactMobile,licenseNumber:this.contactObj.licenseNumber}}),this.formGroup.valid?this.alreadyExistValidation().then(e=>{e?this.messageService.add({key:"contactEntry",severity:"error",summary:"Mobile number already exist",detail:"",closable:!0}):this.dbprovider.save(this.tableName,this.contactObj).then(e=>{"SUCCESS"==e.status?(this.messageService.add({key:"contactEntry",severity:"success",summary:this.savedSuccessMessage,detail:""}),this.contactId=e.id,"edit"!=this.config.data.mode&&"others"==this.contactObj.contactType?this.saveContactAndVehicleAssignment():setTimeout(()=>this.ref.close("SUCCESS"),1e3)):this.messageService.add({key:"contactEntry",severity:"error",summary:e.message,detail:"",closable:!0})}).catch(e=>{console.log(e),this.messageService.add({key:"contactEntry",severity:"error",summary:e,detail:""})})}):this.messageService.add({key:"contactEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}alreadyExistValidation(){var e=!1;return"edit"==this.config.data.mode&&this.contactObj.contactMobile==this.config.data.object.contactMobile?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.contactMobile":this.contactObj.contactMobile,"data.type":this.tableName},sort:["data.contactMobile"]}).then(t=>("SUCCESS"==t.status&&t.records.length>0&&(e=!0),e))}saveContactAndVehicleAssignment(){this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(e=>{console.log(e),"SUCCESS"!=e.status?console.log("Vehicle assignment save failed",e):console.log("Vehicle assignment save Success"),setTimeout(()=>this.ref.close("SUCCESS"),1e3)})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.g),n.Mb(o.a),n.Mb(i.b),n.Mb(s.a),n.Mb(l.h),n.Mb(r.d),n.Mb(r.b))},e.\u0275cmp=n.Gb({type:e,selectors:[["contactEntry"]],decls:28,vars:20,consts:[[1,"pm-rpe-popup",2,"height","290px"],[3,"formGroup"],["lines","none","formGroupName","contact"],["position","floating"],["type","text","formControlName","contactName","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","contactNameInTamil",3,"ngModel","ngModelChange"],["type","number","formControlName","contactMobile","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","licenseNumber",3,"ngModel","ngModelChange"],[1,"pm-tmar"],["type","submit","color","danger","expand","block",3,"click"],["key","contactEntry","position","center"]],template:function(e,t){1&e&&(n.Sb(0,"ion-content",0),n.Sb(1,"form",1),n.Sb(2,"ion-item",2),n.Sb(3,"ion-label",3),n.Ec(4),n.dc(5,"translate"),n.Rb(),n.Sb(6,"ion-input",4),n.ac("ngModelChange",function(e){return t.contactObj.contactName=e}),n.Rb(),n.Rb(),n.Sb(7,"ion-item",2),n.Sb(8,"ion-label",3),n.Ec(9),n.dc(10,"translate"),n.Rb(),n.Sb(11,"ion-input",5),n.ac("ngModelChange",function(e){return t.contactObj.contactNameInTamil=e}),n.Rb(),n.Rb(),n.Sb(12,"ion-item",2),n.Sb(13,"ion-label",3),n.Ec(14),n.dc(15,"translate"),n.Rb(),n.Sb(16,"ion-input",6),n.ac("ngModelChange",function(e){return t.contactObj.contactMobile=e}),n.Rb(),n.Rb(),n.Sb(17,"ion-item",2),n.Sb(18,"ion-label",3),n.Ec(19),n.dc(20,"translate"),n.Rb(),n.Sb(21,"ion-input",7),n.ac("ngModelChange",function(e){return t.contactObj.licenseNumber=e}),n.Rb(),n.Rb(),n.Sb(22,"ion-row",8),n.Sb(23,"ion-col"),n.Sb(24,"ion-button",9),n.ac("click",function(){return t.saveAction()}),n.Ec(25),n.dc(26,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(27,"p-toast",10),n.Rb()),2&e&&(n.Ab(1),n.jc("formGroup",t.formGroup),n.Ab(3),n.Gc("",n.ec(5,10,"contactEntry.contactName")," "),n.Ab(2),n.jc("ngModel",t.contactObj.contactName),n.Ab(3),n.Fc(n.ec(10,12,"contactEntry.contactNameInTamil")),n.Ab(2),n.jc("ngModel",t.contactObj.contactNameInTamil),n.Ab(3),n.Fc(n.ec(15,14,"contactEntry.contactMobile")),n.Ab(2),n.jc("ngModel",t.contactObj.contactMobile),n.Ab(3),n.Fc(n.ec(20,16,"contactEntry.licenseNumber")),n.Ab(2),n.jc("ngModel",t.contactObj.licenseNumber),n.Ab(4),n.Gc("",n.ec(26,18,"save")," "))},directives:[b.k,i.p,i.j,i.d,b.q,i.e,b.r,b.p,b.K,i.i,i.c,i.n,b.F,b.w,b.j,b.d,h.a],pipes:[d.c],styles:[""]}),e})()}}]);