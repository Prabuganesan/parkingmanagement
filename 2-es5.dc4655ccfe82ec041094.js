!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var c=0;c<t.length;c++){var i=t[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,c,i){return c&&t(e.prototype,c),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"0Eai":function(t,i,n){"use strict";n.d(i,"a",function(){return D});var a=n("mrSG"),o=n("fXoL"),l=n("J7/z"),s=n("TEn/"),r=n("7zfz"),b=n("tp0D"),h=n("ofXK"),u=n("Gxio"),d=n("sYmb");function v(e,t){if(1&e&&(o.Sb(0,"ion-item",5),o.Sb(1,"ion-label"),o.Sb(2,"h2"),o.Ec(3),o.dc(4,"translate"),o.Sb(5,"b"),o.Ec(6),o.dc(7,"date"),o.Rb(),o.Rb(),o.Sb(8,"h2"),o.Ec(9),o.dc(10,"translate"),o.Sb(11,"b"),o.Ec(12),o.dc(13,"date"),o.Rb(),o.Rb(),o.Sb(14,"h2"),o.Ec(15),o.dc(16,"translate"),o.Sb(17,"b"),o.Ec(18),o.dc(19,"translate"),o.Rb(),o.Rb(),o.Sb(20,"h2"),o.Ec(21),o.dc(22,"translate"),o.Sb(23,"b"),o.Ec(24),o.dc(25,"translate"),o.Rb(),o.Rb(),o.Sb(26,"h2"),o.Ec(27),o.dc(28,"translate"),o.Sb(29,"b"),o.Ec(30),o.dc(31,"translate"),o.Rb(),o.Rb(),o.Sb(32,"h2"),o.Ec(33),o.dc(34,"translate"),o.Sb(35,"b"),o.Ec(36),o.Rb(),o.Rb(),o.Sb(37,"p"),o.Ec(38),o.dc(39,"translate"),o.Rb(),o.Rb(),o.Rb()),2&e){var c=t.$implicit;o.Ab(3),o.Gc("",o.ec(4,17,"accountDetail.accOpenDate")," :"),o.Ab(3),o.Gc(" ",o.fc(7,19,c.openDate,"dd/MM/yyyy hh:mm a"),""),o.Ab(3),o.Gc("",o.ec(10,22,"accountDetail.accCloseDate")," :"),o.Ab(3),o.Gc(" ",o.fc(13,24,c.closeDate,"dd/MM/yyyy hh:mm a"),""),o.Ab(3),o.Gc("",o.ec(16,27,"accountDetail.totalAmount")," :"),o.Ab(3),o.Hc(" ",c.totalBillAmount," ",o.ec(19,29,"rs"),""),o.Ab(3),o.Gc("",o.ec(22,31,"accountDetail.amountReceived")," :"),o.Ab(3),o.Hc(" ",c.receivedAmount," ",o.ec(25,33,"rs"),""),o.Ab(3),o.Gc("",o.ec(28,35,"accountDetail.pendingAmount")," :"),o.Ab(3),o.Hc(" ",c.pendingAmount," ",o.ec(31,37,"rs"),""),o.Ab(3),o.Gc("",o.ec(34,39,"accountDetail.rentPlan")," :"),o.Ab(3),o.Gc(" ",c.rentPlan_lookup.rentPlan,""),o.Ab(2),o.Hc("",o.ec(39,41,"accountDetail.accAddBy")," : ",c.accountAddedBy,"")}}var m,f=((m=function(){function t(c,i,n,a,o){e(this,t),this.dialogService=c,this.config=i,this.popoverController=n,this.messageService=a,this.dbprovider=o,this.tableName="account",this.vehicleTableName="vehicle",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(i.data.vehicle)),this.fetchAccounts()}return c(t,[{key:"fetchAccounts",value:function(){var e=this;this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(function(t){console.log(t),t&&"SUCCESS"==t.status?e.accountList=t.records:e.messageService.add({key:"accountHistory",severity:"error",summary:t.message,detail:""})})}}]),t}()).\u0275fac=function(e){return new(e||m)(o.Mb(l.a),o.Mb(l.b),o.Mb(s.H),o.Mb(r.h),o.Mb(b.a))},m.\u0275cmp=o.Gb({type:m,selectors:[["accountHistory"]],decls:6,vars:2,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],["lines","full",4,"ngFor","ngForOf"],["key","accountHistory","position","center"],["lines","full"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-title",1),o.Ec(2),o.Rb(),o.Sb(3,"ion-list",2),o.Cc(4,v,40,43,"ion-item",3),o.Rb(),o.Nb(5,"p-toast",4),o.Rb()),2&e&&(o.Ab(2),o.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),o.Ab(2),o.jc("ngForOf",t.accountList))},directives:[s.k,s.z,s.s,h.k,u.a,s.q,s.r],pipes:[d.c,h.e],styles:[""]}),m),g=n("tyNb");function p(e,t){if(1&e){var c=o.Tb();o.Sb(0,"ion-item",4),o.ac("click",function(e){o.wc(c);var i=t.$implicit;return o.cc().itemSelect(i),e.stopPropagation()}),o.Sb(1,"ion-label"),o.Sb(2,"h2"),o.Ec(3,"Account open date :"),o.Sb(4,"b"),o.Ec(5),o.Rb(),o.Rb(),o.Sb(6,"h2"),o.Ec(7,"Account close date :"),o.Sb(8,"b"),o.Ec(9),o.Rb(),o.Rb(),o.Sb(10,"h2"),o.Ec(11,"Total amount :"),o.Sb(12,"b"),o.Ec(13),o.Rb(),o.Rb(),o.Rb(),o.Rb()}if(2&e){var i=t.$implicit;o.Ab(5),o.Gc(" ",i.rentPlan,""),o.Ab(4),o.Gc(" ",i.rentAmount,""),o.Ab(4),o.Gc(" ",i.vehicleType,"")}}var S,y=((S=function(){function t(c,i,n,a,o,l,s){e(this,t),this.router=c,this.config=i,this.ref=n,this.popoverController=a,this.translate=o,this.dbprovider=l,this.messageService=s,this.rentplans=[],this.tableName="rentPlan",this.vehicleType=JSON.parse(JSON.stringify(i.data.vehicleType)),this.fetchData()}return c(t,[{key:"backButtonOnclick",value:function(){this.popoverController.dismiss()}},{key:"itemSelect",value:function(e){this.ref.close(e)}},{key:"fetchData",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleType":this.vehicleType,"data.type":this.tableName},sort:["data.vehicleType"]}).then(function(t){t&&"SUCCESS"==t.status?(console.log(t),e.rentplans=t.records):e.messageService.add({key:"rentPlanPopupList",severity:"error",summary:t.message,detail:""})})}}]),t}()).\u0275fac=function(e){return new(e||S)(o.Mb(g.g),o.Mb(l.b),o.Mb(l.d),o.Mb(s.H),o.Mb(d.d),o.Mb(b.a),o.Mb(r.h))},S.\u0275cmp=o.Gb({type:S,selectors:[["rentPlanPopupList"]],decls:5,vars:1,consts:[[2,"height","400px"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],["key","rentPlanPopupList","position","center"],[3,"click"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-row"),o.Sb(2,"ion-list",1),o.Cc(3,p,14,3,"ion-item",2),o.Rb(),o.Rb(),o.Nb(4,"p-toast",3),o.Rb()),2&e&&(o.Ab(3),o.jc("ngForOf",t.rentplans))},directives:[s.k,s.w,s.s,h.k,u.a,s.q,s.r],styles:[""]}),S),A=n("27b0"),R=n("3Pt+");function C(e,t){if(1&e&&(o.Sb(0,"ion-label",9),o.Ec(1),o.Rb()),2&e){var c=o.cc();o.Ab(1),o.Fc(c.selectedRentPlan.rentPlan)}}function N(e,t){if(1&e&&(o.Sb(0,"ion-label",9),o.Ec(1),o.Rb()),2&e){var c=o.cc();o.Ab(1),o.Fc(c.selectedRentPlan.rentAmount)}}var M,E=((M=function(){function t(c,i,n,a,o,l,s,r,b){e(this,t),this.router=c,this.dbconfig=i,this.messageService=n,this.dbprovider=a,this.popoverController=o,this.dialogService=l,this.translate=s,this.config=r,this.ref=b,this.tableName="account",this.savedSuccessMessage="Data saved successfully",this.selectedVehicle=JSON.parse(JSON.stringify(r.data.vehicle));var h=6e4*(new Date).getTimezoneOffset(),u=new Date(Date.now()-h).toISOString().slice(0,-5);this.openDate=u,this.initializeObjects(this.dbconfig.configuration.tableStructure)}return c(t,[{key:"initializeObjects",value:function(e){this.accountObj=JSON.parse(JSON.stringify(e[this.tableName]))}},{key:"openRentPlanList",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.dialogService.open(y,{header:this.translate.instant("rentPlanList.title"),width:"50%",data:{vehicleType:this.selectedVehicle.vehicleType}}).onClose.subscribe(function(e){e&&(t.selectedRentPlan=e)});case 1:case"end":return e.stop()}},e,this)}))}},{key:"saveAction",value:function(){var e=this;this.selectedRentPlan?(this.accountObj.openDate=new Date(this.openDate).getTime(),this.accountObj.rentPlan_lookup=this.selectedRentPlan.id,this.accountObj.vehicle=this.selectedVehicle.id,console.log(this.accountObj),this.dbprovider.save(this.tableName,this.accountObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"accCreation",severity:"success",summary:e.savedSuccessMessage,detail:""}),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"accCreation",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"accCreation",severity:"error",summary:t,detail:""})})):this.messageService.add({key:"accCreation",severity:"error",summary:"Choose rent plan",detail:"",closable:!0})}}]),t}()).\u0275fac=function(e){return new(e||M)(o.Mb(g.g),o.Mb(A.a),o.Mb(r.h),o.Mb(b.a),o.Mb(s.H),o.Mb(l.a),o.Mb(d.d),o.Mb(l.b),o.Mb(l.d))},M.\u0275cmp=o.Gb({type:M,selectors:[["accountCreation"]],decls:26,vars:16,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],["lines","full"],["type","datetime-local",2,"background-color","lightgray",3,"ngModel","ngModelChange"],["style","float: right;text-align: right;",4,"ngIf"],[3,"click"],["slot","icon-only","name","search"],["type","submit","color","danger","expand","block",3,"click"],["key","accCreation","position","center"],[2,"float","right","text-align","right"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"ion-title",1),o.Ec(2),o.Rb(),o.Sb(3,"ion-item",2),o.Sb(4,"ion-label"),o.Ec(5),o.dc(6,"translate"),o.Rb(),o.Sb(7,"input",3),o.ac("ngModelChange",function(e){return t.openDate=e}),o.Rb(),o.Rb(),o.Sb(8,"ion-item",2),o.Sb(9,"ion-label"),o.Ec(10),o.dc(11,"translate"),o.Rb(),o.Cc(12,C,2,1,"ion-label",4),o.Sb(13,"ion-button",5),o.ac("click",function(){return t.openRentPlanList()}),o.Nb(14,"ion-icon",6),o.Rb(),o.Rb(),o.Sb(15,"ion-item",2),o.Sb(16,"ion-label"),o.Ec(17),o.dc(18,"translate"),o.Rb(),o.Cc(19,N,2,1,"ion-label",4),o.Rb(),o.Sb(20,"ion-row"),o.Sb(21,"ion-col"),o.Sb(22,"ion-button",7),o.ac("click",function(){return t.saveAction()}),o.Ec(23),o.dc(24,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Nb(25,"p-toast",8),o.Rb()),2&e&&(o.Ab(2),o.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),o.Ab(3),o.Fc(o.ec(6,8,"accountCreation.openDate")),o.Ab(2),o.jc("ngModel",t.openDate),o.Ab(3),o.Fc(o.ec(11,10,"accountCreation.selectRentPlan")),o.Ab(2),o.jc("ngIf",t.selectedRentPlan),o.Ab(5),o.Fc(o.ec(18,12,"rentPlanEntry.rentAmount")),o.Ab(2),o.jc("ngIf",t.selectedRentPlan),o.Ab(4),o.Fc(o.ec(24,14,"save")))},directives:[s.k,s.z,s.q,s.r,R.a,R.i,R.l,h.l,s.d,s.o,s.w,s.j,u.a],pipes:[d.c],styles:[""]}),M),j=n("Nf9I"),O=n("jIHw");function k(e,t){if(1&e&&(o.Sb(0,"ion-title",8),o.Ec(1),o.Rb()),2&e){var c=o.cc();o.Ab(1),o.Gc(" ",c.selectedVehicle.vehicleBrand+" "+c.selectedVehicle.vehicleModel+" "+c.selectedVehicle.vehicleNumber," ")}}function V(e,t){if(1&e&&(o.Sb(0,"div"),o.Sb(1,"ion-item",9),o.Sb(2,"ion-label"),o.Ec(3),o.dc(4,"translate"),o.Rb(),o.Sb(5,"h5"),o.Ec(6),o.Rb(),o.Rb(),o.Sb(7,"ion-item",9),o.Sb(8,"ion-label"),o.Ec(9),o.dc(10,"translate"),o.Rb(),o.Sb(11,"h5"),o.Ec(12),o.dc(13,"translate"),o.Rb(),o.Rb(),o.Sb(14,"ion-item",9),o.Sb(15,"ion-label"),o.Ec(16),o.dc(17,"translate"),o.Rb(),o.Sb(18,"h5"),o.Ec(19),o.dc(20,"translate"),o.Rb(),o.Rb(),o.Sb(21,"ion-item",9),o.Sb(22,"ion-label"),o.Ec(23),o.dc(24,"translate"),o.Rb(),o.Sb(25,"h5"),o.Ec(26),o.dc(27,"translate"),o.Rb(),o.Rb(),o.Sb(28,"ion-item",9),o.Sb(29,"ion-label"),o.Ec(30),o.dc(31,"translate"),o.Rb(),o.Sb(32,"h5"),o.Ec(33),o.dc(34,"date"),o.Rb(),o.Rb(),o.Sb(35,"ion-item",9),o.Sb(36,"ion-label"),o.Ec(37),o.dc(38,"translate"),o.Rb(),o.Sb(39,"h5"),o.Ec(40),o.dc(41,"date"),o.Rb(),o.Rb(),o.Sb(42,"ion-item",9),o.Sb(43,"ion-label"),o.Ec(44),o.dc(45,"translate"),o.Rb(),o.Sb(46,"h5"),o.Ec(47,"Security 1"),o.Rb(),o.Rb(),o.Rb()),2&e){var c=o.cc();o.Ab(3),o.Fc(o.ec(4,16,"accountDetail.rentPlan")),o.Ab(3),o.Fc(c.selectedAccount.rentPlan_lookup.rentPlan),o.Ab(3),o.Fc(o.ec(10,18,"accountDetail.totalAmount")),o.Ab(3),o.Hc("",c.selectedAccount.totalBillAmount," ",o.ec(13,20,"rs"),""),o.Ab(4),o.Fc(o.ec(17,22,"accountDetail.amountReceived")),o.Ab(3),o.Hc("",c.selectedAccount.receivedAmount," ",o.ec(20,24,"rs"),""),o.Ab(4),o.Fc(o.ec(24,26,"accountDetail.pendingAmount")),o.Ab(3),o.Hc("",c.selectedAccount.totalBillAmount-c.selectedAccount.receivedAmount," ",o.ec(27,28,"rs"),""),o.Ab(4),o.Fc(o.ec(31,30,"accountDetail.accOpenDate")),o.Ab(3),o.Fc(o.fc(34,32,c.selectedAccount.openDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Fc(o.ec(38,35,"accountDetail.accCloseDate")),o.Ab(3),o.Fc(o.fc(41,37,c.selectedAccount.closeDate,"dd/MM/yyyy hh:mm a")),o.Ab(4),o.Fc(o.ec(45,40,"accountDetail.accAddBy"))}}function w(e,t){1&e&&(o.Sb(0,"div"),o.Nb(1,"br"),o.Nb(2,"div"),o.Sb(3,"div",5),o.Sb(4,"ion-label"),o.Ec(5,"Active account not available. Create new account."),o.Rb(),o.Rb(),o.Rb())}function T(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",10),o.Sb(1,"button",11),o.ac("click",function(){return o.wc(c),o.cc().createAccount()}),o.Rb(),o.Rb()}}function F(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",12),o.Sb(1,"button",13),o.ac("click",function(){return o.wc(c),o.cc().closeAccount()}),o.Rb(),o.Sb(2,"button",14),o.ac("click",function(){return o.wc(c),o.cc().accountHistory()}),o.dc(3,"translate"),o.Rb(),o.Rb()}2&e&&(o.Ab(2),o.kc("label",o.ec(3,1,"history")))}function G(e,t){if(1&e){var c=o.Tb();o.Sb(0,"span",12),o.Sb(1,"button",15),o.ac("click",function(){return o.wc(c),o.cc().createAccount()}),o.Rb(),o.Sb(2,"button",14),o.ac("click",function(){return o.wc(c),o.cc().accountHistory()}),o.dc(3,"translate"),o.Rb(),o.Rb()}2&e&&(o.Ab(2),o.kc("label",o.ec(3,1,"history")))}var x,D=((x=function(){function t(c,i,n,a,o,l,s,r){e(this,t),this.confirmationService=c,this.router=i,this.popoverController=n,this.translate=a,this.dialogService=o,this.messageService=l,this.dbprovider=s,this.config=r,this.tableName="account",this.vehicleTableName="vehicle",this.savedSuccessMessage="Account closed successfully",this.accountList=[],this.selectedVehicle=JSON.parse(JSON.stringify(r.data.vehicle)),this.fetchAccounts()}return c(t,[{key:"accountHistory",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("history"),this.dialogService.open(f,{header:this.translate.instant("accountHistory.title"),width:"50%",data:{vehicle:this.selectedVehicle}});case 1:case"end":return e.stop()}},e,this)}))}},{key:"createAccount",value:function(){var e=this;console.log("account creation"),this.dialogService.open(E,{header:this.translate.instant("accountCreation.title"),width:"50%",data:{vehicle:this.selectedVehicle}}).onClose.subscribe(function(t){t&&"SUCCESS"==t&&e.fetchAccounts()})}},{key:"closeAccount",value:function(){var e=this;console.log("close call"),this.confirmationService.confirm({message:"Are you sure that you want to close this account?",accept:function(){e.selectedAccount.closeDate=(new Date).getTime(),e.dbprovider.save(e.tableName,e.selectedAccount).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"accountDetail",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.fetchAccounts()):e.messageService.add({key:"accountDetail",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(e){console.log(e)})}})}},{key:"fetchAccounts",value:function(){var e=this;this.selectedAccount=null,this.dbprovider.fetchChildDocsWithRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id,!0,{masterandlookupreference:["rentPlan"]}).then(function(t){console.log(t),t&&"SUCCESS"==t.status?(t.records.length>0&&t.records.forEach(function(t){t.closeDate||(e.selectedAccount=t)}),e.accountList=t.records):e.messageService.add({key:"accountDetail",severity:"error",summary:t.message,detail:""})})}}]),t}()).\u0275fac=function(e){return new(e||x)(o.Mb(r.b),o.Mb(g.g),o.Mb(s.H),o.Mb(d.d),o.Mb(l.a),o.Mb(r.h),o.Mb(b.a),o.Mb(l.b))},x.\u0275cmp=o.Gb({type:x,selectors:[["accountDetail"]],decls:10,vars:6,consts:[[2,"height","400px"],["size","large","class","ion-text-center",4,"ngIf"],[4,"ngIf"],["key","accountDetail","position","center"],["header","Confirmation","icon","pi pi-exclamation-triangle"],[2,"text-align","center"],["class","p-buttonset","style","text-align: center;",4,"ngIf"],["class","p-buttonset",4,"ngIf"],["size","large",1,"ion-text-center"],["lines","full"],[1,"p-buttonset",2,"text-align","center"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",3,"click"],[1,"p-buttonset"],["pButton","","type","button","label","Close account","icon","pi pi-times-circle",2,"float","left",3,"click"],["pButton","","type","button","icon","pi pi-clock",2,"float","right",3,"label","click"],["pButton","","type","button","label","Create New account","icon","pi pi-plus",2,"float","left",3,"click"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Cc(1,k,2,1,"ion-title",1),o.Cc(2,V,48,42,"div",2),o.Cc(3,w,6,0,"div",2),o.Nb(4,"p-toast",3),o.Nb(5,"p-confirmDialog",4),o.Rb(),o.Sb(6,"ion-footer",5),o.Cc(7,T,2,0,"span",6),o.Cc(8,F,4,3,"span",7),o.Cc(9,G,4,3,"span",7),o.Rb()),2&e&&(o.Ab(1),o.jc("ngIf",t.selectedVehicle),o.Ab(1),o.jc("ngIf",t.selectedAccount),o.Ab(1),o.jc("ngIf",!t.selectedAccount),o.Ab(4),o.jc("ngIf",!t.selectedAccount&&0==t.accountList.length),o.Ab(1),o.jc("ngIf",t.selectedAccount&&t.accountList.length>0),o.Ab(1),o.jc("ngIf",!t.selectedAccount&&t.accountList.length>0))},directives:[s.k,h.l,u.a,j.a,s.l,s.z,s.q,s.r,O.b],pipes:[d.c,h.e],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),x)},VqLa:function(t,i,n){"use strict";n.d(i,"a",function(){return R});var a=n("mrSG"),o=n("xHpX"),l=n("fXoL"),s=n("tyNb"),r=n("sYmb"),b=n("7zfz"),h=n("tp0D"),u=n("J7/z"),d=n("TEn/"),v=n("ofXK"),m=n("Gxio"),f=n("jIHw");function g(e,t){if(1&e&&(l.Sb(0,"h2"),l.Ec(1),l.Rb()),2&e){var c=l.cc().$implicit;l.Ab(1),l.Fc(c.contactName)}}function p(e,t){if(1&e&&(l.Sb(0,"h2"),l.Ec(1),l.Rb()),2&e){var c=l.cc().$implicit;l.Ab(1),l.Fc(c.contactNameInTamil)}}function S(e,t){if(1&e){var c=l.Tb();l.Sb(0,"ion-item",7),l.ac("click",function(e){l.wc(c);var i=t.$implicit;return l.cc().editContact(i),e.stopPropagation()}),l.Sb(1,"ion-avatar",8),l.Nb(2,"ion-icon",9),l.Rb(),l.Sb(3,"ion-label"),l.Cc(4,g,2,1,"h2",4),l.Cc(5,p,2,1,"h2",4),l.Sb(6,"h3"),l.Ec(7),l.Rb(),l.Sb(8,"p"),l.Ec(9),l.Rb(),l.Sb(10,"p"),l.Ec(11),l.Rb(),l.Rb(),l.Rb()}if(2&e){var i=t.$implicit,n=l.cc();l.Ab(4),l.jc("ngIf",n.appLanguage&&"en"==n.appLanguage),l.Ab(1),l.jc("ngIf",n.appLanguage&&"ta"==n.appLanguage),l.Ab(2),l.Fc(i.contactMobile),l.Ab(2),l.Gc("DL : ",i.licenseNumber,""),l.Ab(2),l.Gc("Added By : ",i.securityName,"")}}function y(e,t){if(1&e){var c=l.Tb();l.Sb(0,"div"),l.Nb(1,"br"),l.Nb(2,"div"),l.Sb(3,"div",10),l.Sb(4,"ion-label"),l.Ec(5,"Alternate contact not available."),l.Rb(),l.Nb(6,"br"),l.Nb(7,"br"),l.Sb(8,"button",11),l.ac("click",function(){return l.wc(c),l.cc().createAlternateContact()}),l.Rb(),l.Rb(),l.Rb()}}function A(e,t){if(1&e){var c=l.Tb();l.Sb(0,"ion-footer",10),l.Sb(1,"span",12),l.Sb(2,"button",11),l.ac("click",function(){return l.wc(c),l.cc().createAlternateContact()}),l.Rb(),l.Rb(),l.Rb()}}var R=function(){var t=function(){function t(c,i,n,a,o,l){e(this,t),this.router=c,this.translate=i,this.messageService=n,this.dbprovider=a,this.config=o,this.dialogService=l,this.contactList=[],this.appLanguage="ta",this.contactTableName="contact",this.vehicleContactAssignmentTableName="vehicleContactAssignment",this.appLanguage=this.translate.getDefaultLang(),this.selectedVehicle=JSON.parse(JSON.stringify(o.data.vehicle)),this.fetchAlternateContactList()}return c(t,[{key:"itemSelect",value:function(e){}},{key:"fetchAlternateContactList",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicle_lookup":this.selectedVehicle.id,"data.type":this.vehicleContactAssignmentTableName},sort:["data.vehicle_lookup"]}).then(function(t){if(console.log(t),"SUCCESS"==t.status&&t.records.length>0){var c=t.records.map(function(e){return e.contact_lookup}).map(function(t){return e.contactTableName+"_2_"+t});e.fetchContactListAgainstVehicle(c)}else e.messageService.add({key:"alternateContactList",severity:"error",summary:t.message,detail:""})})}},{key:"fetchContactListAgainstVehicle",value:function(e){var t=this;console.log(e),this.contactList=[],this.dbprovider.fetchDocsWithDocIds(e).then(function(e){console.log(e),"SUCCESS"==e.status&&e.response.length>0?e.response.forEach(function(e){console.log(e),"others"==e.contactType&&t.contactList.push(e)}):t.contactList=[]}).catch(function(e){t.contactList=[]})}},{key:"createAlternateContact",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("add contact"),this.dialogService.open(o.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:"",mode:"new",contactType:"Others",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(function(e){e&&"SUCCESS"==e&&t.fetchAlternateContactList()});case 1:case"end":return e.stop()}},e,this)}))}},{key:"editContact",value:function(e){var t=this;console.log(e),delete JSON.parse(JSON.stringify(e)).selected,this.dialogService.open(o.a,{header:this.translate.instant("contactEntry.title"),width:"50%",data:{object:e,mode:"edit",contactType:"Primary",vehicleId:this.selectedVehicle.id}}).onClose.subscribe(function(e){e&&"SUCCESS"==e&&t.fetchAlternateContactList()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.Mb(s.g),l.Mb(r.d),l.Mb(b.h),l.Mb(h.a),l.Mb(u.b),l.Mb(u.a))},t.\u0275cmp=l.Gb({type:t,selectors:[["contactListAgainstCar"]],decls:9,vars:4,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["key","alternateContactList","position","center"],["style","text-align: center;",4,"ngIf"],[3,"click"],["slot","start"],["name","person-circle-outline",2,"font-size","50px"],[2,"text-align","center"],["pButton","","type","button","label","Create alternate contact","icon","pi pi-plus",3,"click"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(l.Sb(0,"ion-content",0),l.Sb(1,"ion-title",1),l.Ec(2),l.Rb(),l.Sb(3,"ion-row"),l.Sb(4,"ion-list",2),l.Cc(5,S,12,5,"ion-item",3),l.Rb(),l.Rb(),l.Cc(6,y,9,0,"div",4),l.Nb(7,"p-toast",5),l.Rb(),l.Cc(8,A,3,0,"ion-footer",6)),2&e&&(l.Ab(2),l.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),l.Ab(3),l.jc("ngForOf",t.contactList),l.Ab(1),l.jc("ngIf",0==t.contactList.length),l.Ab(2),l.jc("ngIf",t.contactList.length>0))},directives:[d.k,d.z,d.w,d.s,v.k,v.l,m.a,d.q,d.c,d.o,d.r,f.b,d.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),t}()},XqSU:function(t,i,n){"use strict";n.d(i,"a",function(){return N});var a,o=n("mrSG"),l=n("3Pt+"),s=n("fXoL"),r=n("tyNb"),b=n("27b0"),h=n("tp0D"),u=n("7zfz"),d=n("J7/z"),v=n("TEn/"),m=n("Gxio"),f=n("sYmb"),g=((a=function(){function t(c,i,n,a,o,l,s){e(this,t),this.router=c,this.dbconfig=i,this.formBuilder=n,this.dbprovider=a,this.messageService=o,this.ref=l,this.config=s,this.alternateVehicleObj={},this.vehicleObj={},this.contactId="",this.vehicleId="",this.tableName="alternateVehicle",this.savedSuccessMessage="Data saved successfully",this.vehicleObj=JSON.parse(JSON.stringify(s.data.vehicle)),"edit"==s.data.mode?this.alternateVehicleObj=JSON.parse(JSON.stringify(s.data.object)):this.initializeObjects(this.dbconfig.configuration.tableStructure),this.createFormGroup(),this.contactId=this.config.data.contactId}return c(t,[{key:"initializeObjects",value:function(e){this.alternateVehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.alternateVehicleObj.vehicleType="bike"}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",l.o.compose([l.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",l.o.compose([l.o.required])]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.alternateVehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.alternateVehicleObj.vehicleType,vehicleBrand:this.alternateVehicleObj.vehicleBrand,vehicleModel:this.alternateVehicleObj.vehicleModel,vehicleColor:this.alternateVehicleObj.vehicleColor,vehicleNumber:this.alternateVehicleObj.vehicleNumber.toUpperCase()}}),this.alternateVehicleObj.vehicle=this.vehicleObj.id,this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.alternateVehicleObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"alternateVehicleEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.vehicleId=t.id,setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"alternateVehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.alternateVehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.alternateVehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}}]),t}()).\u0275fac=function(e){return new(e||a)(s.Mb(r.g),s.Mb(b.a),s.Mb(l.b),s.Mb(h.a),s.Mb(u.h),s.Mb(d.d),s.Mb(d.b))},a.\u0275cmp=s.Gb({type:a,selectors:[["alternateVehicleEntry"]],decls:50,vars:36,consts:[[2,"height","400px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","vehicle"],["value","bike","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["value","bike"],["value","car"],["value","auto"],["value","others"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","alternateVehicleEntry","position","center"]],template:function(e,t){1&e&&(s.Sb(0,"ion-content",0),s.Sb(1,"form",1),s.Sb(2,"ion-item",2),s.Sb(3,"ion-radio-group",3),s.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleType=e}),s.Sb(4,"ion-label"),s.Ec(5),s.dc(6,"translate"),s.Rb(),s.Sb(7,"ion-item"),s.Nb(8,"ion-radio",4),s.Sb(9,"ion-label"),s.Ec(10),s.dc(11,"translate"),s.Rb(),s.Nb(12,"ion-radio",5),s.Sb(13,"ion-label"),s.Ec(14),s.dc(15,"translate"),s.Rb(),s.Nb(16,"ion-radio",6),s.Sb(17,"ion-label"),s.Ec(18),s.dc(19,"translate"),s.Rb(),s.Nb(20,"ion-radio",7),s.Sb(21,"ion-label"),s.Ec(22),s.dc(23,"translate"),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.Sb(24,"ion-item",2),s.Sb(25,"ion-label",8),s.Ec(26),s.dc(27,"translate"),s.Rb(),s.Sb(28,"ion-input",9),s.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleBrand=e}),s.Rb(),s.Rb(),s.Sb(29,"ion-item",2),s.Sb(30,"ion-label",8),s.Ec(31),s.dc(32,"translate"),s.Rb(),s.Sb(33,"ion-input",10),s.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleModel=e}),s.Rb(),s.Rb(),s.Sb(34,"ion-item",2),s.Sb(35,"ion-label",8),s.Ec(36),s.dc(37,"translate"),s.Rb(),s.Sb(38,"ion-input",11),s.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleColor=e}),s.Rb(),s.Rb(),s.Sb(39,"ion-item",2),s.Sb(40,"ion-label",8),s.Ec(41),s.dc(42,"translate"),s.Rb(),s.Sb(43,"ion-input",12),s.ac("ngModelChange",function(e){return t.alternateVehicleObj.vehicleNumber=e}),s.Rb(),s.Rb(),s.Sb(44,"ion-row"),s.Sb(45,"ion-col"),s.Sb(46,"ion-button",13),s.ac("click",function(){return t.saveAction()}),s.Ec(47),s.dc(48,"translate"),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.Nb(49,"p-toast",14),s.Rb()),2&e&&(s.Ab(1),s.jc("formGroup",t.formGroup),s.Ab(2),s.jc("ngModel",t.alternateVehicleObj.vehicleType),s.Ab(2),s.Fc(s.ec(6,16,"vehicleEntry.vehicleType")),s.Ab(5),s.Fc(s.ec(11,18,"vehicleEntry.bike")),s.Ab(4),s.Fc(s.ec(15,20,"vehicleEntry.car")),s.Ab(4),s.Fc(s.ec(19,22,"vehicleEntry.auto")),s.Ab(4),s.Fc(s.ec(23,24,"vehicleEntry.others")),s.Ab(4),s.Gc("",s.ec(27,26,"vehicleEntry.vehicleBrand")," "),s.Ab(2),s.jc("ngModel",t.alternateVehicleObj.vehicleBrand),s.Ab(3),s.Fc(s.ec(32,28,"vehicleEntry.vehicleModel")),s.Ab(2),s.jc("ngModel",t.alternateVehicleObj.vehicleModel),s.Ab(3),s.Fc(s.ec(37,30,"vehicleEntry.vehicleColor")),s.Ab(2),s.jc("ngModel",t.alternateVehicleObj.vehicleColor),s.Ab(3),s.Fc(s.ec(42,32,"vehicleEntry.vehicleNumber")),s.Ab(2),s.jc("ngModel",t.alternateVehicleObj.vehicleNumber),s.Ab(4),s.Fc(s.ec(48,34,"save")))},directives:[v.k,l.p,l.j,l.d,v.q,l.e,v.u,v.J,l.i,l.c,v.r,v.t,v.I,v.p,v.K,l.n,v.w,v.j,v.d,m.a],pipes:[f.c],styles:[""]}),a),p=n("ofXK"),S=n("jIHw");function y(e,t){if(1&e){var c=s.Tb();s.Sb(0,"ion-item",7),s.ac("click",function(e){s.wc(c);var i=t.$implicit;return s.cc().itemSelect(i),e.stopPropagation()}),s.Sb(1,"ion-avatar",8),s.Nb(2,"ion-icon",9),s.Rb(),s.Sb(3,"ion-label"),s.Sb(4,"h3"),s.Ec(5),s.Rb(),s.Sb(6,"h2"),s.Ec(7),s.Rb(),s.Sb(8,"h2"),s.Sb(9,"b"),s.Ec(10),s.Rb(),s.Rb(),s.Sb(11,"h2"),s.Ec(12),s.Rb(),s.Sb(13,"p"),s.Ec(14),s.Rb(),s.Rb(),s.Rb()}if(2&e){var i=t.$implicit;s.Ab(5),s.Fc(i.vehicleType),s.Ab(2),s.Hc("",i.vehicleBrand," ",i.vehicleModel," "),s.Ab(3),s.Fc(i.vehicleNumber),s.Ab(2),s.Fc(i.vehicleColor),s.Ab(2),s.Gc("Added By : ",i.addedBy,"")}}function A(e,t){if(1&e){var c=s.Tb();s.Sb(0,"div"),s.Nb(1,"br"),s.Nb(2,"div"),s.Sb(3,"div",10),s.Sb(4,"ion-label"),s.Ec(5,"Alternate vehicle not available."),s.Rb(),s.Nb(6,"br"),s.Nb(7,"br"),s.Sb(8,"button",11),s.ac("click",function(){return s.wc(c),s.cc().createAlternateVehicle()}),s.Rb(),s.Rb(),s.Rb()}}function R(e,t){if(1&e){var c=s.Tb();s.Sb(0,"ion-footer",10),s.Sb(1,"span",12),s.Sb(2,"button",11),s.ac("click",function(){return s.wc(c),s.cc().createAlternateVehicle()}),s.Rb(),s.Rb(),s.Rb()}}var C,N=((C=function(){function t(c,i,n,a,o,l,s){e(this,t),this.router=c,this.popoverController=i,this.translate=n,this.messageService=a,this.dbprovider=o,this.config=l,this.dialogService=s,this.vehicleList=[],this.tableName="alternateVehicle",this.vehicleTableName="vehicle",this.selectedVehicle=JSON.parse(JSON.stringify(l.data.vehicle)),this.fetchAlternateVehicles()}return c(t,[{key:"createAlternateVehicle",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("alternate vehicle detail"),this.dialogService.open(g,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:"",mode:"new"}}).onClose.subscribe(function(e){t.fetchAlternateVehicles()});case 1:case"end":return e.stop()}},e,this)}))}},{key:"fetchAlternateVehicles",value:function(){var e=this;this.dbprovider.fetchDocsWithoutRelationshipByParentTypeAndId(this.tableName,this.vehicleTableName,this.selectedVehicle.id).then(function(t){console.log(t),t&&"SUCCESS"==t.status?e.vehicleList=t.records:e.messageService.add({key:"alternateVehicleList",severity:"error",summary:t.message,detail:""})})}},{key:"itemSelect",value:function(e){var t=this;this.dialogService.open(g,{header:this.translate.instant("alternateVehicle.title"),width:"50%",data:{vehicle:this.selectedVehicle,object:e,mode:"edit"}}).onClose.subscribe(function(e){t.fetchAlternateVehicles()})}}]),t}()).\u0275fac=function(e){return new(e||C)(s.Mb(r.g),s.Mb(v.H),s.Mb(f.d),s.Mb(u.h),s.Mb(h.a),s.Mb(d.b),s.Mb(d.a))},C.\u0275cmp=s.Gb({type:C,selectors:[["alternateVehicleList"]],decls:9,vars:4,consts:[[2,"height","400px"],["size","large",1,"ion-text-center"],[2,"width","100%"],[3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],["key","alternateVehicleList","position","center"],["style","text-align: center;",4,"ngIf"],[3,"click"],["slot","start"],["name","car-sport-outline",2,"font-size","50px"],[2,"text-align","center"],["pButton","","type","button","label","Create alternate vehicle","icon","pi pi-plus",3,"click"],[1,"p-buttonset",2,"text-align","center"]],template:function(e,t){1&e&&(s.Sb(0,"ion-content",0),s.Sb(1,"ion-title",1),s.Ec(2),s.Rb(),s.Sb(3,"ion-row"),s.Sb(4,"ion-list",2),s.Cc(5,y,15,6,"ion-item",3),s.Rb(),s.Rb(),s.Cc(6,A,9,0,"div",4),s.Nb(7,"p-toast",5),s.Rb(),s.Cc(8,R,3,0,"ion-footer",6)),2&e&&(s.Ab(2),s.Gc(" ",t.selectedVehicle.vehicleBrand+" "+t.selectedVehicle.vehicleModel+" "+t.selectedVehicle.vehicleNumber," "),s.Ab(3),s.jc("ngForOf",t.vehicleList),s.Ab(1),s.jc("ngIf",0==t.vehicleList.length),s.Ab(2),s.jc("ngIf",t.vehicleList.length>0))},directives:[v.k,v.z,v.w,v.s,p.k,p.l,m.a,v.q,v.c,v.o,v.r,S.b,v.l],styles:["ion-footer.footer-md[_ngcontent-%COMP%]:before{background-image:none}"]}),C)},eKwt:function(t,i,n){"use strict";n.d(i,"a",function(){return m});var a=n("3Pt+"),o=n("fXoL"),l=n("tyNb"),s=n("27b0"),r=n("tp0D"),b=n("7zfz"),h=n("J7/z"),u=n("TEn/"),d=n("Gxio"),v=n("sYmb"),m=function(){var t=function(){function t(c,i,n,a,o,l,s){e(this,t),this.router=c,this.dbconfig=i,this.formBuilder=n,this.dbprovider=a,this.messageService=o,this.ref=l,this.config=s,this.vehicleObj={},this.vehicleandContactAssgObj={},this.contactId="",this.vehicleId="",this.tableName="vehicle",this.assignmenttableName="vehicleContactAssignment",this.savedSuccessMessage="Data saved successfully","edit"==s.data.mode?this.vehicleObj=JSON.parse(JSON.stringify(s.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup(),this.contactId=this.config.data.contactId}return c(t,[{key:"initializeObjects",value:function(e){this.vehicleObj=JSON.parse(JSON.stringify(e[this.tableName])),this.vehicleObj.vehicleType="car"}},{key:"initializeAssignmentObjects",value:function(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({vehicle:this.formBuilder.group({vehicleType:["",a.o.compose([a.o.required])],vehicleBrand:[""],vehicleModel:[""],vehicleColor:[""],vehicleNumber:["",a.o.compose([a.o.required])]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.vehicleObj),this.formGroup.patchValue({vehicle:{vehicleType:this.vehicleObj.vehicleType,vehicleBrand:this.vehicleObj.vehicleBrand,vehicleModel:this.vehicleObj.vehicleModel,vehicleColor:this.vehicleObj.vehicleColor,vehicleNumber:this.vehicleObj.vehicleNumber.toUpperCase()}}),this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"vehicleEntry",severity:"error",summary:"Vehicle number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.vehicleObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"vehicleEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.vehicleId=t.id,"edit"!=e.config.data.mode?e.saveContactAndVehicleAssignment():setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"vehicleEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"vehicleEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"vehicleEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.vehicleObj.vehicleNumber.toUpperCase()==this.config.data.object.vehicleNumber.toUpperCase()?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.vehicleNumber":this.vehicleObj.vehicleNumber.toUpperCase(),"data.type":this.tableName},sort:["data.vehicleNumber"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}},{key:"saveContactAndVehicleAssignment",value:function(){var e=this;this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(function(t){console.log(t),"SUCCESS"!=t.status?console.log("Vehicle assignment save failed",t):console.log("Vehicle assignment save Success"),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Mb(l.g),o.Mb(s.a),o.Mb(a.b),o.Mb(r.a),o.Mb(b.h),o.Mb(h.d),o.Mb(h.b))},t.\u0275cmp=o.Gb({type:t,selectors:[["vehicleEntry"]],decls:46,vars:33,consts:[[2,"height","450px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","vehicle"],["value","car","mode","md","formControlName","vehicleType",2,"width","100%",3,"ngModel","ngModelChange"],["value","car"],["value","auto"],["value","others"],["position","floating"],["type","text","formControlName","vehicleBrand",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleModel",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleColor",3,"ngModel","ngModelChange"],["type","text","formControlName","vehicleNumber","required","",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","vehicleEntry","position","center"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"form",1),o.Sb(2,"ion-item",2),o.Sb(3,"ion-radio-group",3),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleType=e}),o.Sb(4,"ion-label"),o.Ec(5),o.dc(6,"translate"),o.Rb(),o.Sb(7,"ion-item"),o.Nb(8,"ion-radio",4),o.Sb(9,"ion-label"),o.Ec(10),o.dc(11,"translate"),o.Rb(),o.Nb(12,"ion-radio",5),o.Sb(13,"ion-label"),o.Ec(14),o.dc(15,"translate"),o.Rb(),o.Nb(16,"ion-radio",6),o.Sb(17,"ion-label"),o.Ec(18),o.dc(19,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Sb(20,"ion-item",2),o.Sb(21,"ion-label",7),o.Ec(22),o.dc(23,"translate"),o.Rb(),o.Sb(24,"ion-input",8),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleBrand=e}),o.Rb(),o.Rb(),o.Sb(25,"ion-item",2),o.Sb(26,"ion-label",7),o.Ec(27),o.dc(28,"translate"),o.Rb(),o.Sb(29,"ion-input",9),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleModel=e}),o.Rb(),o.Rb(),o.Sb(30,"ion-item",2),o.Sb(31,"ion-label",7),o.Ec(32),o.dc(33,"translate"),o.Rb(),o.Sb(34,"ion-input",10),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleColor=e}),o.Rb(),o.Rb(),o.Sb(35,"ion-item",2),o.Sb(36,"ion-label",7),o.Ec(37),o.dc(38,"translate"),o.Rb(),o.Sb(39,"ion-input",11),o.ac("ngModelChange",function(e){return t.vehicleObj.vehicleNumber=e}),o.Rb(),o.Rb(),o.Sb(40,"ion-row"),o.Sb(41,"ion-col"),o.Sb(42,"ion-button",12),o.ac("click",function(){return t.saveAction()}),o.Ec(43),o.dc(44,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Nb(45,"p-toast",13),o.Rb()),2&e&&(o.Ab(1),o.jc("formGroup",t.formGroup),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleType),o.Ab(2),o.Fc(o.ec(6,15,"vehicleEntry.vehicleType")),o.Ab(5),o.Fc(o.ec(11,17,"vehicleEntry.car")),o.Ab(4),o.Fc(o.ec(15,19,"vehicleEntry.auto")),o.Ab(4),o.Fc(o.ec(19,21,"vehicleEntry.others")),o.Ab(4),o.Gc("",o.ec(23,23,"vehicleEntry.vehicleBrand")," "),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleBrand),o.Ab(3),o.Fc(o.ec(28,25,"vehicleEntry.vehicleModel")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleModel),o.Ab(3),o.Fc(o.ec(33,27,"vehicleEntry.vehicleColor")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleColor),o.Ab(3),o.Fc(o.ec(38,29,"vehicleEntry.vehicleNumber")),o.Ab(2),o.jc("ngModel",t.vehicleObj.vehicleNumber),o.Ab(4),o.Fc(o.ec(44,31,"save")))},directives:[u.k,a.p,a.j,a.d,u.q,a.e,u.u,u.J,a.i,a.c,u.r,u.t,u.I,u.p,u.K,a.n,u.w,u.j,u.d,d.a],pipes:[v.c],styles:[""]}),t}()},xHpX:function(t,i,n){"use strict";n.d(i,"a",function(){return m});var a=n("3Pt+"),o=n("fXoL"),l=n("tyNb"),s=n("27b0"),r=n("tp0D"),b=n("7zfz"),h=n("J7/z"),u=n("TEn/"),d=n("Gxio"),v=n("sYmb"),m=function(){var t=function(){function t(c,i,n,a,o,l,s){e(this,t),this.router=c,this.dbconfig=i,this.formBuilder=n,this.dbprovider=a,this.messageService=o,this.ref=l,this.config=s,this.contactObj={},this.tableName="contact",this.savedSuccessMessage="Data saved successfully",this.contactType="",this.vehicleandContactAssgObj={},this.assignmenttableName="vehicleContactAssignment",this.contactType=this.config.data.contactType,this.vehicleId=this.config.data.vehicleId,"edit"==s.data.mode?this.contactObj=JSON.parse(JSON.stringify(s.data.object)):(this.initializeObjects(this.dbconfig.configuration.tableStructure),this.initializeAssignmentObjects(this.dbconfig.configuration.tableStructure)),this.createFormGroup()}return c(t,[{key:"initializeAssignmentObjects",value:function(e){this.vehicleandContactAssgObj=JSON.parse(JSON.stringify(e[this.assignmenttableName]))}},{key:"initializeObjects",value:function(e){this.contactObj=JSON.parse(JSON.stringify(e[this.tableName])),this.contactObj.contactType="Primary"==this.contactType?"owner":"others"}},{key:"createFormGroup",value:function(){this.formGroup=this.formBuilder.group({contact:this.formBuilder.group({contactName:["",a.o.compose([a.o.maxLength(80),a.o.required])],contactNameInTamil:[""],contactMobile:["",[a.o.required,a.o.pattern("^((\\+91-?)|0)?[0-9]{10}$")]],licenseNumber:[""]})})}},{key:"saveAction",value:function(){var e=this;console.log(this.contactObj),this.formGroup.patchValue({contact:{contactName:this.contactObj.contactName,contactNameInTamil:this.contactObj.contactNameInTamil,contactMobile:this.contactObj.contactMobile,licenseNumber:this.contactObj.licenseNumber}}),this.formGroup.valid?this.alreadyExistValidation().then(function(t){t?e.messageService.add({key:"contactEntry",severity:"error",summary:"Mobile number already exist",detail:"",closable:!0}):e.dbprovider.save(e.tableName,e.contactObj).then(function(t){"SUCCESS"==t.status?(e.messageService.add({key:"contactEntry",severity:"success",summary:e.savedSuccessMessage,detail:""}),e.contactId=t.id,"edit"!=e.config.data.mode&&"others"==e.contactObj.contactType?e.saveContactAndVehicleAssignment():setTimeout(function(){return e.ref.close("SUCCESS")},1e3)):e.messageService.add({key:"contactEntry",severity:"error",summary:t.message,detail:"",closable:!0})}).catch(function(t){console.log(t),e.messageService.add({key:"contactEntry",severity:"error",summary:t,detail:""})})}):this.messageService.add({key:"contactEntry",severity:"error",summary:"Fill all fields",detail:"",closable:!0})}},{key:"alreadyExistValidation",value:function(){var e=!1;return"edit"==this.config.data.mode&&this.contactObj.contactMobile==this.config.data.object.contactMobile?Promise.resolve(e):this.dbprovider.fetchDocsWithoutRelationshipUsingFindOption({selector:{"data.contactMobile":this.contactObj.contactMobile,"data.type":this.tableName},sort:["data.contactMobile"]}).then(function(t){return"SUCCESS"==t.status&&t.records.length>0&&(e=!0),e})}},{key:"saveContactAndVehicleAssignment",value:function(){var e=this;this.vehicleandContactAssgObj.contact_lookup=this.contactId,this.vehicleandContactAssgObj.vehicle_lookup=this.vehicleId,console.log(this.vehicleandContactAssgObj),this.dbprovider.save(this.assignmenttableName,this.vehicleandContactAssgObj).then(function(t){console.log(t),"SUCCESS"!=t.status?console.log("Vehicle assignment save failed",t):console.log("Vehicle assignment save Success"),setTimeout(function(){return e.ref.close("SUCCESS")},1e3)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Mb(l.g),o.Mb(s.a),o.Mb(a.b),o.Mb(r.a),o.Mb(b.h),o.Mb(h.d),o.Mb(h.b))},t.\u0275cmp=o.Gb({type:t,selectors:[["contactEntry"]],decls:28,vars:20,consts:[[2,"height","400px"],[2,"height","100%",3,"formGroup"],["lines","full","formGroupName","contact"],["position","floating"],["type","text","formControlName","contactName","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","contactNameInTamil",3,"ngModel","ngModelChange"],["type","number","formControlName","contactMobile","required","",3,"ngModel","ngModelChange"],["type","text","formControlName","licenseNumber",3,"ngModel","ngModelChange"],["type","submit","color","danger","expand","block",3,"click"],["key","contactEntry","position","center"]],template:function(e,t){1&e&&(o.Sb(0,"ion-content",0),o.Sb(1,"form",1),o.Sb(2,"ion-item",2),o.Sb(3,"ion-label",3),o.Ec(4),o.dc(5,"translate"),o.Rb(),o.Sb(6,"ion-input",4),o.ac("ngModelChange",function(e){return t.contactObj.contactName=e}),o.Rb(),o.Rb(),o.Sb(7,"ion-item",2),o.Sb(8,"ion-label",3),o.Ec(9),o.dc(10,"translate"),o.Rb(),o.Sb(11,"ion-input",5),o.ac("ngModelChange",function(e){return t.contactObj.contactNameInTamil=e}),o.Rb(),o.Rb(),o.Sb(12,"ion-item",2),o.Sb(13,"ion-label",3),o.Ec(14),o.dc(15,"translate"),o.Rb(),o.Sb(16,"ion-input",6),o.ac("ngModelChange",function(e){return t.contactObj.contactMobile=e}),o.Rb(),o.Rb(),o.Sb(17,"ion-item",2),o.Sb(18,"ion-label",3),o.Ec(19),o.dc(20,"translate"),o.Rb(),o.Sb(21,"ion-input",7),o.ac("ngModelChange",function(e){return t.contactObj.licenseNumber=e}),o.Rb(),o.Rb(),o.Sb(22,"ion-row"),o.Sb(23,"ion-col"),o.Sb(24,"ion-button",8),o.ac("click",function(){return t.saveAction()}),o.Ec(25),o.dc(26,"translate"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Nb(27,"p-toast",9),o.Rb()),2&e&&(o.Ab(1),o.jc("formGroup",t.formGroup),o.Ab(3),o.Gc("",o.ec(5,10,"contactEntry.contactName")," "),o.Ab(2),o.jc("ngModel",t.contactObj.contactName),o.Ab(3),o.Fc(o.ec(10,12,"contactEntry.contactNameInTamil")),o.Ab(2),o.jc("ngModel",t.contactObj.contactNameInTamil),o.Ab(3),o.Fc(o.ec(15,14,"contactEntry.contactMobile")),o.Ab(2),o.jc("ngModel",t.contactObj.contactMobile),o.Ab(3),o.Fc(o.ec(20,16,"contactEntry.licenseNumber")),o.Ab(2),o.jc("ngModel",t.contactObj.licenseNumber),o.Ab(4),o.Gc("",o.ec(26,18,"save")," "))},directives:[u.k,a.p,a.j,a.d,u.q,a.e,u.r,u.p,u.K,a.i,a.c,a.n,u.F,u.w,u.j,u.d,d.a],pipes:[v.c],styles:[""]}),t}()}}])}();